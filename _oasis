Name: Odefa
Version: 0.2
Synopsis: An implementation of DDPA analysis.
Authors: JHU PL Lab <pl.cs@jhu.edu>
License: Apache

Description: An implementation of DDPA analysis.
Homepage: http://www.big-bang-lang.org/

OASISFormat: 0.4
BuildTools: ocamlbuild
Plugins: META (0.4)
AlphaFeatures: ocamlbuild_more_args
XOCamlbuildExtraArgs: -use-menhir -use-ocamlfind
BuildDepends: threads

# The following allows individual developers to customize their environments
# (e.g. reposition the _build directory via a symlink) on build.
PreBuildCommand: ./.execute_if_exists ./.local_prebuild
PreCleanCommand: ./.execute_if_exists ./.local_preclean

Library "odefa"
  Path: src
  Modules:
    Odefa

Library "utils"
  FindlibParent: odefa
  Path: src/utils
  Modules:
    Interface_utils,
    Parser_support,
    Source_origin,
    Uid
  BuildDepends:
    batteries,
    jhupllib,
    ppx_deriving.std

Library "ast"
  FindlibParent: odefa
  Path: src/ast
  Modules:
    Ast,
    Ast_pp,
    Ast_tools,
    Ast_wellformedness
  BuildDepends:
    batteries,
    jhupllib,
    ppx_deriving.std (>= 3.2),
    ppx_deriving_yojson,
    odefa.utils

Library "parser"
  FindlibParent: odefa
  Path: src/parser
  Modules:
    Generated_lexer,
    Generated_parser,
    Parser
  BuildDepends:
    batteries,
    jhupllib,
    odefa.ast,
    odefa.utils
  BuildTools+:
    ocamllex,
    menhir

Library "interpreter"
  FindlibParent: odefa
  Path: src/interpreter
  Modules:
    Interpreter
  BuildDepends:
    batteries,
    jhupllib,
    odefa.ast,
    odefa.utils

Library "ddpa-analysis_types"
  FindlibName: types
  FindlibParent: ddpa-analysis
  Path: src/ddpa-analysis/types
  Modules:
    Ddpa_abstract_ast,
    Ddpa_graph
  BuildDepends:
    batteries,
    jhupllib,
    odefa.ast

Library "ddpa-analysis_utils"
  FindlibName: utils
  FindlibParent: ddpa-analysis
  Path: src/ddpa-analysis/utils
  Modules:
    Ddpa_utils
  BuildDepends:
    batteries,
    jhupllib,
    odefa.ast,
    odefa.ddpa-analysis.types,
    odefa.utils

Library "ddpa-analysis_context-stacks"
  FindlibName: context-stacks
  FindlibParent: ddpa-analysis
  Path: src/ddpa-analysis/context-stacks
  Modules:
    Ddpa_context_stack,
    Ddpa_nonrepeating_stack,
    Ddpa_n_element_stack,
    Ddpa_single_element_stack,
    Ddpa_two_element_stack,
    Ddpa_unit_stack
  BuildDepends:
    batteries,
    jhupllib,
    ppx_deriving.std (>= 3.2),
    ppx_deriving_yojson,
    odefa.ast,
    odefa.ddpa-analysis.types,
    odefa.ddpa-analysis.utils

Library "ddpa-analysis_pds"
  FindlibName: pds
  FindlibParent: ddpa-analysis
  Path: src/ddpa-analysis/pds
  Modules:
    Ddpa_pds_dynamic_pop_handler,
    Ddpa_pds_dynamic_pop_types,
    Ddpa_pds_edge_functions,
    Ddpa_pds_structure_types
  BuildDepends:
    batteries,
    jhupllib,
    pds-reachability,
    odefa.ast,
    odefa.utils,
    odefa.ddpa-analysis.context-stacks,
    odefa.ddpa-analysis.types,
    odefa.ddpa-analysis.utils

Library "ddpa-analysis"
  FindlibName: ddpa-analysis
  FindlibParent: odefa
  Path: src/ddpa-analysis
  Modules:
    Ddpa_analysis_logging,
    Ddpa_analysis
  BuildDepends:
    batteries,
    jhupllib,
    monadlib,
    ocaml-monadic (>= 0.3.1),
    pds-reachability,
    ppx_deriving.std (>= 3.2),
    ppx_deriving_yojson,
    odefa.ast,
    odefa.ddpa-analysis.context-stacks,
    odefa.ddpa-analysis.pds,
    odefa.ddpa-analysis.types,
    odefa.ddpa-analysis.utils

Library "toploop"
  FindlibParent: odefa
  Path: src/toploop
  Modules:
    Toploop,
    Toploop_analysis,
    Toploop_analysis_types,
    Toploop_ddpa_wrapper,
    Toploop_ddpa_wrapper_types,
    Toploop_option_parsers,
    Toploop_options,
    Toploop_types,
    Toploop_utils
  BuildDepends:
    batteries,
    jhupllib,
    odefa.ast,
    odefa.interpreter,
    odefa.parser,
    odefa.ddpa-analysis

Executable "toploop"
  Path: src/toploop-main
  MainIs: toploop_main.ml
  CompiledObject: native
  BuildDepends:
    batteries,
    jhupllib,
    odefa.ast,
    odefa.parser,
    odefa.toploop

Executable "test"
  Path: test/
  MainIs: test.ml
  CompiledObject: native
  BuildDepends:
    batteries,
    jhupllib,
    ocaml-monadic,
    oUnit,
    pds-reachability,
    ppx_deriving.std,
    odefa.interpreter,
    odefa.parser,
    odefa.toploop,
    odefa.ddpa-analysis,
    odefa.utils

Test test
  Command: $test
