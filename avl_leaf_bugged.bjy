
let is_pos x = x > 0 in

let t = Mu tt. ({: left : tt, right : tt, item : int, height : {. int | is_pos } :} || {: leaf : bool :}) in

let is_leaf (x : t) : bool =
  match x with
  | { leaf = b } -> true
  | { left = l , _ } -> false
  end
in

let leaf_type = {. t | fun x -> is_leaf x } in

let assert_leaf (x : leaf_type) : bool =
  match x with
  | { leaf = b } -> true
  end
in

assert_leaf
