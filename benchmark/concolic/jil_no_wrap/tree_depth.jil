i_first = {};
flatten_fun_j_92 = fun f_b_2 -> (
    flatten_fun_j_81 = fun x_b_1 -> (
        flatten_fun_j_80 = fun freeze_b_3 -> (
            var_j_73 = f_b_2;
            var_j_74 = x_b_1;
            var_j_75 = x_b_1;
            appl_j_76 = var_j_74 var_j_75;
            appl_j_77 = var_j_73 appl_j_76;
            var_j_78 = freeze_b_3;
            appl_j_79 = appl_j_77 var_j_78));
    flatten_fun_j_90 = fun x_b_1_j_2 -> (
        flatten_fun_j_89 = fun freeze_b_3_j_1 -> (
            var_j_82 = f_b_2;
            var_j_83 = x_b_1_j_2;
            var_j_84 = x_b_1_j_2;
            appl_j_85 = var_j_83 var_j_84;
            appl_j_86 = var_j_82 appl_j_85;
            var_j_87 = freeze_b_3_j_1;
            appl_j_88 = appl_j_86 var_j_87));
    appl_j_91 = flatten_fun_j_81 flatten_fun_j_90);
ycomb_b_4 = flatten_fun_j_92;
flatten_fun_j_948 = fun self_b_0 -> (
    flatten_fun_j_947 = fun bj_null_j_63 -> (
        flatten_fun_j_519 = fun expr_b_135 -> (
            flatten_fun_j_514 = fun tt -> (
                flatten_fun_j_372 = fun expr_b_131 -> (
                    input_j_94 = input;
                    select_int_b_132 = input_j_94;
                    bool_j_95 = false;
                    fail_b_133 = bool_j_95;
                    int_j_96 = 0;
                    var_j_97 = select_int_b_132;
                    binop_j_98 = int_j_96 <= var_j_97;
                    if_j_371 = binop_j_98 ? (
                            flatten_fun_j_136 = fun expr_b_96 -> (
                                bool_j_99 = false;
                                rec_fail_b_95 = bool_j_99;
                                bool_j_100 = false;
                                rec_fail_b_94 = bool_j_100;
                                bool_j_101 = false;
                                rec_fail_b_93 = bool_j_101;
                                var_j_102 = expr_b_96;
                                m_match_bool_j_104 = var_j_102 ~ any;
                                m_match_bool_j_107 = var_j_102 ~ {bj_actual_rec, _};
                                m_match_cond_j_108 = m_match_bool_j_107 ? (
                                        var_j_109 = expr_b_96;
                                        proj_j_110 = var_j_109.bj_decl_lbls;
                                        m_match_bool_j_112 = proj_j_110 ~ any;
                                        m_match_bool_j_115 = proj_j_110 ~ 
                                            {left, right, _};
                                        m_match_cond_j_116 = m_match_bool_j_115 ? (
                                                left_j_4 = proj_j_110.left;
                                                right_j_3 = proj_j_110.right;
                                                var_j_117 = expr_b_96;
                                                proj_j_118 = var_j_117.bj_actual_rec;
                                                m_match_bool_j_120 = proj_j_118 ~ any;
                                                m_match_bool_j_123 = proj_j_118 ~ 
                                                    {left, right, _};
                                                m_match_cond_j_124 = m_match_bool_j_123 ? (
                                                        left = proj_j_118.left;
                                                        right = proj_j_118.right;
                                                        var_j_125 = tt;
                                                        proj_j_126 = var_j_125.checker;
                                                        var_j_127 = left;
                                                        appl_j_128 = proj_j_126 var_j_127;
                                                        lbl_check_b_97 = appl_j_128;
                                                        var_j_129 = lbl_check_b_97;
                                                        if_j_135 = var_j_129 ? (
                                                                var_j_130 = tt;
                                                                proj_j_131 = var_j_130.checker;
                                                                var_j_132 = right;
                                                                appl_j_133 = proj_j_131 var_j_132
                                                            ) : (
                                                                var_j_134 = lbl_check_b_97
                                                            )
                                                    ) : (
                                                        m_match_cond_j_121 = m_match_bool_j_120 ? (
                                                                var_j_122 = rec_fail_b_93
                                                            ) : (
                                                                void_j_119 = 
                                                                    {}
                                                            )
                                                    )
                                            ) : (
                                                m_match_cond_j_113 = m_match_bool_j_112 ? (
                                                        var_j_114 = rec_fail_b_94
                                                    ) : (
                                                        void_j_111 = 
                                                            {}
                                                    )
                                            )
                                    ) : (
                                        m_match_cond_j_105 = m_match_bool_j_104 ? (
                                                var_j_106 = rec_fail_b_95
                                            ) : (
                                                void_j_103 = {}
                                            )
                                    ));
                            flatten_fun_j_152 = fun bj_null -> (
                                var_j_137 = tt;
                                proj_j_138 = var_j_137.generator;
                                int_j_139 = 0;
                                appl_j_140 = proj_j_138 int_j_139;
                                right_b_92 = appl_j_140;
                                var_j_141 = tt;
                                proj_j_142 = var_j_141.generator;
                                int_j_143 = 0;
                                appl_j_144 = proj_j_142 int_j_143;
                                left_b_91 = appl_j_144;
                                var_j_145 = left_b_91;
                                var_j_146 = right_b_92;
                                record_j_147 = {left = var_j_145, right = var_j_146};
                                record_j_148 = {};
                                record_j_149 = {};
                                record_j_150 = {left = record_j_148, right = record_j_149};
                                record_j_151 = {bj_actual_rec = record_j_147, bj_decl_lbls = record_j_150});
                            record_j_153 = {checker = flatten_fun_j_136, generator = flatten_fun_j_152};
                            proj_j_154 = record_j_153.checker;
                            var_j_155 = expr_b_131;
                            appl_j_156 = proj_j_154 var_j_155;
                            if_j_234 = appl_j_156 ? (
                                    bool_j_157 = true
                                ) : (
                                    flatten_fun_j_202 = fun expr_b_106 -> (
                                        bool_j_158 = false;
                                        rec_fail_b_105 = bool_j_158;
                                        bool_j_159 = false;
                                        rec_fail_b_104 = bool_j_159;
                                        bool_j_160 = false;
                                        rec_fail_b_103 = bool_j_160;
                                        var_j_161 = expr_b_106;
                                        m_match_bool_j_163 = var_j_161 ~ any;
                                        m_match_bool_j_166 = var_j_161 ~ 
                                            {bj_actual_rec, _};
                                        m_match_cond_j_167 = m_match_bool_j_166 ? (
                                                var_j_168 = expr_b_106;
                                                proj_j_169 = var_j_168.bj_decl_lbls;
                                                m_match_bool_j_171 = proj_j_169 ~ any;
                                                m_match_bool_j_174 = proj_j_169 ~ 
                                                    {leaf, _};
                                                m_match_cond_j_175 = m_match_bool_j_174 ? (
                                                        leaf_j_6 = proj_j_169.leaf;
                                                        var_j_176 = expr_b_106;
                                                        proj_j_177 = var_j_176.bj_actual_rec;
                                                        m_match_bool_j_179 = proj_j_177 ~ any;
                                                        m_match_bool_j_182 = proj_j_177 ~ 
                                                            {leaf, _};
                                                        m_match_cond_j_183 = m_match_bool_j_182 ? (
                                                                leaf = proj_j_177.leaf;
                                                                bool_j_184 = false;
                                                                fail_b_108 = bool_j_184;
                                                                flatten_fun_j_193 = fun expr_b_107 -> (
                                                                    var_j_185 = expr_b_107;
                                                                    m_match_bool_j_187 = var_j_185 ~ any;
                                                                    m_match_bool_j_190 = var_j_185 ~ bool;
                                                                    m_match_cond_j_191 = m_match_bool_j_190 ? (
                                                                        bool_j_192 = true
                                                                    ) : (
                                                                        m_match_cond_j_188 = m_match_bool_j_187 ? (
                                                                        var_j_189 = fail_b_108
                                                                    ) : (
                                                                        void_j_186 = 
                                                                    {}
                                                                    )
                                                                    ));
                                                                flatten_fun_j_197 = fun bj_null_j_5 -> (
                                                                    int_j_194 = 0;
                                                                    input_j_195 = input;
                                                                    m_bl_i_1080 = int_j_194 ~ int;
                                                                    m_br_i_1081 = input_j_195 ~ int;
                                                                    m_b_i_1082 = m_bl_i_1080 and m_br_i_1081;
                                                                    binop_j_196 = m_b_i_1082 ? (
                                                                        c_binop_i_1083 = int_j_194 <= input_j_195
                                                                    ) : (
                                                                        ab_i_1084 = abort
                                                                    ));
                                                                record_j_198 = 
                                                                    {checker = flatten_fun_j_193, generator = flatten_fun_j_197};
                                                                proj_j_199 = record_j_198.checker;
                                                                var_j_200 = leaf;
                                                                appl_j_201 = proj_j_199 var_j_200
                                                            ) : (
                                                                m_match_cond_j_180 = m_match_bool_j_179 ? (
                                                                        
                                                                    var_j_181 = rec_fail_b_103
                                                                    ) : (
                                                                        
                                                                    void_j_178 = 
                                                                    {}
                                                                    )
                                                            )
                                                    ) : (
                                                        m_match_cond_j_172 = m_match_bool_j_171 ? (
                                                                var_j_173 = rec_fail_b_104
                                                            ) : (
                                                                void_j_170 = 
                                                                    {}
                                                            )
                                                    )
                                            ) : (
                                                m_match_cond_j_164 = m_match_bool_j_163 ? (
                                                        var_j_165 = rec_fail_b_105
                                                    ) : (
                                                        void_j_162 = 
                                                            {}
                                                    )
                                            ));
                                    flatten_fun_j_226 = fun bj_null_j_8 -> (
                                        bool_j_203 = false;
                                        fail_b_101 = bool_j_203;
                                        flatten_fun_j_212 = fun expr_b_100 -> (
                                            var_j_204 = expr_b_100;
                                            m_match_bool_j_206 = var_j_204 ~ any;
                                            m_match_bool_j_209 = var_j_204 ~ bool;
                                            m_match_cond_j_210 = m_match_bool_j_209 ? (
                                                    bool_j_211 = true
                                                ) : (
                                                    m_match_cond_j_207 = m_match_bool_j_206 ? (
                                                            var_j_208 = fail_b_101
                                                        ) : (
                                                            void_j_205 = 
                                                                {}
                                                        )
                                                ));
                                        flatten_fun_j_216 = fun bj_null_j_7 -> (
                                            int_j_213 = 0;
                                            input_j_214 = input;
                                            m_bl_i_1085 = int_j_213 ~ int;
                                            m_br_i_1086 = input_j_214 ~ int;
                                            m_b_i_1087 = m_bl_i_1085 and m_br_i_1086;
                                            binop_j_215 = m_b_i_1087 ? (
                                                    c_binop_i_1088 = int_j_213 <= input_j_214
                                                ) : (
                                                    ab_i_1089 = abort
                                                ));
                                        record_j_217 = {checker = flatten_fun_j_212, generator = flatten_fun_j_216};
                                        proj_j_218 = record_j_217.generator;
                                        int_j_219 = 0;
                                        appl_j_220 = proj_j_218 int_j_219;
                                        leaf_b_99 = appl_j_220;
                                        var_j_221 = leaf_b_99;
                                        record_j_222 = {leaf = var_j_221};
                                        record_j_223 = {};
                                        record_j_224 = {leaf = record_j_223};
                                        record_j_225 = {bj_actual_rec = record_j_222, bj_decl_lbls = record_j_224});
                                    record_j_227 = {checker = flatten_fun_j_202, generator = flatten_fun_j_226};
                                    proj_j_228 = record_j_227.checker;
                                    var_j_229 = expr_b_131;
                                    appl_j_230 = proj_j_228 var_j_229;
                                    if_j_233 = appl_j_230 ? (
                                            bool_j_231 = true
                                        ) : (
                                            var_j_232 = fail_b_133
                                        )
                                )
                        ) : (
                            flatten_fun_j_279 = fun expr_b_126 -> (
                                bool_j_235 = false;
                                rec_fail_b_125 = bool_j_235;
                                bool_j_236 = false;
                                rec_fail_b_124 = bool_j_236;
                                bool_j_237 = false;
                                rec_fail_b_123 = bool_j_237;
                                var_j_238 = expr_b_126;
                                m_match_bool_j_240 = var_j_238 ~ any;
                                m_match_bool_j_243 = var_j_238 ~ {bj_actual_rec, _};
                                m_match_cond_j_244 = m_match_bool_j_243 ? (
                                        var_j_245 = expr_b_126;
                                        proj_j_246 = var_j_245.bj_decl_lbls;
                                        m_match_bool_j_248 = proj_j_246 ~ any;
                                        m_match_bool_j_251 = proj_j_246 ~ 
                                            {leaf, _};
                                        m_match_cond_j_252 = m_match_bool_j_251 ? (
                                                leaf_j_11 = proj_j_246.leaf;
                                                var_j_253 = expr_b_126;
                                                proj_j_254 = var_j_253.bj_actual_rec;
                                                m_match_bool_j_256 = proj_j_254 ~ any;
                                                m_match_bool_j_259 = proj_j_254 ~ 
                                                    {leaf, _};
                                                m_match_cond_j_260 = m_match_bool_j_259 ? (
                                                        leaf_j_10 = proj_j_254.leaf;
                                                        bool_j_261 = false;
                                                        fail_b_128 = bool_j_261;
                                                        flatten_fun_j_270 = fun expr_b_127 -> (
                                                            var_j_262 = expr_b_127;
                                                            m_match_bool_j_264 = var_j_262 ~ any;
                                                            m_match_bool_j_267 = var_j_262 ~ bool;
                                                            m_match_cond_j_268 = m_match_bool_j_267 ? (
                                                                    bool_j_269 = true
                                                                ) : (
                                                                    m_match_cond_j_265 = m_match_bool_j_264 ? (
                                                                        var_j_266 = fail_b_128
                                                                    ) : (
                                                                        void_j_263 = 
                                                                    {}
                                                                    )
                                                                ));
                                                        flatten_fun_j_274 = fun bj_null_j_9 -> (
                                                            int_j_271 = 0;
                                                            input_j_272 = input;
                                                            m_bl_i_1090 = int_j_271 ~ int;
                                                            m_br_i_1091 = input_j_272 ~ int;
                                                            m_b_i_1092 = m_bl_i_1090 and m_br_i_1091;
                                                            binop_j_273 = m_b_i_1092 ? (
                                                                    c_binop_i_1093 = int_j_271 <= input_j_272
                                                                ) : (
                                                                    ab_i_1094 = abort
                                                                ));
                                                        record_j_275 = 
                                                            {checker = flatten_fun_j_270, generator = flatten_fun_j_274};
                                                        proj_j_276 = record_j_275.checker;
                                                        var_j_277 = leaf_j_10;
                                                        appl_j_278 = proj_j_276 var_j_277
                                                    ) : (
                                                        m_match_cond_j_257 = m_match_bool_j_256 ? (
                                                                var_j_258 = rec_fail_b_123
                                                            ) : (
                                                                void_j_255 = 
                                                                    {}
                                                            )
                                                    )
                                            ) : (
                                                m_match_cond_j_249 = m_match_bool_j_248 ? (
                                                        var_j_250 = rec_fail_b_124
                                                    ) : (
                                                        void_j_247 = 
                                                            {}
                                                    )
                                            )
                                    ) : (
                                        m_match_cond_j_241 = m_match_bool_j_240 ? (
                                                var_j_242 = rec_fail_b_125
                                            ) : (
                                                void_j_239 = {}
                                            )
                                    ));
                            flatten_fun_j_303 = fun bj_null_j_13 -> (
                                bool_j_280 = false;
                                fail_b_121 = bool_j_280;
                                flatten_fun_j_289 = fun expr_b_120 -> (
                                    var_j_281 = expr_b_120;
                                    m_match_bool_j_283 = var_j_281 ~ any;
                                    m_match_bool_j_286 = var_j_281 ~ bool;
                                    m_match_cond_j_287 = m_match_bool_j_286 ? (
                                            bool_j_288 = true
                                        ) : (
                                            m_match_cond_j_284 = m_match_bool_j_283 ? (
                                                    var_j_285 = fail_b_121
                                                ) : (
                                                    void_j_282 = {}
                                                )
                                        ));
                                flatten_fun_j_293 = fun bj_null_j_12 -> (
                                    int_j_290 = 0;
                                    input_j_291 = input;
                                    m_bl_i_1095 = int_j_290 ~ int;
                                    m_br_i_1096 = input_j_291 ~ int;
                                    m_b_i_1097 = m_bl_i_1095 and m_br_i_1096;
                                    binop_j_292 = m_b_i_1097 ? (
                                            c_binop_i_1098 = int_j_290 <= input_j_291
                                        ) : (
                                            ab_i_1099 = abort
                                        ));
                                record_j_294 = {checker = flatten_fun_j_289, generator = flatten_fun_j_293};
                                proj_j_295 = record_j_294.generator;
                                int_j_296 = 0;
                                appl_j_297 = proj_j_295 int_j_296;
                                leaf_b_119 = appl_j_297;
                                var_j_298 = leaf_b_119;
                                record_j_299 = {leaf = var_j_298};
                                record_j_300 = {};
                                record_j_301 = {leaf = record_j_300};
                                record_j_302 = {bj_actual_rec = record_j_299, bj_decl_lbls = record_j_301});
                            record_j_304 = {checker = flatten_fun_j_279, generator = flatten_fun_j_303};
                            proj_j_305 = record_j_304.checker;
                            var_j_306 = expr_b_131;
                            appl_j_307 = proj_j_305 var_j_306;
                            if_j_370 = appl_j_307 ? (
                                    bool_j_308 = true
                                ) : (
                                    flatten_fun_j_346 = fun expr_b_116 -> (
                                        bool_j_309 = false;
                                        rec_fail_b_115 = bool_j_309;
                                        bool_j_310 = false;
                                        rec_fail_b_114 = bool_j_310;
                                        bool_j_311 = false;
                                        rec_fail_b_113 = bool_j_311;
                                        var_j_312 = expr_b_116;
                                        m_match_bool_j_314 = var_j_312 ~ any;
                                        m_match_bool_j_317 = var_j_312 ~ 
                                            {bj_actual_rec, _};
                                        m_match_cond_j_318 = m_match_bool_j_317 ? (
                                                var_j_319 = expr_b_116;
                                                proj_j_320 = var_j_319.bj_decl_lbls;
                                                m_match_bool_j_322 = proj_j_320 ~ any;
                                                m_match_bool_j_325 = proj_j_320 ~ 
                                                    {left, right, _};
                                                m_match_cond_j_326 = m_match_bool_j_325 ? (
                                                        left_j_17 = proj_j_320.left;
                                                        right_j_16 = proj_j_320.right;
                                                        var_j_327 = expr_b_116;
                                                        proj_j_328 = var_j_327.bj_actual_rec;
                                                        m_match_bool_j_330 = proj_j_328 ~ any;
                                                        m_match_bool_j_333 = proj_j_328 ~ 
                                                            {left, right, _};
                                                        m_match_cond_j_334 = m_match_bool_j_333 ? (
                                                                left_j_15 = proj_j_328.left;
                                                                right_j_14 = proj_j_328.right;
                                                                var_j_335 = tt;
                                                                proj_j_336 = var_j_335.checker;
                                                                var_j_337 = left_j_15;
                                                                appl_j_338 = proj_j_336 var_j_337;
                                                                lbl_check_b_117 = appl_j_338;
                                                                var_j_339 = lbl_check_b_117;
                                                                if_j_345 = var_j_339 ? (
                                                                        
                                                                    var_j_340 = tt;
                                                                    proj_j_341 = var_j_340.checker;
                                                                    var_j_342 = right_j_14;
                                                                    appl_j_343 = proj_j_341 var_j_342
                                                                    ) : (
                                                                        
                                                                    var_j_344 = lbl_check_b_117
                                                                    )
                                                            ) : (
                                                                m_match_cond_j_331 = m_match_bool_j_330 ? (
                                                                        
                                                                    var_j_332 = rec_fail_b_113
                                                                    ) : (
                                                                        
                                                                    void_j_329 = 
                                                                    {}
                                                                    )
                                                            )
                                                    ) : (
                                                        m_match_cond_j_323 = m_match_bool_j_322 ? (
                                                                var_j_324 = rec_fail_b_114
                                                            ) : (
                                                                void_j_321 = 
                                                                    {}
                                                            )
                                                    )
                                            ) : (
                                                m_match_cond_j_315 = m_match_bool_j_314 ? (
                                                        var_j_316 = rec_fail_b_115
                                                    ) : (
                                                        void_j_313 = 
                                                            {}
                                                    )
                                            ));
                                    flatten_fun_j_362 = fun bj_null_j_18 -> (
                                        var_j_347 = tt;
                                        proj_j_348 = var_j_347.generator;
                                        int_j_349 = 0;
                                        appl_j_350 = proj_j_348 int_j_349;
                                        right_b_112 = appl_j_350;
                                        var_j_351 = tt;
                                        proj_j_352 = var_j_351.generator;
                                        int_j_353 = 0;
                                        appl_j_354 = proj_j_352 int_j_353;
                                        left_b_111 = appl_j_354;
                                        var_j_355 = left_b_111;
                                        var_j_356 = right_b_112;
                                        record_j_357 = {left = var_j_355, right = var_j_356};
                                        record_j_358 = {};
                                        record_j_359 = {};
                                        record_j_360 = {left = record_j_358, right = record_j_359};
                                        record_j_361 = {bj_actual_rec = record_j_357, bj_decl_lbls = record_j_360});
                                    record_j_363 = {checker = flatten_fun_j_346, generator = flatten_fun_j_362};
                                    proj_j_364 = record_j_363.checker;
                                    var_j_365 = expr_b_131;
                                    appl_j_366 = proj_j_364 var_j_365;
                                    if_j_369 = appl_j_366 ? (
                                            bool_j_367 = true
                                        ) : (
                                            var_j_368 = fail_b_133
                                        )
                                )
                        ));
                flatten_fun_j_509 = fun bj_null_j_29 -> (
                    input_j_373 = input;
                    select_int_b_90 = input_j_373;
                    int_j_374 = 0;
                    var_j_375 = select_int_b_90;
                    binop_j_376 = int_j_374 <= var_j_375;
                    if_j_508 = binop_j_376 ? (
                            flatten_fun_j_414 = fun expr_b_75 -> (
                                bool_j_377 = false;
                                rec_fail_b_74 = bool_j_377;
                                bool_j_378 = false;
                                rec_fail_b_73 = bool_j_378;
                                bool_j_379 = false;
                                rec_fail_b_72 = bool_j_379;
                                var_j_380 = expr_b_75;
                                m_match_bool_j_382 = var_j_380 ~ any;
                                m_match_bool_j_385 = var_j_380 ~ {bj_actual_rec, _};
                                m_match_cond_j_386 = m_match_bool_j_385 ? (
                                        var_j_387 = expr_b_75;
                                        proj_j_388 = var_j_387.bj_decl_lbls;
                                        m_match_bool_j_390 = proj_j_388 ~ any;
                                        m_match_bool_j_393 = proj_j_388 ~ 
                                            {left, right, _};
                                        m_match_cond_j_394 = m_match_bool_j_393 ? (
                                                left_j_22 = proj_j_388.left;
                                                right_j_21 = proj_j_388.right;
                                                var_j_395 = expr_b_75;
                                                proj_j_396 = var_j_395.bj_actual_rec;
                                                m_match_bool_j_398 = proj_j_396 ~ any;
                                                m_match_bool_j_401 = proj_j_396 ~ 
                                                    {left, right, _};
                                                m_match_cond_j_402 = m_match_bool_j_401 ? (
                                                        left_j_20 = proj_j_396.left;
                                                        right_j_19 = proj_j_396.right;
                                                        var_j_403 = tt;
                                                        proj_j_404 = var_j_403.checker;
                                                        var_j_405 = left_j_20;
                                                        appl_j_406 = proj_j_404 var_j_405;
                                                        lbl_check_b_76 = appl_j_406;
                                                        var_j_407 = lbl_check_b_76;
                                                        if_j_413 = var_j_407 ? (
                                                                var_j_408 = tt;
                                                                proj_j_409 = var_j_408.checker;
                                                                var_j_410 = right_j_19;
                                                                appl_j_411 = proj_j_409 var_j_410
                                                            ) : (
                                                                var_j_412 = lbl_check_b_76
                                                            )
                                                    ) : (
                                                        m_match_cond_j_399 = m_match_bool_j_398 ? (
                                                                var_j_400 = rec_fail_b_72
                                                            ) : (
                                                                void_j_397 = 
                                                                    {}
                                                            )
                                                    )
                                            ) : (
                                                m_match_cond_j_391 = m_match_bool_j_390 ? (
                                                        var_j_392 = rec_fail_b_73
                                                    ) : (
                                                        void_j_389 = 
                                                            {}
                                                    )
                                            )
                                    ) : (
                                        m_match_cond_j_383 = m_match_bool_j_382 ? (
                                                var_j_384 = rec_fail_b_74
                                            ) : (
                                                void_j_381 = {}
                                            )
                                    ));
                            flatten_fun_j_430 = fun bj_null_j_23 -> (
                                var_j_415 = tt;
                                proj_j_416 = var_j_415.generator;
                                int_j_417 = 0;
                                appl_j_418 = proj_j_416 int_j_417;
                                right_b_71 = appl_j_418;
                                var_j_419 = tt;
                                proj_j_420 = var_j_419.generator;
                                int_j_421 = 0;
                                appl_j_422 = proj_j_420 int_j_421;
                                left_b_70 = appl_j_422;
                                var_j_423 = left_b_70;
                                var_j_424 = right_b_71;
                                record_j_425 = {left = var_j_423, right = var_j_424};
                                record_j_426 = {};
                                record_j_427 = {};
                                record_j_428 = {left = record_j_426, right = record_j_427};
                                record_j_429 = {bj_actual_rec = record_j_425, bj_decl_lbls = record_j_428});
                            record_j_431 = {checker = flatten_fun_j_414, generator = flatten_fun_j_430};
                            proj_j_432 = record_j_431.generator;
                            int_j_433 = 0;
                            appl_j_434 = proj_j_432 int_j_433
                        ) : (
                            flatten_fun_j_479 = fun expr_b_85 -> (
                                bool_j_435 = false;
                                rec_fail_b_84 = bool_j_435;
                                bool_j_436 = false;
                                rec_fail_b_83 = bool_j_436;
                                bool_j_437 = false;
                                rec_fail_b_82 = bool_j_437;
                                var_j_438 = expr_b_85;
                                m_match_bool_j_440 = var_j_438 ~ any;
                                m_match_bool_j_443 = var_j_438 ~ {bj_actual_rec, _};
                                m_match_cond_j_444 = m_match_bool_j_443 ? (
                                        var_j_445 = expr_b_85;
                                        proj_j_446 = var_j_445.bj_decl_lbls;
                                        m_match_bool_j_448 = proj_j_446 ~ any;
                                        m_match_bool_j_451 = proj_j_446 ~ 
                                            {leaf, _};
                                        m_match_cond_j_452 = m_match_bool_j_451 ? (
                                                leaf_j_26 = proj_j_446.leaf;
                                                var_j_453 = expr_b_85;
                                                proj_j_454 = var_j_453.bj_actual_rec;
                                                m_match_bool_j_456 = proj_j_454 ~ any;
                                                m_match_bool_j_459 = proj_j_454 ~ 
                                                    {leaf, _};
                                                m_match_cond_j_460 = m_match_bool_j_459 ? (
                                                        leaf_j_25 = proj_j_454.leaf;
                                                        bool_j_461 = false;
                                                        fail_b_87 = bool_j_461;
                                                        flatten_fun_j_470 = fun expr_b_86 -> (
                                                            var_j_462 = expr_b_86;
                                                            m_match_bool_j_464 = var_j_462 ~ any;
                                                            m_match_bool_j_467 = var_j_462 ~ bool;
                                                            m_match_cond_j_468 = m_match_bool_j_467 ? (
                                                                    bool_j_469 = true
                                                                ) : (
                                                                    m_match_cond_j_465 = m_match_bool_j_464 ? (
                                                                        var_j_466 = fail_b_87
                                                                    ) : (
                                                                        void_j_463 = 
                                                                    {}
                                                                    )
                                                                ));
                                                        flatten_fun_j_474 = fun bj_null_j_24 -> (
                                                            int_j_471 = 0;
                                                            input_j_472 = input;
                                                            m_bl_i_1100 = int_j_471 ~ int;
                                                            m_br_i_1101 = input_j_472 ~ int;
                                                            m_b_i_1102 = m_bl_i_1100 and m_br_i_1101;
                                                            binop_j_473 = m_b_i_1102 ? (
                                                                    c_binop_i_1103 = int_j_471 <= input_j_472
                                                                ) : (
                                                                    ab_i_1104 = abort
                                                                ));
                                                        record_j_475 = 
                                                            {checker = flatten_fun_j_470, generator = flatten_fun_j_474};
                                                        proj_j_476 = record_j_475.checker;
                                                        var_j_477 = leaf_j_25;
                                                        appl_j_478 = proj_j_476 var_j_477
                                                    ) : (
                                                        m_match_cond_j_457 = m_match_bool_j_456 ? (
                                                                var_j_458 = rec_fail_b_82
                                                            ) : (
                                                                void_j_455 = 
                                                                    {}
                                                            )
                                                    )
                                            ) : (
                                                m_match_cond_j_449 = m_match_bool_j_448 ? (
                                                        var_j_450 = rec_fail_b_83
                                                    ) : (
                                                        void_j_447 = 
                                                            {}
                                                    )
                                            )
                                    ) : (
                                        m_match_cond_j_441 = m_match_bool_j_440 ? (
                                                var_j_442 = rec_fail_b_84
                                            ) : (
                                                void_j_439 = {}
                                            )
                                    ));
                            flatten_fun_j_503 = fun bj_null_j_28 -> (
                                bool_j_480 = false;
                                fail_b_80 = bool_j_480;
                                flatten_fun_j_489 = fun expr_b_79 -> (
                                    var_j_481 = expr_b_79;
                                    m_match_bool_j_483 = var_j_481 ~ any;
                                    m_match_bool_j_486 = var_j_481 ~ bool;
                                    m_match_cond_j_487 = m_match_bool_j_486 ? (
                                            bool_j_488 = true
                                        ) : (
                                            m_match_cond_j_484 = m_match_bool_j_483 ? (
                                                    var_j_485 = fail_b_80
                                                ) : (
                                                    void_j_482 = {}
                                                )
                                        ));
                                flatten_fun_j_493 = fun bj_null_j_27 -> (
                                    int_j_490 = 0;
                                    input_j_491 = input;
                                    m_bl_i_1105 = int_j_490 ~ int;
                                    m_br_i_1106 = input_j_491 ~ int;
                                    m_b_i_1107 = m_bl_i_1105 and m_br_i_1106;
                                    binop_j_492 = m_b_i_1107 ? (
                                            c_binop_i_1108 = int_j_490 <= input_j_491
                                        ) : (
                                            ab_i_1109 = abort
                                        ));
                                record_j_494 = {checker = flatten_fun_j_489, generator = flatten_fun_j_493};
                                proj_j_495 = record_j_494.generator;
                                int_j_496 = 0;
                                appl_j_497 = proj_j_495 int_j_496;
                                leaf_b_78 = appl_j_497;
                                var_j_498 = leaf_b_78;
                                record_j_499 = {leaf = var_j_498};
                                record_j_500 = {};
                                record_j_501 = {leaf = record_j_500};
                                record_j_502 = {bj_actual_rec = record_j_499, bj_decl_lbls = record_j_501});
                            record_j_504 = {checker = flatten_fun_j_479, generator = flatten_fun_j_503};
                            proj_j_505 = record_j_504.generator;
                            int_j_506 = 0;
                            appl_j_507 = proj_j_505 int_j_506
                        ));
                record_j_510 = {checker = flatten_fun_j_372, generator = flatten_fun_j_509};
                proj_j_511 = record_j_510.checker;
                var_j_512 = expr_b_135;
                appl_j_513 = proj_j_511 var_j_512);
            var_j_515 = self_b_0;
            int_j_516 = 0;
            appl_j_517 = var_j_515 int_j_516;
            appl_j_518 = flatten_fun_j_514 appl_j_517);
        flatten_fun_j_945 = fun bj_null_j_62 -> (
            flatten_fun_j_940 = fun tt_j_61 -> (
                flatten_fun_j_798 = fun expr_b_66 -> (
                    input_j_520 = input;
                    select_int_b_67 = input_j_520;
                    bool_j_521 = false;
                    fail_b_68 = bool_j_521;
                    int_j_522 = 0;
                    var_j_523 = select_int_b_67;
                    binop_j_524 = int_j_522 <= var_j_523;
                    if_j_797 = binop_j_524 ? (
                            flatten_fun_j_562 = fun expr_b_31 -> (
                                bool_j_525 = false;
                                rec_fail_b_30 = bool_j_525;
                                bool_j_526 = false;
                                rec_fail_b_29 = bool_j_526;
                                bool_j_527 = false;
                                rec_fail_b_28 = bool_j_527;
                                var_j_528 = expr_b_31;
                                m_match_bool_j_530 = var_j_528 ~ any;
                                m_match_bool_j_533 = var_j_528 ~ {bj_actual_rec, _};
                                m_match_cond_j_534 = m_match_bool_j_533 ? (
                                        var_j_535 = expr_b_31;
                                        proj_j_536 = var_j_535.bj_decl_lbls;
                                        m_match_bool_j_538 = proj_j_536 ~ any;
                                        m_match_bool_j_541 = proj_j_536 ~ 
                                            {left, right, _};
                                        m_match_cond_j_542 = m_match_bool_j_541 ? (
                                                left_j_33 = proj_j_536.left;
                                                right_j_32 = proj_j_536.right;
                                                var_j_543 = expr_b_31;
                                                proj_j_544 = var_j_543.bj_actual_rec;
                                                m_match_bool_j_546 = proj_j_544 ~ any;
                                                m_match_bool_j_549 = proj_j_544 ~ 
                                                    {left, right, _};
                                                m_match_cond_j_550 = m_match_bool_j_549 ? (
                                                        left_j_31 = proj_j_544.left;
                                                        right_j_30 = proj_j_544.right;
                                                        var_j_551 = tt_j_61;
                                                        proj_j_552 = var_j_551.checker;
                                                        var_j_553 = left_j_31;
                                                        appl_j_554 = proj_j_552 var_j_553;
                                                        lbl_check_b_32 = appl_j_554;
                                                        var_j_555 = lbl_check_b_32;
                                                        if_j_561 = var_j_555 ? (
                                                                var_j_556 = tt_j_61;
                                                                proj_j_557 = var_j_556.checker;
                                                                var_j_558 = right_j_30;
                                                                appl_j_559 = proj_j_557 var_j_558
                                                            ) : (
                                                                var_j_560 = lbl_check_b_32
                                                            )
                                                    ) : (
                                                        m_match_cond_j_547 = m_match_bool_j_546 ? (
                                                                var_j_548 = rec_fail_b_28
                                                            ) : (
                                                                void_j_545 = 
                                                                    {}
                                                            )
                                                    )
                                            ) : (
                                                m_match_cond_j_539 = m_match_bool_j_538 ? (
                                                        var_j_540 = rec_fail_b_29
                                                    ) : (
                                                        void_j_537 = 
                                                            {}
                                                    )
                                            )
                                    ) : (
                                        m_match_cond_j_531 = m_match_bool_j_530 ? (
                                                var_j_532 = rec_fail_b_30
                                            ) : (
                                                void_j_529 = {}
                                            )
                                    ));
                            flatten_fun_j_578 = fun bj_null_j_34 -> (
                                var_j_563 = tt_j_61;
                                proj_j_564 = var_j_563.generator;
                                int_j_565 = 0;
                                appl_j_566 = proj_j_564 int_j_565;
                                right_b_27 = appl_j_566;
                                var_j_567 = tt_j_61;
                                proj_j_568 = var_j_567.generator;
                                int_j_569 = 0;
                                appl_j_570 = proj_j_568 int_j_569;
                                left_b_26 = appl_j_570;
                                var_j_571 = left_b_26;
                                var_j_572 = right_b_27;
                                record_j_573 = {left = var_j_571, right = var_j_572};
                                record_j_574 = {};
                                record_j_575 = {};
                                record_j_576 = {left = record_j_574, right = record_j_575};
                                record_j_577 = {bj_actual_rec = record_j_573, bj_decl_lbls = record_j_576});
                            record_j_579 = {checker = flatten_fun_j_562, generator = flatten_fun_j_578};
                            proj_j_580 = record_j_579.checker;
                            var_j_581 = expr_b_66;
                            appl_j_582 = proj_j_580 var_j_581;
                            if_j_660 = appl_j_582 ? (
                                    bool_j_583 = true
                                ) : (
                                    flatten_fun_j_628 = fun expr_b_41 -> (
                                        bool_j_584 = false;
                                        rec_fail_b_40 = bool_j_584;
                                        bool_j_585 = false;
                                        rec_fail_b_39 = bool_j_585;
                                        bool_j_586 = false;
                                        rec_fail_b_38 = bool_j_586;
                                        var_j_587 = expr_b_41;
                                        m_match_bool_j_589 = var_j_587 ~ any;
                                        m_match_bool_j_592 = var_j_587 ~ 
                                            {bj_actual_rec, _};
                                        m_match_cond_j_593 = m_match_bool_j_592 ? (
                                                var_j_594 = expr_b_41;
                                                proj_j_595 = var_j_594.bj_decl_lbls;
                                                m_match_bool_j_597 = proj_j_595 ~ any;
                                                m_match_bool_j_600 = proj_j_595 ~ 
                                                    {leaf, _};
                                                m_match_cond_j_601 = m_match_bool_j_600 ? (
                                                        leaf_j_37 = proj_j_595.leaf;
                                                        var_j_602 = expr_b_41;
                                                        proj_j_603 = var_j_602.bj_actual_rec;
                                                        m_match_bool_j_605 = proj_j_603 ~ any;
                                                        m_match_bool_j_608 = proj_j_603 ~ 
                                                            {leaf, _};
                                                        m_match_cond_j_609 = m_match_bool_j_608 ? (
                                                                leaf_j_36 = proj_j_603.leaf;
                                                                bool_j_610 = false;
                                                                fail_b_43 = bool_j_610;
                                                                flatten_fun_j_619 = fun expr_b_42 -> (
                                                                    var_j_611 = expr_b_42;
                                                                    m_match_bool_j_613 = var_j_611 ~ any;
                                                                    m_match_bool_j_616 = var_j_611 ~ bool;
                                                                    m_match_cond_j_617 = m_match_bool_j_616 ? (
                                                                        bool_j_618 = true
                                                                    ) : (
                                                                        m_match_cond_j_614 = m_match_bool_j_613 ? (
                                                                        var_j_615 = fail_b_43
                                                                    ) : (
                                                                        void_j_612 = 
                                                                    {}
                                                                    )
                                                                    ));
                                                                flatten_fun_j_623 = fun bj_null_j_35 -> (
                                                                    int_j_620 = 0;
                                                                    input_j_621 = input;
                                                                    m_bl_i_1110 = int_j_620 ~ int;
                                                                    m_br_i_1111 = input_j_621 ~ int;
                                                                    m_b_i_1112 = m_bl_i_1110 and m_br_i_1111;
                                                                    binop_j_622 = m_b_i_1112 ? (
                                                                        c_binop_i_1113 = int_j_620 <= input_j_621
                                                                    ) : (
                                                                        ab_i_1114 = abort
                                                                    ));
                                                                record_j_624 = 
                                                                    {checker = flatten_fun_j_619, generator = flatten_fun_j_623};
                                                                proj_j_625 = record_j_624.checker;
                                                                var_j_626 = leaf_j_36;
                                                                appl_j_627 = proj_j_625 var_j_626
                                                            ) : (
                                                                m_match_cond_j_606 = m_match_bool_j_605 ? (
                                                                        
                                                                    var_j_607 = rec_fail_b_38
                                                                    ) : (
                                                                        
                                                                    void_j_604 = 
                                                                    {}
                                                                    )
                                                            )
                                                    ) : (
                                                        m_match_cond_j_598 = m_match_bool_j_597 ? (
                                                                var_j_599 = rec_fail_b_39
                                                            ) : (
                                                                void_j_596 = 
                                                                    {}
                                                            )
                                                    )
                                            ) : (
                                                m_match_cond_j_590 = m_match_bool_j_589 ? (
                                                        var_j_591 = rec_fail_b_40
                                                    ) : (
                                                        void_j_588 = 
                                                            {}
                                                    )
                                            ));
                                    flatten_fun_j_652 = fun bj_null_j_39 -> (
                                        bool_j_629 = false;
                                        fail_b_36 = bool_j_629;
                                        flatten_fun_j_638 = fun expr_b_35 -> (
                                            var_j_630 = expr_b_35;
                                            m_match_bool_j_632 = var_j_630 ~ any;
                                            m_match_bool_j_635 = var_j_630 ~ bool;
                                            m_match_cond_j_636 = m_match_bool_j_635 ? (
                                                    bool_j_637 = true
                                                ) : (
                                                    m_match_cond_j_633 = m_match_bool_j_632 ? (
                                                            var_j_634 = fail_b_36
                                                        ) : (
                                                            void_j_631 = 
                                                                {}
                                                        )
                                                ));
                                        flatten_fun_j_642 = fun bj_null_j_38 -> (
                                            int_j_639 = 0;
                                            input_j_640 = input;
                                            m_bl_i_1115 = int_j_639 ~ int;
                                            m_br_i_1116 = input_j_640 ~ int;
                                            m_b_i_1117 = m_bl_i_1115 and m_br_i_1116;
                                            binop_j_641 = m_b_i_1117 ? (
                                                    c_binop_i_1118 = int_j_639 <= input_j_640
                                                ) : (
                                                    ab_i_1119 = abort
                                                ));
                                        record_j_643 = {checker = flatten_fun_j_638, generator = flatten_fun_j_642};
                                        proj_j_644 = record_j_643.generator;
                                        int_j_645 = 0;
                                        appl_j_646 = proj_j_644 int_j_645;
                                        leaf_b_34 = appl_j_646;
                                        var_j_647 = leaf_b_34;
                                        record_j_648 = {leaf = var_j_647};
                                        record_j_649 = {};
                                        record_j_650 = {leaf = record_j_649};
                                        record_j_651 = {bj_actual_rec = record_j_648, bj_decl_lbls = record_j_650});
                                    record_j_653 = {checker = flatten_fun_j_628, generator = flatten_fun_j_652};
                                    proj_j_654 = record_j_653.checker;
                                    var_j_655 = expr_b_66;
                                    appl_j_656 = proj_j_654 var_j_655;
                                    if_j_659 = appl_j_656 ? (
                                            bool_j_657 = true
                                        ) : (
                                            var_j_658 = fail_b_68
                                        )
                                )
                        ) : (
                            flatten_fun_j_705 = fun expr_b_61 -> (
                                bool_j_661 = false;
                                rec_fail_b_60 = bool_j_661;
                                bool_j_662 = false;
                                rec_fail_b_59 = bool_j_662;
                                bool_j_663 = false;
                                rec_fail_b_58 = bool_j_663;
                                var_j_664 = expr_b_61;
                                m_match_bool_j_666 = var_j_664 ~ any;
                                m_match_bool_j_669 = var_j_664 ~ {bj_actual_rec, _};
                                m_match_cond_j_670 = m_match_bool_j_669 ? (
                                        var_j_671 = expr_b_61;
                                        proj_j_672 = var_j_671.bj_decl_lbls;
                                        m_match_bool_j_674 = proj_j_672 ~ any;
                                        m_match_bool_j_677 = proj_j_672 ~ 
                                            {leaf, _};
                                        m_match_cond_j_678 = m_match_bool_j_677 ? (
                                                leaf_j_42 = proj_j_672.leaf;
                                                var_j_679 = expr_b_61;
                                                proj_j_680 = var_j_679.bj_actual_rec;
                                                m_match_bool_j_682 = proj_j_680 ~ any;
                                                m_match_bool_j_685 = proj_j_680 ~ 
                                                    {leaf, _};
                                                m_match_cond_j_686 = m_match_bool_j_685 ? (
                                                        leaf_j_41 = proj_j_680.leaf;
                                                        bool_j_687 = false;
                                                        fail_b_63 = bool_j_687;
                                                        flatten_fun_j_696 = fun expr_b_62 -> (
                                                            var_j_688 = expr_b_62;
                                                            m_match_bool_j_690 = var_j_688 ~ any;
                                                            m_match_bool_j_693 = var_j_688 ~ bool;
                                                            m_match_cond_j_694 = m_match_bool_j_693 ? (
                                                                    bool_j_695 = true
                                                                ) : (
                                                                    m_match_cond_j_691 = m_match_bool_j_690 ? (
                                                                        var_j_692 = fail_b_63
                                                                    ) : (
                                                                        void_j_689 = 
                                                                    {}
                                                                    )
                                                                ));
                                                        flatten_fun_j_700 = fun bj_null_j_40 -> (
                                                            int_j_697 = 0;
                                                            input_j_698 = input;
                                                            m_bl_i_1120 = int_j_697 ~ int;
                                                            m_br_i_1121 = input_j_698 ~ int;
                                                            m_b_i_1122 = m_bl_i_1120 and m_br_i_1121;
                                                            binop_j_699 = m_b_i_1122 ? (
                                                                    c_binop_i_1123 = int_j_697 <= input_j_698
                                                                ) : (
                                                                    ab_i_1124 = abort
                                                                ));
                                                        record_j_701 = 
                                                            {checker = flatten_fun_j_696, generator = flatten_fun_j_700};
                                                        proj_j_702 = record_j_701.checker;
                                                        var_j_703 = leaf_j_41;
                                                        appl_j_704 = proj_j_702 var_j_703
                                                    ) : (
                                                        m_match_cond_j_683 = m_match_bool_j_682 ? (
                                                                var_j_684 = rec_fail_b_58
                                                            ) : (
                                                                void_j_681 = 
                                                                    {}
                                                            )
                                                    )
                                            ) : (
                                                m_match_cond_j_675 = m_match_bool_j_674 ? (
                                                        var_j_676 = rec_fail_b_59
                                                    ) : (
                                                        void_j_673 = 
                                                            {}
                                                    )
                                            )
                                    ) : (
                                        m_match_cond_j_667 = m_match_bool_j_666 ? (
                                                var_j_668 = rec_fail_b_60
                                            ) : (
                                                void_j_665 = {}
                                            )
                                    ));
                            flatten_fun_j_729 = fun bj_null_j_44 -> (
                                bool_j_706 = false;
                                fail_b_56 = bool_j_706;
                                flatten_fun_j_715 = fun expr_b_55 -> (
                                    var_j_707 = expr_b_55;
                                    m_match_bool_j_709 = var_j_707 ~ any;
                                    m_match_bool_j_712 = var_j_707 ~ bool;
                                    m_match_cond_j_713 = m_match_bool_j_712 ? (
                                            bool_j_714 = true
                                        ) : (
                                            m_match_cond_j_710 = m_match_bool_j_709 ? (
                                                    var_j_711 = fail_b_56
                                                ) : (
                                                    void_j_708 = {}
                                                )
                                        ));
                                flatten_fun_j_719 = fun bj_null_j_43 -> (
                                    int_j_716 = 0;
                                    input_j_717 = input;
                                    m_bl_i_1125 = int_j_716 ~ int;
                                    m_br_i_1126 = input_j_717 ~ int;
                                    m_b_i_1127 = m_bl_i_1125 and m_br_i_1126;
                                    binop_j_718 = m_b_i_1127 ? (
                                            c_binop_i_1128 = int_j_716 <= input_j_717
                                        ) : (
                                            ab_i_1129 = abort
                                        ));
                                record_j_720 = {checker = flatten_fun_j_715, generator = flatten_fun_j_719};
                                proj_j_721 = record_j_720.generator;
                                int_j_722 = 0;
                                appl_j_723 = proj_j_721 int_j_722;
                                leaf_b_54 = appl_j_723;
                                var_j_724 = leaf_b_54;
                                record_j_725 = {leaf = var_j_724};
                                record_j_726 = {};
                                record_j_727 = {leaf = record_j_726};
                                record_j_728 = {bj_actual_rec = record_j_725, bj_decl_lbls = record_j_727});
                            record_j_730 = {checker = flatten_fun_j_705, generator = flatten_fun_j_729};
                            proj_j_731 = record_j_730.checker;
                            var_j_732 = expr_b_66;
                            appl_j_733 = proj_j_731 var_j_732;
                            if_j_796 = appl_j_733 ? (
                                    bool_j_734 = true
                                ) : (
                                    flatten_fun_j_772 = fun expr_b_51 -> (
                                        bool_j_735 = false;
                                        rec_fail_b_50 = bool_j_735;
                                        bool_j_736 = false;
                                        rec_fail_b_49 = bool_j_736;
                                        bool_j_737 = false;
                                        rec_fail_b_48 = bool_j_737;
                                        var_j_738 = expr_b_51;
                                        m_match_bool_j_740 = var_j_738 ~ any;
                                        m_match_bool_j_743 = var_j_738 ~ 
                                            {bj_actual_rec, _};
                                        m_match_cond_j_744 = m_match_bool_j_743 ? (
                                                var_j_745 = expr_b_51;
                                                proj_j_746 = var_j_745.bj_decl_lbls;
                                                m_match_bool_j_748 = proj_j_746 ~ any;
                                                m_match_bool_j_751 = proj_j_746 ~ 
                                                    {left, right, _};
                                                m_match_cond_j_752 = m_match_bool_j_751 ? (
                                                        left_j_48 = proj_j_746.left;
                                                        right_j_47 = proj_j_746.right;
                                                        var_j_753 = expr_b_51;
                                                        proj_j_754 = var_j_753.bj_actual_rec;
                                                        m_match_bool_j_756 = proj_j_754 ~ any;
                                                        m_match_bool_j_759 = proj_j_754 ~ 
                                                            {left, right, _};
                                                        m_match_cond_j_760 = m_match_bool_j_759 ? (
                                                                left_j_46 = proj_j_754.left;
                                                                right_j_45 = proj_j_754.right;
                                                                var_j_761 = tt_j_61;
                                                                proj_j_762 = var_j_761.checker;
                                                                var_j_763 = left_j_46;
                                                                appl_j_764 = proj_j_762 var_j_763;
                                                                lbl_check_b_52 = appl_j_764;
                                                                var_j_765 = lbl_check_b_52;
                                                                if_j_771 = var_j_765 ? (
                                                                        
                                                                    var_j_766 = tt_j_61;
                                                                    proj_j_767 = var_j_766.checker;
                                                                    var_j_768 = right_j_45;
                                                                    appl_j_769 = proj_j_767 var_j_768
                                                                    ) : (
                                                                        
                                                                    var_j_770 = lbl_check_b_52
                                                                    )
                                                            ) : (
                                                                m_match_cond_j_757 = m_match_bool_j_756 ? (
                                                                        
                                                                    var_j_758 = rec_fail_b_48
                                                                    ) : (
                                                                        
                                                                    void_j_755 = 
                                                                    {}
                                                                    )
                                                            )
                                                    ) : (
                                                        m_match_cond_j_749 = m_match_bool_j_748 ? (
                                                                var_j_750 = rec_fail_b_49
                                                            ) : (
                                                                void_j_747 = 
                                                                    {}
                                                            )
                                                    )
                                            ) : (
                                                m_match_cond_j_741 = m_match_bool_j_740 ? (
                                                        var_j_742 = rec_fail_b_50
                                                    ) : (
                                                        void_j_739 = 
                                                            {}
                                                    )
                                            ));
                                    flatten_fun_j_788 = fun bj_null_j_49 -> (
                                        var_j_773 = tt_j_61;
                                        proj_j_774 = var_j_773.generator;
                                        int_j_775 = 0;
                                        appl_j_776 = proj_j_774 int_j_775;
                                        right_b_47 = appl_j_776;
                                        var_j_777 = tt_j_61;
                                        proj_j_778 = var_j_777.generator;
                                        int_j_779 = 0;
                                        appl_j_780 = proj_j_778 int_j_779;
                                        left_b_46 = appl_j_780;
                                        var_j_781 = left_b_46;
                                        var_j_782 = right_b_47;
                                        record_j_783 = {left = var_j_781, right = var_j_782};
                                        record_j_784 = {};
                                        record_j_785 = {};
                                        record_j_786 = {left = record_j_784, right = record_j_785};
                                        record_j_787 = {bj_actual_rec = record_j_783, bj_decl_lbls = record_j_786});
                                    record_j_789 = {checker = flatten_fun_j_772, generator = flatten_fun_j_788};
                                    proj_j_790 = record_j_789.checker;
                                    var_j_791 = expr_b_66;
                                    appl_j_792 = proj_j_790 var_j_791;
                                    if_j_795 = appl_j_792 ? (
                                            bool_j_793 = true
                                        ) : (
                                            var_j_794 = fail_b_68
                                        )
                                )
                        ));
                flatten_fun_j_935 = fun bj_null_j_60 -> (
                    input_j_799 = input;
                    select_int_b_25 = input_j_799;
                    int_j_800 = 0;
                    var_j_801 = select_int_b_25;
                    binop_j_802 = int_j_800 <= var_j_801;
                    if_j_934 = binop_j_802 ? (
                            flatten_fun_j_840 = fun expr_b_10 -> (
                                bool_j_803 = false;
                                rec_fail_b_9 = bool_j_803;
                                bool_j_804 = false;
                                rec_fail_b_8 = bool_j_804;
                                bool_j_805 = false;
                                rec_fail_b_7 = bool_j_805;
                                var_j_806 = expr_b_10;
                                m_match_bool_j_808 = var_j_806 ~ any;
                                m_match_bool_j_811 = var_j_806 ~ {bj_actual_rec, _};
                                m_match_cond_j_812 = m_match_bool_j_811 ? (
                                        var_j_813 = expr_b_10;
                                        proj_j_814 = var_j_813.bj_decl_lbls;
                                        m_match_bool_j_816 = proj_j_814 ~ any;
                                        m_match_bool_j_819 = proj_j_814 ~ 
                                            {left, right, _};
                                        m_match_cond_j_820 = m_match_bool_j_819 ? (
                                                left_j_53 = proj_j_814.left;
                                                right_j_52 = proj_j_814.right;
                                                var_j_821 = expr_b_10;
                                                proj_j_822 = var_j_821.bj_actual_rec;
                                                m_match_bool_j_824 = proj_j_822 ~ any;
                                                m_match_bool_j_827 = proj_j_822 ~ 
                                                    {left, right, _};
                                                m_match_cond_j_828 = m_match_bool_j_827 ? (
                                                        left_j_51 = proj_j_822.left;
                                                        right_j_50 = proj_j_822.right;
                                                        var_j_829 = tt_j_61;
                                                        proj_j_830 = var_j_829.checker;
                                                        var_j_831 = left_j_51;
                                                        appl_j_832 = proj_j_830 var_j_831;
                                                        lbl_check_b_11 = appl_j_832;
                                                        var_j_833 = lbl_check_b_11;
                                                        if_j_839 = var_j_833 ? (
                                                                var_j_834 = tt_j_61;
                                                                proj_j_835 = var_j_834.checker;
                                                                var_j_836 = right_j_50;
                                                                appl_j_837 = proj_j_835 var_j_836
                                                            ) : (
                                                                var_j_838 = lbl_check_b_11
                                                            )
                                                    ) : (
                                                        m_match_cond_j_825 = m_match_bool_j_824 ? (
                                                                var_j_826 = rec_fail_b_7
                                                            ) : (
                                                                void_j_823 = 
                                                                    {}
                                                            )
                                                    )
                                            ) : (
                                                m_match_cond_j_817 = m_match_bool_j_816 ? (
                                                        var_j_818 = rec_fail_b_8
                                                    ) : (
                                                        void_j_815 = 
                                                            {}
                                                    )
                                            )
                                    ) : (
                                        m_match_cond_j_809 = m_match_bool_j_808 ? (
                                                var_j_810 = rec_fail_b_9
                                            ) : (
                                                void_j_807 = {}
                                            )
                                    ));
                            flatten_fun_j_856 = fun bj_null_j_54 -> (
                                var_j_841 = tt_j_61;
                                proj_j_842 = var_j_841.generator;
                                int_j_843 = 0;
                                appl_j_844 = proj_j_842 int_j_843;
                                right_b_6 = appl_j_844;
                                var_j_845 = tt_j_61;
                                proj_j_846 = var_j_845.generator;
                                int_j_847 = 0;
                                appl_j_848 = proj_j_846 int_j_847;
                                left_b_5 = appl_j_848;
                                var_j_849 = left_b_5;
                                var_j_850 = right_b_6;
                                record_j_851 = {left = var_j_849, right = var_j_850};
                                record_j_852 = {};
                                record_j_853 = {};
                                record_j_854 = {left = record_j_852, right = record_j_853};
                                record_j_855 = {bj_actual_rec = record_j_851, bj_decl_lbls = record_j_854});
                            record_j_857 = {checker = flatten_fun_j_840, generator = flatten_fun_j_856};
                            proj_j_858 = record_j_857.generator;
                            int_j_859 = 0;
                            appl_j_860 = proj_j_858 int_j_859
                        ) : (
                            flatten_fun_j_905 = fun expr_b_20 -> (
                                bool_j_861 = false;
                                rec_fail_b_19 = bool_j_861;
                                bool_j_862 = false;
                                rec_fail_b_18 = bool_j_862;
                                bool_j_863 = false;
                                rec_fail_b_17 = bool_j_863;
                                var_j_864 = expr_b_20;
                                m_match_bool_j_866 = var_j_864 ~ any;
                                m_match_bool_j_869 = var_j_864 ~ {bj_actual_rec, _};
                                m_match_cond_j_870 = m_match_bool_j_869 ? (
                                        var_j_871 = expr_b_20;
                                        proj_j_872 = var_j_871.bj_decl_lbls;
                                        m_match_bool_j_874 = proj_j_872 ~ any;
                                        m_match_bool_j_877 = proj_j_872 ~ 
                                            {leaf, _};
                                        m_match_cond_j_878 = m_match_bool_j_877 ? (
                                                leaf_j_57 = proj_j_872.leaf;
                                                var_j_879 = expr_b_20;
                                                proj_j_880 = var_j_879.bj_actual_rec;
                                                m_match_bool_j_882 = proj_j_880 ~ any;
                                                m_match_bool_j_885 = proj_j_880 ~ 
                                                    {leaf, _};
                                                m_match_cond_j_886 = m_match_bool_j_885 ? (
                                                        leaf_j_56 = proj_j_880.leaf;
                                                        bool_j_887 = false;
                                                        fail_b_22 = bool_j_887;
                                                        flatten_fun_j_896 = fun expr_b_21 -> (
                                                            var_j_888 = expr_b_21;
                                                            m_match_bool_j_890 = var_j_888 ~ any;
                                                            m_match_bool_j_893 = var_j_888 ~ bool;
                                                            m_match_cond_j_894 = m_match_bool_j_893 ? (
                                                                    bool_j_895 = true
                                                                ) : (
                                                                    m_match_cond_j_891 = m_match_bool_j_890 ? (
                                                                        var_j_892 = fail_b_22
                                                                    ) : (
                                                                        void_j_889 = 
                                                                    {}
                                                                    )
                                                                ));
                                                        flatten_fun_j_900 = fun bj_null_j_55 -> (
                                                            int_j_897 = 0;
                                                            input_j_898 = input;
                                                            m_bl_i_1130 = int_j_897 ~ int;
                                                            m_br_i_1131 = input_j_898 ~ int;
                                                            m_b_i_1132 = m_bl_i_1130 and m_br_i_1131;
                                                            binop_j_899 = m_b_i_1132 ? (
                                                                    c_binop_i_1133 = int_j_897 <= input_j_898
                                                                ) : (
                                                                    ab_i_1134 = abort
                                                                ));
                                                        record_j_901 = 
                                                            {checker = flatten_fun_j_896, generator = flatten_fun_j_900};
                                                        proj_j_902 = record_j_901.checker;
                                                        var_j_903 = leaf_j_56;
                                                        appl_j_904 = proj_j_902 var_j_903
                                                    ) : (
                                                        m_match_cond_j_883 = m_match_bool_j_882 ? (
                                                                var_j_884 = rec_fail_b_17
                                                            ) : (
                                                                void_j_881 = 
                                                                    {}
                                                            )
                                                    )
                                            ) : (
                                                m_match_cond_j_875 = m_match_bool_j_874 ? (
                                                        var_j_876 = rec_fail_b_18
                                                    ) : (
                                                        void_j_873 = 
                                                            {}
                                                    )
                                            )
                                    ) : (
                                        m_match_cond_j_867 = m_match_bool_j_866 ? (
                                                var_j_868 = rec_fail_b_19
                                            ) : (
                                                void_j_865 = {}
                                            )
                                    ));
                            flatten_fun_j_929 = fun bj_null_j_59 -> (
                                bool_j_906 = false;
                                fail_b_15 = bool_j_906;
                                flatten_fun_j_915 = fun expr_b_14 -> (
                                    var_j_907 = expr_b_14;
                                    m_match_bool_j_909 = var_j_907 ~ any;
                                    m_match_bool_j_912 = var_j_907 ~ bool;
                                    m_match_cond_j_913 = m_match_bool_j_912 ? (
                                            bool_j_914 = true
                                        ) : (
                                            m_match_cond_j_910 = m_match_bool_j_909 ? (
                                                    var_j_911 = fail_b_15
                                                ) : (
                                                    void_j_908 = {}
                                                )
                                        ));
                                flatten_fun_j_919 = fun bj_null_j_58 -> (
                                    int_j_916 = 0;
                                    input_j_917 = input;
                                    m_bl_i_1135 = int_j_916 ~ int;
                                    m_br_i_1136 = input_j_917 ~ int;
                                    m_b_i_1137 = m_bl_i_1135 and m_br_i_1136;
                                    binop_j_918 = m_b_i_1137 ? (
                                            c_binop_i_1138 = int_j_916 <= input_j_917
                                        ) : (
                                            ab_i_1139 = abort
                                        ));
                                record_j_920 = {checker = flatten_fun_j_915, generator = flatten_fun_j_919};
                                proj_j_921 = record_j_920.generator;
                                int_j_922 = 0;
                                appl_j_923 = proj_j_921 int_j_922;
                                leaf_b_13 = appl_j_923;
                                var_j_924 = leaf_b_13;
                                record_j_925 = {leaf = var_j_924};
                                record_j_926 = {};
                                record_j_927 = {leaf = record_j_926};
                                record_j_928 = {bj_actual_rec = record_j_925, bj_decl_lbls = record_j_927});
                            record_j_930 = {checker = flatten_fun_j_905, generator = flatten_fun_j_929};
                            proj_j_931 = record_j_930.generator;
                            int_j_932 = 0;
                            appl_j_933 = proj_j_931 int_j_932
                        ));
                record_j_936 = {checker = flatten_fun_j_798, generator = flatten_fun_j_935};
                proj_j_937 = record_j_936.generator;
                int_j_938 = 0;
                appl_j_939 = proj_j_937 int_j_938);
            var_j_941 = self_b_0;
            int_j_942 = 0;
            appl_j_943 = var_j_941 int_j_942;
            appl_j_944 = flatten_fun_j_940 appl_j_943);
        record_j_946 = {checker = flatten_fun_j_519, generator = flatten_fun_j_945}));
appl_j_949 = ycomb_b_4 flatten_fun_j_948;
int_j_950 = 0;
appl_j_951 = appl_j_949 int_j_950;
t = appl_j_951;
max_j_959 = fun x -> (
    max_j_958 = fun y -> (
        var_j_952 = y;
        var_j_953 = x;
        m_bl_i_1140 = var_j_952 ~ int;
        m_br_i_1141 = var_j_953 ~ int;
        m_b_i_1142 = m_bl_i_1140 and m_br_i_1141;
        binop_j_954 = m_b_i_1142 ? (
                c_binop_i_1143 = var_j_952 < var_j_953
            ) : (
                ab_i_1144 = abort
            );
        m_i_1145 = binop_j_954 ~ bool;
        if_j_957 = m_i_1145 ? (
                c_cond_i_1146 = binop_j_954 ? (
                        var_j_955 = x
                    ) : (
                        var_j_956 = y
                    )
            ) : (
                ab_i_1147 = abort
            )));
max = max_j_959;
flatten_fun_j_1001 = fun depth_j_0 -> (
    flatten_fun_j_1000 = fun tree -> (
        var_j_960 = depth_j_0;
        var_j_961 = depth_j_0;
        appl_j_962 = var_j_960 var_j_961;
        depth = appl_j_962;
        bool_j_963 = false;
        fail_b_137 = bool_j_963;
        var_j_964 = tree;
        m_match_bool_j_966 = var_j_964 ~ {bj_untouched, _};
        m_match_bool_j_973 = var_j_964 ~ {bj_actual_rec, _};
        m_match_cond_j_974 = m_match_bool_j_973 ? (
                actual_rec_b_151 = var_j_964.bj_actual_rec;
                var_j_975 = tree;
                proj_j_976 = var_j_975.bj_decl_lbls;
                m_match_bool_j_978 = proj_j_976 ~ {left, right};
                m_match_bool_j_995 = proj_j_976 ~ {leaf};
                m_match_cond_j_996 = m_match_bool_j_995 ? (
                        b_j_64 = proj_j_976.leaf;
                        var_j_997 = actual_rec_b_151;
                        proj_j_998 = var_j_997.leaf;
                        b = proj_j_998;
                        int_j_999 = 0
                    ) : (
                        m_match_cond_j_979 = m_match_bool_j_978 ? (
                                l_j_66 = proj_j_976.left;
                                r_j_65 = proj_j_976.right;
                                var_j_980 = actual_rec_b_151;
                                proj_j_981 = var_j_980.right;
                                r = proj_j_981;
                                var_j_982 = actual_rec_b_151;
                                proj_j_983 = var_j_982.left;
                                l = proj_j_983;
                                int_j_984 = 1;
                                var_j_985 = max;
                                var_j_986 = depth;
                                var_j_987 = l;
                                m_i_1148 = var_j_986 ~ fun;
                                appl_j_988 = m_i_1148 ? (
                                        c_appl_i_1149 = var_j_986 var_j_987
                                    ) : (
                                        ab_i_1150 = abort
                                    );
                                m_i_1151 = var_j_985 ~ fun;
                                appl_j_989 = m_i_1151 ? (
                                        c_appl_i_1152 = var_j_985 appl_j_988
                                    ) : (
                                        ab_i_1153 = abort
                                    );
                                var_j_990 = depth;
                                var_j_991 = r;
                                m_i_1154 = var_j_990 ~ fun;
                                appl_j_992 = m_i_1154 ? (
                                        c_appl_i_1155 = var_j_990 var_j_991
                                    ) : (
                                        ab_i_1156 = abort
                                    );
                                m_i_1157 = appl_j_989 ~ fun;
                                appl_j_993 = m_i_1157 ? (
                                        c_appl_i_1158 = appl_j_989 appl_j_992
                                    ) : (
                                        ab_i_1159 = abort
                                    );
                                m_bl_i_1160 = int_j_984 ~ int;
                                m_br_i_1161 = appl_j_993 ~ int;
                                m_b_i_1162 = m_bl_i_1160 and m_br_i_1161;
                                binop_j_994 = m_b_i_1162 ? (
                                        c_binop_i_1163 = int_j_984 + appl_j_993
                                    ) : (
                                        ab_i_1164 = abort
                                    )
                            ) : (
                                ab_j_977 = abort
                            )
                    )
            ) : (
                m_match_cond_j_967 = m_match_bool_j_966 ? (
                        var_j_968 = fail_b_137;
                        assert_pred_j_969 = var_j_968;
                        assert_res_j_970 = assert_pred_j_969 ? (
                                assert_res_true_j_971 = {}
                            ) : (
                                ab_j_972 = abort
                            )
                    ) : (
                        ab_j_965 = abort
                    )
            )));
appl_j_1004 = flatten_fun_j_1001 flatten_fun_j_1001;
proj_j_1006 = t.generator;
int_j_1007 = 0;
appl_j_1008 = proj_j_1006 int_j_1007;
tree_b_150 = appl_j_1008;
flatten_fun_j_1038 = fun expr_b_145 -> (
    bool_j_1009 = false;
    fail_b_143 = bool_j_1009;
    flatten_fun_j_1018 = fun expr_b_142 -> (
        var_j_1010 = expr_b_142;
        m_match_bool_j_1012 = var_j_1010 ~ any;
        m_match_bool_j_1015 = var_j_1010 ~ int;
        m_match_cond_j_1016 = m_match_bool_j_1015 ? (
                bool_j_1017 = true
            ) : (
                m_match_cond_j_1013 = m_match_bool_j_1012 ? (
                        var_j_1014 = fail_b_143
                    ) : (
                        void_j_1011 = {}
                    )
            ));
    flatten_fun_j_1020 = fun bj_null_j_67 -> (
        input_j_1019 = input);
    record_j_1021 = {checker = flatten_fun_j_1018, generator = flatten_fun_j_1020};
    proj_j_1022 = record_j_1021.checker;
    var_j_1023 = expr_b_145;
    appl_j_1024 = proj_j_1022 var_j_1023;
    t_check_b_146 = appl_j_1024;
    var_j_1025 = t_check_b_146;
    if_j_1037 = var_j_1025 ? (
            bool_j_1026 = false;
            pred_check_b_147 = bool_j_1026;
            flatten_fun_j_1030 = fun i -> (
                int_j_1027 = 0;
                var_j_1028 = i;
                m_bl_i_1165 = int_j_1027 ~ int;
                m_br_i_1166 = var_j_1028 ~ int;
                m_b_i_1167 = m_bl_i_1165 and m_br_i_1166;
                binop_j_1029 = m_b_i_1167 ? (
                        c_binop_i_1168 = int_j_1027 < var_j_1028
                    ) : (
                        ab_i_1169 = abort
                    ));
            var_j_1031 = expr_b_145;
            appl_j_1032 = flatten_fun_j_1030 var_j_1031;
            if_j_1035 = appl_j_1032 ? (
                    bool_j_1033 = true
                ) : (
                    var_j_1034 = pred_check_b_147
                )
        ) : (
            var_j_1036 = t_check_b_146
        ));
flatten_fun_j_1065 = fun bj_null_j_70 -> (
    bool_j_1039 = false;
    fail_b_139 = bool_j_1039;
    flatten_fun_j_1048 = fun expr_b_138 -> (
        var_j_1040 = expr_b_138;
        m_match_bool_j_1042 = var_j_1040 ~ any;
        m_match_bool_j_1045 = var_j_1040 ~ int;
        m_match_cond_j_1046 = m_match_bool_j_1045 ? (
                bool_j_1047 = true
            ) : (
                m_match_cond_j_1043 = m_match_bool_j_1042 ? (
                        var_j_1044 = fail_b_139
                    ) : (
                        void_j_1041 = {}
                    )
            ));
    flatten_fun_j_1050 = fun bj_null_j_68 -> (
        input_j_1049 = input);
    record_j_1051 = {checker = flatten_fun_j_1048, generator = flatten_fun_j_1050};
    proj_j_1052 = record_j_1051.generator;
    int_j_1053 = 0;
    appl_j_1054 = proj_j_1052 int_j_1053;
    candidate_b_141 = appl_j_1054;
    flatten_fun_j_1058 = fun i_j_69 -> (
        int_j_1055 = 0;
        var_j_1056 = i_j_69;
        m_bl_i_1170 = int_j_1055 ~ int;
        m_br_i_1171 = var_j_1056 ~ int;
        m_b_i_1172 = m_bl_i_1170 and m_br_i_1171;
        binop_j_1057 = m_b_i_1172 ? (
                c_binop_i_1173 = int_j_1055 < var_j_1056
            ) : (
                ab_i_1174 = abort
            ));
    var_j_1059 = candidate_b_141;
    appl_j_1060 = flatten_fun_j_1058 var_j_1059;
    if_j_1064 = appl_j_1060 ? (
            var_j_1061 = candidate_b_141
        ) : (
            bool_j_1062 = false;
            assume_j_1063 = assume bool_j_1062
        ));
record_j_1066 = {checker = flatten_fun_j_1038, generator = flatten_fun_j_1065};
proj_j_1067 = record_j_1066.checker;
appl_j_1070 = appl_j_1004 tree_b_150;
appl_j_1071 = proj_j_1067 appl_j_1070;
check_res_b_149 = appl_j_1071;
if_j_1079 = check_res_b_149 ? (
        var_j_1073 = appl_j_1004
    ) : (
        error_var_j_1074 = check_res_b_149;
        assert_pred_j_1075 = error_var_j_1074;
        assert_res_j_1076 = assert_pred_j_1075 ? (
                assert_res_true_j_1077 = {}
            ) : (
                ab_j_1078 = abort
            )
    );
i_result = if_j_1079