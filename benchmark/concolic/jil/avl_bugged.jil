i_first = {};
is_pos_j_216 = fun x_j_212 -> (
    int_j_213 = 0;
    var_j_214 = x_j_212;
    m_bl_i_2892 = int_j_213 ~ int;
    m_br_i_2893 = var_j_214 ~ int;
    m_b_i_2894 = m_bl_i_2892 and m_br_i_2893;
    binop_j_215 = m_b_i_2894 ? (
            c_binop_i_2895 = int_j_213 < var_j_214
        ) : (
            ab_i_2896 = abort
        ));
is_pos = is_pos_j_216;
flatten_fun_j_236 = fun f_b_6 -> (
    flatten_fun_j_225 = fun x_b_5 -> (
        flatten_fun_j_224 = fun freeze_b_7 -> (
            var_j_217 = f_b_6;
            var_j_218 = x_b_5;
            var_j_219 = x_b_5;
            appl_j_220 = var_j_218 var_j_219;
            appl_j_221 = var_j_217 appl_j_220;
            var_j_222 = freeze_b_7;
            appl_j_223 = appl_j_221 var_j_222));
    flatten_fun_j_234 = fun x_b_5_j_3 -> (
        flatten_fun_j_233 = fun freeze_b_7_j_2 -> (
            var_j_226 = f_b_6;
            var_j_227 = x_b_5_j_3;
            var_j_228 = x_b_5_j_3;
            appl_j_229 = var_j_227 var_j_228;
            appl_j_230 = var_j_226 appl_j_229;
            var_j_231 = freeze_b_7_j_2;
            appl_j_232 = appl_j_230 var_j_231));
    appl_j_235 = flatten_fun_j_225 flatten_fun_j_234);
ycomb_b_8 = flatten_fun_j_236;
flatten_fun_j_2154 = fun self_b_4 -> (
    flatten_fun_j_2153 = fun bj_null_j_134 -> (
        flatten_fun_j_1193 = fun expr_b_331 -> (
            flatten_fun_j_1188 = fun tt -> (
                flatten_fun_j_868 = fun expr_b_327 -> (
                    input_j_238 = input;
                    select_int_b_328 = input_j_238;
                    bool_j_239 = false;
                    fail_b_329 = bool_j_239;
                    int_j_240 = 0;
                    var_j_241 = select_int_b_328;
                    binop_j_242 = int_j_240 <= var_j_241;
                    if_j_867 = binop_j_242 ? (
                            flatten_fun_j_365 = fun expr_b_244 -> (
                                bool_j_243 = false;
                                rec_fail_b_243 = bool_j_243;
                                bool_j_244 = false;
                                rec_fail_b_242 = bool_j_244;
                                bool_j_245 = false;
                                rec_fail_b_241 = bool_j_245;
                                var_j_246 = expr_b_244;
                                m_match_bool_j_248 = var_j_246 ~ any;
                                m_match_bool_j_251 = var_j_246 ~ {bj_actual_rec, _};
                                m_match_cond_j_252 = m_match_bool_j_251 ? (
                                        var_j_253 = expr_b_244;
                                        proj_j_254 = var_j_253.bj_decl_lbls;
                                        m_match_bool_j_256 = proj_j_254 ~ any;
                                        m_match_bool_j_259 = proj_j_254 ~ 
                                            {height, item, left, right, _};
                                        m_match_cond_j_260 = m_match_bool_j_259 ? (
                                                height_j_10 = proj_j_254.height;
                                                item_j_9 = proj_j_254.item;
                                                left_j_8 = proj_j_254.left;
                                                right_j_7 = proj_j_254.right;
                                                var_j_261 = expr_b_244;
                                                proj_j_262 = var_j_261.bj_actual_rec;
                                                m_match_bool_j_264 = proj_j_262 ~ any;
                                                m_match_bool_j_267 = proj_j_262 ~ 
                                                    {height, item, left, right, _};
                                                m_match_cond_j_268 = m_match_bool_j_267 ? (
                                                        height = proj_j_262.height;
                                                        item = proj_j_262.item;
                                                        left = proj_j_262.left;
                                                        right = proj_j_262.right;
                                                        flatten_fun_j_297 = fun expr_b_258 -> (
                                                            bool_j_269 = false;
                                                            fail_b_256 = bool_j_269;
                                                            flatten_fun_j_278 = fun expr_b_255 -> (
                                                                var_j_270 = expr_b_255;
                                                                m_match_bool_j_272 = var_j_270 ~ any;
                                                                m_match_bool_j_275 = var_j_270 ~ int;
                                                                m_match_cond_j_276 = m_match_bool_j_275 ? (
                                                                        
                                                                    bool_j_277 = true
                                                                    ) : (
                                                                        
                                                                    m_match_cond_j_273 = m_match_bool_j_272 ? (
                                                                        var_j_274 = fail_b_256
                                                                    ) : (
                                                                        void_j_271 = 
                                                                    {}
                                                                    )
                                                                    ));
                                                            flatten_fun_j_280 = fun bj_null -> (
                                                                input_j_279 = input);
                                                            flatten_fun_j_282 = fun expr_b_257 -> (
                                                                var_j_281 = expr_b_257);
                                                            record_j_283 = 
                                                                {checker = flatten_fun_j_278, generator = flatten_fun_j_280, wrapper = flatten_fun_j_282};
                                                            proj_j_284 = record_j_283.checker;
                                                            var_j_285 = expr_b_258;
                                                            appl_j_286 = proj_j_284 var_j_285;
                                                            t_check_b_259 = appl_j_286;
                                                            var_j_287 = t_check_b_259;
                                                            if_j_296 = var_j_287 ? (
                                                                    bool_j_288 = false;
                                                                    pred_check_b_260 = bool_j_288;
                                                                    var_j_289 = is_pos;
                                                                    var_j_290 = expr_b_258;
                                                                    appl_j_291 = var_j_289 var_j_290;
                                                                    if_j_294 = appl_j_291 ? (
                                                                        bool_j_292 = true
                                                                    ) : (
                                                                        var_j_293 = pred_check_b_260
                                                                    )
                                                                ) : (
                                                                    var_j_295 = t_check_b_259
                                                                ));
                                                        flatten_fun_j_323 = fun bj_null_j_5 -> (
                                                            bool_j_298 = false;
                                                            fail_b_252 = bool_j_298;
                                                            flatten_fun_j_307 = fun expr_b_251 -> (
                                                                var_j_299 = expr_b_251;
                                                                m_match_bool_j_301 = var_j_299 ~ any;
                                                                m_match_bool_j_304 = var_j_299 ~ int;
                                                                m_match_cond_j_305 = m_match_bool_j_304 ? (
                                                                        
                                                                    bool_j_306 = true
                                                                    ) : (
                                                                        
                                                                    m_match_cond_j_302 = m_match_bool_j_301 ? (
                                                                        var_j_303 = fail_b_252
                                                                    ) : (
                                                                        void_j_300 = 
                                                                    {}
                                                                    )
                                                                    ));
                                                            flatten_fun_j_309 = fun bj_null_j_4 -> (
                                                                input_j_308 = input);
                                                            flatten_fun_j_311 = fun expr_b_253 -> (
                                                                var_j_310 = expr_b_253);
                                                            record_j_312 = 
                                                                {checker = flatten_fun_j_307, generator = flatten_fun_j_309, wrapper = flatten_fun_j_311};
                                                            proj_j_313 = record_j_312.generator;
                                                            int_j_314 = 0;
                                                            appl_j_315 = proj_j_313 int_j_314;
                                                            candidate_b_254 = appl_j_315;
                                                            var_j_316 = is_pos;
                                                            var_j_317 = candidate_b_254;
                                                            appl_j_318 = var_j_316 var_j_317;
                                                            if_j_322 = appl_j_318 ? (
                                                                    var_j_319 = candidate_b_254
                                                                ) : (
                                                                    bool_j_320 = false;
                                                                    assume_j_321 = assume bool_j_320
                                                                ));
                                                        flatten_fun_j_325 = fun expr_b_261 -> (
                                                            var_j_324 = expr_b_261);
                                                        record_j_326 = 
                                                            {checker = flatten_fun_j_297, generator = flatten_fun_j_323, wrapper = flatten_fun_j_325};
                                                        proj_j_327 = record_j_326.checker;
                                                        var_j_328 = height;
                                                        appl_j_329 = proj_j_327 var_j_328;
                                                        lbl_check_b_250 = appl_j_329;
                                                        var_j_330 = lbl_check_b_250;
                                                        if_j_364 = var_j_330 ? (
                                                                bool_j_331 = false;
                                                                fail_b_248 = bool_j_331;
                                                                flatten_fun_j_340 = fun expr_b_247 -> (
                                                                    var_j_332 = expr_b_247;
                                                                    m_match_bool_j_334 = var_j_332 ~ any;
                                                                    m_match_bool_j_337 = var_j_332 ~ int;
                                                                    m_match_cond_j_338 = m_match_bool_j_337 ? (
                                                                        bool_j_339 = true
                                                                    ) : (
                                                                        m_match_cond_j_335 = m_match_bool_j_334 ? (
                                                                        var_j_336 = fail_b_248
                                                                    ) : (
                                                                        void_j_333 = 
                                                                    {}
                                                                    )
                                                                    ));
                                                                flatten_fun_j_342 = fun bj_null_j_6 -> (
                                                                    input_j_341 = input);
                                                                flatten_fun_j_344 = fun expr_b_249 -> (
                                                                    var_j_343 = expr_b_249);
                                                                record_j_345 = 
                                                                    {checker = flatten_fun_j_340, generator = flatten_fun_j_342, wrapper = flatten_fun_j_344};
                                                                proj_j_346 = record_j_345.checker;
                                                                var_j_347 = item;
                                                                appl_j_348 = proj_j_346 var_j_347;
                                                                lbl_check_b_246 = appl_j_348;
                                                                var_j_349 = lbl_check_b_246;
                                                                if_j_362 = var_j_349 ? (
                                                                        
                                                                    var_j_350 = tt;
                                                                    proj_j_351 = var_j_350.checker;
                                                                    var_j_352 = left;
                                                                    appl_j_353 = proj_j_351 var_j_352;
                                                                    lbl_check_b_245 = appl_j_353;
                                                                    var_j_354 = lbl_check_b_245;
                                                                    if_j_360 = var_j_354 ? (
                                                                        var_j_355 = tt;
                                                                    proj_j_356 = var_j_355.checker;
                                                                    var_j_357 = right;
                                                                    appl_j_358 = proj_j_356 var_j_357
                                                                    ) : (
                                                                        var_j_359 = lbl_check_b_245
                                                                    )
                                                                    ) : (
                                                                        
                                                                    var_j_361 = lbl_check_b_246
                                                                    )
                                                            ) : (
                                                                var_j_363 = lbl_check_b_250
                                                            )
                                                    ) : (
                                                        m_match_cond_j_265 = m_match_bool_j_264 ? (
                                                                var_j_266 = rec_fail_b_241
                                                            ) : (
                                                                void_j_263 = 
                                                                    {}
                                                            )
                                                    )
                                            ) : (
                                                m_match_cond_j_257 = m_match_bool_j_256 ? (
                                                        var_j_258 = rec_fail_b_242
                                                    ) : (
                                                        void_j_255 = 
                                                            {}
                                                    )
                                            )
                                    ) : (
                                        m_match_cond_j_249 = m_match_bool_j_248 ? (
                                                var_j_250 = rec_fail_b_243
                                            ) : (
                                                void_j_247 = {}
                                            )
                                    ));
                            flatten_fun_j_464 = fun bj_null_j_15 -> (
                                var_j_366 = tt;
                                proj_j_367 = var_j_366.generator;
                                int_j_368 = 0;
                                appl_j_369 = proj_j_367 int_j_368;
                                right_b_226 = appl_j_369;
                                var_j_370 = tt;
                                proj_j_371 = var_j_370.generator;
                                int_j_372 = 0;
                                appl_j_373 = proj_j_371 int_j_372;
                                left_b_225 = appl_j_373;
                                bool_j_374 = false;
                                fail_b_239 = bool_j_374;
                                flatten_fun_j_383 = fun expr_b_238 -> (
                                    var_j_375 = expr_b_238;
                                    m_match_bool_j_377 = var_j_375 ~ any;
                                    m_match_bool_j_380 = var_j_375 ~ int;
                                    m_match_cond_j_381 = m_match_bool_j_380 ? (
                                            bool_j_382 = true
                                        ) : (
                                            m_match_cond_j_378 = m_match_bool_j_377 ? (
                                                    var_j_379 = fail_b_239
                                                ) : (
                                                    void_j_376 = {}
                                                )
                                        ));
                                flatten_fun_j_385 = fun bj_null_j_11 -> (
                                    input_j_384 = input);
                                flatten_fun_j_387 = fun expr_b_240 -> (
                                    var_j_386 = expr_b_240);
                                record_j_388 = {checker = flatten_fun_j_383, generator = flatten_fun_j_385, wrapper = flatten_fun_j_387};
                                proj_j_389 = record_j_388.generator;
                                int_j_390 = 0;
                                appl_j_391 = proj_j_389 int_j_390;
                                item_b_224 = appl_j_391;
                                flatten_fun_j_420 = fun expr_b_234 -> (
                                    bool_j_392 = false;
                                    fail_b_232 = bool_j_392;
                                    flatten_fun_j_401 = fun expr_b_231 -> (
                                        var_j_393 = expr_b_231;
                                        m_match_bool_j_395 = var_j_393 ~ any;
                                        m_match_bool_j_398 = var_j_393 ~ int;
                                        m_match_cond_j_399 = m_match_bool_j_398 ? (
                                                bool_j_400 = true
                                            ) : (
                                                m_match_cond_j_396 = m_match_bool_j_395 ? (
                                                        var_j_397 = fail_b_232
                                                    ) : (
                                                        void_j_394 = 
                                                            {}
                                                    )
                                            ));
                                    flatten_fun_j_403 = fun bj_null_j_12 -> (
                                        input_j_402 = input);
                                    flatten_fun_j_405 = fun expr_b_233 -> (
                                        var_j_404 = expr_b_233);
                                    record_j_406 = {checker = flatten_fun_j_401, generator = flatten_fun_j_403, wrapper = flatten_fun_j_405};
                                    proj_j_407 = record_j_406.checker;
                                    var_j_408 = expr_b_234;
                                    appl_j_409 = proj_j_407 var_j_408;
                                    t_check_b_235 = appl_j_409;
                                    var_j_410 = t_check_b_235;
                                    if_j_419 = var_j_410 ? (
                                            bool_j_411 = false;
                                            pred_check_b_236 = bool_j_411;
                                            var_j_412 = is_pos;
                                            var_j_413 = expr_b_234;
                                            appl_j_414 = var_j_412 var_j_413;
                                            if_j_417 = appl_j_414 ? (
                                                    bool_j_415 = true
                                                ) : (
                                                    var_j_416 = pred_check_b_236
                                                )
                                        ) : (
                                            var_j_418 = t_check_b_235
                                        ));
                                flatten_fun_j_446 = fun bj_null_j_14 -> (
                                    bool_j_421 = false;
                                    fail_b_228 = bool_j_421;
                                    flatten_fun_j_430 = fun expr_b_227 -> (
                                        var_j_422 = expr_b_227;
                                        m_match_bool_j_424 = var_j_422 ~ any;
                                        m_match_bool_j_427 = var_j_422 ~ int;
                                        m_match_cond_j_428 = m_match_bool_j_427 ? (
                                                bool_j_429 = true
                                            ) : (
                                                m_match_cond_j_425 = m_match_bool_j_424 ? (
                                                        var_j_426 = fail_b_228
                                                    ) : (
                                                        void_j_423 = 
                                                            {}
                                                    )
                                            ));
                                    flatten_fun_j_432 = fun bj_null_j_13 -> (
                                        input_j_431 = input);
                                    flatten_fun_j_434 = fun expr_b_229 -> (
                                        var_j_433 = expr_b_229);
                                    record_j_435 = {checker = flatten_fun_j_430, generator = flatten_fun_j_432, wrapper = flatten_fun_j_434};
                                    proj_j_436 = record_j_435.generator;
                                    int_j_437 = 0;
                                    appl_j_438 = proj_j_436 int_j_437;
                                    candidate_b_230 = appl_j_438;
                                    var_j_439 = is_pos;
                                    var_j_440 = candidate_b_230;
                                    appl_j_441 = var_j_439 var_j_440;
                                    if_j_445 = appl_j_441 ? (
                                            var_j_442 = candidate_b_230
                                        ) : (
                                            bool_j_443 = false;
                                            assume_j_444 = assume bool_j_443
                                        ));
                                flatten_fun_j_448 = fun expr_b_237 -> (
                                    var_j_447 = expr_b_237);
                                record_j_449 = {checker = flatten_fun_j_420, generator = flatten_fun_j_446, wrapper = flatten_fun_j_448};
                                proj_j_450 = record_j_449.generator;
                                int_j_451 = 0;
                                appl_j_452 = proj_j_450 int_j_451;
                                height_b_223 = appl_j_452;
                                var_j_453 = height_b_223;
                                var_j_454 = item_b_224;
                                var_j_455 = left_b_225;
                                var_j_456 = right_b_226;
                                record_j_457 = {height = var_j_453, item = var_j_454, left = var_j_455, right = var_j_456};
                                record_j_458 = {};
                                record_j_459 = {};
                                record_j_460 = {};
                                record_j_461 = {};
                                record_j_462 = {height = record_j_458, item = record_j_459, left = record_j_460, right = record_j_461};
                                record_j_463 = {bj_actual_rec = record_j_457, bj_decl_lbls = record_j_462});
                            flatten_fun_j_466 = fun expr_b_262 -> (
                                var_j_465 = expr_b_262);
                            record_j_467 = {checker = flatten_fun_j_365, generator = flatten_fun_j_464, wrapper = flatten_fun_j_466};
                            proj_j_468 = record_j_467.checker;
                            var_j_469 = expr_b_327;
                            appl_j_470 = proj_j_468 var_j_469;
                            if_j_554 = appl_j_470 ? (
                                    bool_j_471 = true
                                ) : (
                                    flatten_fun_j_518 = fun expr_b_270 -> (
                                        bool_j_472 = false;
                                        rec_fail_b_269 = bool_j_472;
                                        bool_j_473 = false;
                                        rec_fail_b_268 = bool_j_473;
                                        bool_j_474 = false;
                                        rec_fail_b_267 = bool_j_474;
                                        var_j_475 = expr_b_270;
                                        m_match_bool_j_477 = var_j_475 ~ any;
                                        m_match_bool_j_480 = var_j_475 ~ 
                                            {bj_actual_rec, _};
                                        m_match_cond_j_481 = m_match_bool_j_480 ? (
                                                var_j_482 = expr_b_270;
                                                proj_j_483 = var_j_482.bj_decl_lbls;
                                                m_match_bool_j_485 = proj_j_483 ~ any;
                                                m_match_bool_j_488 = proj_j_483 ~ 
                                                    {leaf, _};
                                                m_match_cond_j_489 = m_match_bool_j_488 ? (
                                                        leaf_j_17 = proj_j_483.leaf;
                                                        var_j_490 = expr_b_270;
                                                        proj_j_491 = var_j_490.bj_actual_rec;
                                                        m_match_bool_j_493 = proj_j_491 ~ any;
                                                        m_match_bool_j_496 = proj_j_491 ~ 
                                                            {leaf, _};
                                                        m_match_cond_j_497 = m_match_bool_j_496 ? (
                                                                leaf = proj_j_491.leaf;
                                                                bool_j_498 = false;
                                                                fail_b_272 = bool_j_498;
                                                                flatten_fun_j_507 = fun expr_b_271 -> (
                                                                    var_j_499 = expr_b_271;
                                                                    m_match_bool_j_501 = var_j_499 ~ any;
                                                                    m_match_bool_j_504 = var_j_499 ~ bool;
                                                                    m_match_cond_j_505 = m_match_bool_j_504 ? (
                                                                        bool_j_506 = true
                                                                    ) : (
                                                                        m_match_cond_j_502 = m_match_bool_j_501 ? (
                                                                        var_j_503 = fail_b_272
                                                                    ) : (
                                                                        void_j_500 = 
                                                                    {}
                                                                    )
                                                                    ));
                                                                flatten_fun_j_511 = fun bj_null_j_16 -> (
                                                                    int_j_508 = 0;
                                                                    input_j_509 = input;
                                                                    m_bl_i_2897 = int_j_508 ~ int;
                                                                    m_br_i_2898 = input_j_509 ~ int;
                                                                    m_b_i_2899 = m_bl_i_2897 and m_br_i_2898;
                                                                    binop_j_510 = m_b_i_2899 ? (
                                                                        c_binop_i_2900 = int_j_508 <= input_j_509
                                                                    ) : (
                                                                        ab_i_2901 = abort
                                                                    ));
                                                                flatten_fun_j_513 = fun expr_b_273 -> (
                                                                    var_j_512 = expr_b_273);
                                                                record_j_514 = 
                                                                    {checker = flatten_fun_j_507, generator = flatten_fun_j_511, wrapper = flatten_fun_j_513};
                                                                proj_j_515 = record_j_514.checker;
                                                                var_j_516 = leaf;
                                                                appl_j_517 = proj_j_515 var_j_516
                                                            ) : (
                                                                m_match_cond_j_494 = m_match_bool_j_493 ? (
                                                                        
                                                                    var_j_495 = rec_fail_b_267
                                                                    ) : (
                                                                        
                                                                    void_j_492 = 
                                                                    {}
                                                                    )
                                                            )
                                                    ) : (
                                                        m_match_cond_j_486 = m_match_bool_j_485 ? (
                                                                var_j_487 = rec_fail_b_268
                                                            ) : (
                                                                void_j_484 = 
                                                                    {}
                                                            )
                                                    )
                                            ) : (
                                                m_match_cond_j_478 = m_match_bool_j_477 ? (
                                                        var_j_479 = rec_fail_b_269
                                                    ) : (
                                                        void_j_476 = 
                                                            {}
                                                    )
                                            ));
                                    flatten_fun_j_544 = fun bj_null_j_19 -> (
                                        bool_j_519 = false;
                                        fail_b_265 = bool_j_519;
                                        flatten_fun_j_528 = fun expr_b_264 -> (
                                            var_j_520 = expr_b_264;
                                            m_match_bool_j_522 = var_j_520 ~ any;
                                            m_match_bool_j_525 = var_j_520 ~ bool;
                                            m_match_cond_j_526 = m_match_bool_j_525 ? (
                                                    bool_j_527 = true
                                                ) : (
                                                    m_match_cond_j_523 = m_match_bool_j_522 ? (
                                                            var_j_524 = fail_b_265
                                                        ) : (
                                                            void_j_521 = 
                                                                {}
                                                        )
                                                ));
                                        flatten_fun_j_532 = fun bj_null_j_18 -> (
                                            int_j_529 = 0;
                                            input_j_530 = input;
                                            m_bl_i_2902 = int_j_529 ~ int;
                                            m_br_i_2903 = input_j_530 ~ int;
                                            m_b_i_2904 = m_bl_i_2902 and m_br_i_2903;
                                            binop_j_531 = m_b_i_2904 ? (
                                                    c_binop_i_2905 = int_j_529 <= input_j_530
                                                ) : (
                                                    ab_i_2906 = abort
                                                ));
                                        flatten_fun_j_534 = fun expr_b_266 -> (
                                            var_j_533 = expr_b_266);
                                        record_j_535 = {checker = flatten_fun_j_528, generator = flatten_fun_j_532, wrapper = flatten_fun_j_534};
                                        proj_j_536 = record_j_535.generator;
                                        int_j_537 = 0;
                                        appl_j_538 = proj_j_536 int_j_537;
                                        leaf_b_263 = appl_j_538;
                                        var_j_539 = leaf_b_263;
                                        record_j_540 = {leaf = var_j_539};
                                        record_j_541 = {};
                                        record_j_542 = {leaf = record_j_541};
                                        record_j_543 = {bj_actual_rec = record_j_540, bj_decl_lbls = record_j_542});
                                    flatten_fun_j_546 = fun expr_b_274 -> (
                                        var_j_545 = expr_b_274);
                                    record_j_547 = {checker = flatten_fun_j_518, generator = flatten_fun_j_544, wrapper = flatten_fun_j_546};
                                    proj_j_548 = record_j_547.checker;
                                    var_j_549 = expr_b_327;
                                    appl_j_550 = proj_j_548 var_j_549;
                                    if_j_553 = appl_j_550 ? (
                                            bool_j_551 = true
                                        ) : (
                                            var_j_552 = fail_b_329
                                        )
                                )
                        ) : (
                            flatten_fun_j_601 = fun expr_b_322 -> (
                                bool_j_555 = false;
                                rec_fail_b_321 = bool_j_555;
                                bool_j_556 = false;
                                rec_fail_b_320 = bool_j_556;
                                bool_j_557 = false;
                                rec_fail_b_319 = bool_j_557;
                                var_j_558 = expr_b_322;
                                m_match_bool_j_560 = var_j_558 ~ any;
                                m_match_bool_j_563 = var_j_558 ~ {bj_actual_rec, _};
                                m_match_cond_j_564 = m_match_bool_j_563 ? (
                                        var_j_565 = expr_b_322;
                                        proj_j_566 = var_j_565.bj_decl_lbls;
                                        m_match_bool_j_568 = proj_j_566 ~ any;
                                        m_match_bool_j_571 = proj_j_566 ~ 
                                            {leaf, _};
                                        m_match_cond_j_572 = m_match_bool_j_571 ? (
                                                leaf_j_22 = proj_j_566.leaf;
                                                var_j_573 = expr_b_322;
                                                proj_j_574 = var_j_573.bj_actual_rec;
                                                m_match_bool_j_576 = proj_j_574 ~ any;
                                                m_match_bool_j_579 = proj_j_574 ~ 
                                                    {leaf, _};
                                                m_match_cond_j_580 = m_match_bool_j_579 ? (
                                                        leaf_j_21 = proj_j_574.leaf;
                                                        bool_j_581 = false;
                                                        fail_b_324 = bool_j_581;
                                                        flatten_fun_j_590 = fun expr_b_323 -> (
                                                            var_j_582 = expr_b_323;
                                                            m_match_bool_j_584 = var_j_582 ~ any;
                                                            m_match_bool_j_587 = var_j_582 ~ bool;
                                                            m_match_cond_j_588 = m_match_bool_j_587 ? (
                                                                    bool_j_589 = true
                                                                ) : (
                                                                    m_match_cond_j_585 = m_match_bool_j_584 ? (
                                                                        var_j_586 = fail_b_324
                                                                    ) : (
                                                                        void_j_583 = 
                                                                    {}
                                                                    )
                                                                ));
                                                        flatten_fun_j_594 = fun bj_null_j_20 -> (
                                                            int_j_591 = 0;
                                                            input_j_592 = input;
                                                            m_bl_i_2907 = int_j_591 ~ int;
                                                            m_br_i_2908 = input_j_592 ~ int;
                                                            m_b_i_2909 = m_bl_i_2907 and m_br_i_2908;
                                                            binop_j_593 = m_b_i_2909 ? (
                                                                    c_binop_i_2910 = int_j_591 <= input_j_592
                                                                ) : (
                                                                    ab_i_2911 = abort
                                                                ));
                                                        flatten_fun_j_596 = fun expr_b_325 -> (
                                                            var_j_595 = expr_b_325);
                                                        record_j_597 = 
                                                            {checker = flatten_fun_j_590, generator = flatten_fun_j_594, wrapper = flatten_fun_j_596};
                                                        proj_j_598 = record_j_597.checker;
                                                        var_j_599 = leaf_j_21;
                                                        appl_j_600 = proj_j_598 var_j_599
                                                    ) : (
                                                        m_match_cond_j_577 = m_match_bool_j_576 ? (
                                                                var_j_578 = rec_fail_b_319
                                                            ) : (
                                                                void_j_575 = 
                                                                    {}
                                                            )
                                                    )
                                            ) : (
                                                m_match_cond_j_569 = m_match_bool_j_568 ? (
                                                        var_j_570 = rec_fail_b_320
                                                    ) : (
                                                        void_j_567 = 
                                                            {}
                                                    )
                                            )
                                    ) : (
                                        m_match_cond_j_561 = m_match_bool_j_560 ? (
                                                var_j_562 = rec_fail_b_321
                                            ) : (
                                                void_j_559 = {}
                                            )
                                    ));
                            flatten_fun_j_627 = fun bj_null_j_24 -> (
                                bool_j_602 = false;
                                fail_b_317 = bool_j_602;
                                flatten_fun_j_611 = fun expr_b_316 -> (
                                    var_j_603 = expr_b_316;
                                    m_match_bool_j_605 = var_j_603 ~ any;
                                    m_match_bool_j_608 = var_j_603 ~ bool;
                                    m_match_cond_j_609 = m_match_bool_j_608 ? (
                                            bool_j_610 = true
                                        ) : (
                                            m_match_cond_j_606 = m_match_bool_j_605 ? (
                                                    var_j_607 = fail_b_317
                                                ) : (
                                                    void_j_604 = {}
                                                )
                                        ));
                                flatten_fun_j_615 = fun bj_null_j_23 -> (
                                    int_j_612 = 0;
                                    input_j_613 = input;
                                    m_bl_i_2912 = int_j_612 ~ int;
                                    m_br_i_2913 = input_j_613 ~ int;
                                    m_b_i_2914 = m_bl_i_2912 and m_br_i_2913;
                                    binop_j_614 = m_b_i_2914 ? (
                                            c_binop_i_2915 = int_j_612 <= input_j_613
                                        ) : (
                                            ab_i_2916 = abort
                                        ));
                                flatten_fun_j_617 = fun expr_b_318 -> (
                                    var_j_616 = expr_b_318);
                                record_j_618 = {checker = flatten_fun_j_611, generator = flatten_fun_j_615, wrapper = flatten_fun_j_617};
                                proj_j_619 = record_j_618.generator;
                                int_j_620 = 0;
                                appl_j_621 = proj_j_619 int_j_620;
                                leaf_b_315 = appl_j_621;
                                var_j_622 = leaf_b_315;
                                record_j_623 = {leaf = var_j_622};
                                record_j_624 = {};
                                record_j_625 = {leaf = record_j_624};
                                record_j_626 = {bj_actual_rec = record_j_623, bj_decl_lbls = record_j_625});
                            flatten_fun_j_629 = fun expr_b_326 -> (
                                var_j_628 = expr_b_326);
                            record_j_630 = {checker = flatten_fun_j_601, generator = flatten_fun_j_627, wrapper = flatten_fun_j_629};
                            proj_j_631 = record_j_630.checker;
                            var_j_632 = expr_b_327;
                            appl_j_633 = proj_j_631 var_j_632;
                            if_j_866 = appl_j_633 ? (
                                    bool_j_634 = true
                                ) : (
                                    flatten_fun_j_757 = fun expr_b_296 -> (
                                        bool_j_635 = false;
                                        rec_fail_b_295 = bool_j_635;
                                        bool_j_636 = false;
                                        rec_fail_b_294 = bool_j_636;
                                        bool_j_637 = false;
                                        rec_fail_b_293 = bool_j_637;
                                        var_j_638 = expr_b_296;
                                        m_match_bool_j_640 = var_j_638 ~ any;
                                        m_match_bool_j_643 = var_j_638 ~ 
                                            {bj_actual_rec, _};
                                        m_match_cond_j_644 = m_match_bool_j_643 ? (
                                                var_j_645 = expr_b_296;
                                                proj_j_646 = var_j_645.bj_decl_lbls;
                                                m_match_bool_j_648 = proj_j_646 ~ any;
                                                m_match_bool_j_651 = proj_j_646 ~ 
                                                    {height, item, left, right, _};
                                                m_match_cond_j_652 = m_match_bool_j_651 ? (
                                                        height_j_36 = proj_j_646.height;
                                                        item_j_35 = proj_j_646.item;
                                                        left_j_34 = proj_j_646.left;
                                                        right_j_33 = proj_j_646.right;
                                                        var_j_653 = expr_b_296;
                                                        proj_j_654 = var_j_653.bj_actual_rec;
                                                        m_match_bool_j_656 = proj_j_654 ~ any;
                                                        m_match_bool_j_659 = proj_j_654 ~ 
                                                            {height, item, left, right, _};
                                                        m_match_cond_j_660 = m_match_bool_j_659 ? (
                                                                height_j_32 = proj_j_654.height;
                                                                item_j_31 = proj_j_654.item;
                                                                left_j_30 = proj_j_654.left;
                                                                right_j_29 = proj_j_654.right;
                                                                flatten_fun_j_689 = fun expr_b_310 -> (
                                                                    bool_j_661 = false;
                                                                    fail_b_308 = bool_j_661;
                                                                    flatten_fun_j_670 = fun expr_b_307 -> (
                                                                    var_j_662 = expr_b_307;
                                                                    m_match_bool_j_664 = var_j_662 ~ any;
                                                                    m_match_bool_j_667 = var_j_662 ~ int;
                                                                    m_match_cond_j_668 = m_match_bool_j_667 ? (
                                                                        bool_j_669 = true
                                                                    ) : (
                                                                        m_match_cond_j_665 = m_match_bool_j_664 ? (
                                                                        var_j_666 = fail_b_308
                                                                    ) : (
                                                                        void_j_663 = 
                                                                    {}
                                                                    )
                                                                    ));
                                                                    flatten_fun_j_672 = fun bj_null_j_25 -> (
                                                                    input_j_671 = input);
                                                                    flatten_fun_j_674 = fun expr_b_309 -> (
                                                                    var_j_673 = expr_b_309);
                                                                    record_j_675 = 
                                                                    {checker = flatten_fun_j_670, generator = flatten_fun_j_672, wrapper = flatten_fun_j_674};
                                                                    proj_j_676 = record_j_675.checker;
                                                                    var_j_677 = expr_b_310;
                                                                    appl_j_678 = proj_j_676 var_j_677;
                                                                    t_check_b_311 = appl_j_678;
                                                                    var_j_679 = t_check_b_311;
                                                                    if_j_688 = var_j_679 ? (
                                                                        bool_j_680 = false;
                                                                    pred_check_b_312 = bool_j_680;
                                                                    var_j_681 = is_pos;
                                                                    var_j_682 = expr_b_310;
                                                                    appl_j_683 = var_j_681 var_j_682;
                                                                    if_j_686 = appl_j_683 ? (
                                                                        bool_j_684 = true
                                                                    ) : (
                                                                        var_j_685 = pred_check_b_312
                                                                    )
                                                                    ) : (
                                                                        var_j_687 = t_check_b_311
                                                                    ));
                                                                flatten_fun_j_715 = fun bj_null_j_27 -> (
                                                                    bool_j_690 = false;
                                                                    fail_b_304 = bool_j_690;
                                                                    flatten_fun_j_699 = fun expr_b_303 -> (
                                                                    var_j_691 = expr_b_303;
                                                                    m_match_bool_j_693 = var_j_691 ~ any;
                                                                    m_match_bool_j_696 = var_j_691 ~ int;
                                                                    m_match_cond_j_697 = m_match_bool_j_696 ? (
                                                                        bool_j_698 = true
                                                                    ) : (
                                                                        m_match_cond_j_694 = m_match_bool_j_693 ? (
                                                                        var_j_695 = fail_b_304
                                                                    ) : (
                                                                        void_j_692 = 
                                                                    {}
                                                                    )
                                                                    ));
                                                                    flatten_fun_j_701 = fun bj_null_j_26 -> (
                                                                    input_j_700 = input);
                                                                    flatten_fun_j_703 = fun expr_b_305 -> (
                                                                    var_j_702 = expr_b_305);
                                                                    record_j_704 = 
                                                                    {checker = flatten_fun_j_699, generator = flatten_fun_j_701, wrapper = flatten_fun_j_703};
                                                                    proj_j_705 = record_j_704.generator;
                                                                    int_j_706 = 0;
                                                                    appl_j_707 = proj_j_705 int_j_706;
                                                                    candidate_b_306 = appl_j_707;
                                                                    var_j_708 = is_pos;
                                                                    var_j_709 = candidate_b_306;
                                                                    appl_j_710 = var_j_708 var_j_709;
                                                                    if_j_714 = appl_j_710 ? (
                                                                        var_j_711 = candidate_b_306
                                                                    ) : (
                                                                        bool_j_712 = false;
                                                                    assume_j_713 = assume bool_j_712
                                                                    ));
                                                                flatten_fun_j_717 = fun expr_b_313 -> (
                                                                    var_j_716 = expr_b_313);
                                                                record_j_718 = 
                                                                    {checker = flatten_fun_j_689, generator = flatten_fun_j_715, wrapper = flatten_fun_j_717};
                                                                proj_j_719 = record_j_718.checker;
                                                                var_j_720 = height_j_32;
                                                                appl_j_721 = proj_j_719 var_j_720;
                                                                lbl_check_b_302 = appl_j_721;
                                                                var_j_722 = lbl_check_b_302;
                                                                if_j_756 = var_j_722 ? (
                                                                        
                                                                    bool_j_723 = false;
                                                                    fail_b_300 = bool_j_723;
                                                                    flatten_fun_j_732 = fun expr_b_299 -> (
                                                                    var_j_724 = expr_b_299;
                                                                    m_match_bool_j_726 = var_j_724 ~ any;
                                                                    m_match_bool_j_729 = var_j_724 ~ int;
                                                                    m_match_cond_j_730 = m_match_bool_j_729 ? (
                                                                        bool_j_731 = true
                                                                    ) : (
                                                                        m_match_cond_j_727 = m_match_bool_j_726 ? (
                                                                        var_j_728 = fail_b_300
                                                                    ) : (
                                                                        void_j_725 = 
                                                                    {}
                                                                    )
                                                                    ));
                                                                    flatten_fun_j_734 = fun bj_null_j_28 -> (
                                                                    input_j_733 = input);
                                                                    flatten_fun_j_736 = fun expr_b_301 -> (
                                                                    var_j_735 = expr_b_301);
                                                                    record_j_737 = 
                                                                    {checker = flatten_fun_j_732, generator = flatten_fun_j_734, wrapper = flatten_fun_j_736};
                                                                    proj_j_738 = record_j_737.checker;
                                                                    var_j_739 = item_j_31;
                                                                    appl_j_740 = proj_j_738 var_j_739;
                                                                    lbl_check_b_298 = appl_j_740;
                                                                    var_j_741 = lbl_check_b_298;
                                                                    if_j_754 = var_j_741 ? (
                                                                        var_j_742 = tt;
                                                                    proj_j_743 = var_j_742.checker;
                                                                    var_j_744 = left_j_30;
                                                                    appl_j_745 = proj_j_743 var_j_744;
                                                                    lbl_check_b_297 = appl_j_745;
                                                                    var_j_746 = lbl_check_b_297;
                                                                    if_j_752 = var_j_746 ? (
                                                                        var_j_747 = tt;
                                                                    proj_j_748 = var_j_747.checker;
                                                                    var_j_749 = right_j_29;
                                                                    appl_j_750 = proj_j_748 var_j_749
                                                                    ) : (
                                                                        var_j_751 = lbl_check_b_297
                                                                    )
                                                                    ) : (
                                                                        var_j_753 = lbl_check_b_298
                                                                    )
                                                                    ) : (
                                                                        
                                                                    var_j_755 = lbl_check_b_302
                                                                    )
                                                            ) : (
                                                                m_match_cond_j_657 = m_match_bool_j_656 ? (
                                                                        
                                                                    var_j_658 = rec_fail_b_293
                                                                    ) : (
                                                                        
                                                                    void_j_655 = 
                                                                    {}
                                                                    )
                                                            )
                                                    ) : (
                                                        m_match_cond_j_649 = m_match_bool_j_648 ? (
                                                                var_j_650 = rec_fail_b_294
                                                            ) : (
                                                                void_j_647 = 
                                                                    {}
                                                            )
                                                    )
                                            ) : (
                                                m_match_cond_j_641 = m_match_bool_j_640 ? (
                                                        var_j_642 = rec_fail_b_295
                                                    ) : (
                                                        void_j_639 = 
                                                            {}
                                                    )
                                            ));
                                    flatten_fun_j_856 = fun bj_null_j_41 -> (
                                        var_j_758 = tt;
                                        proj_j_759 = var_j_758.generator;
                                        int_j_760 = 0;
                                        appl_j_761 = proj_j_759 int_j_760;
                                        right_b_278 = appl_j_761;
                                        var_j_762 = tt;
                                        proj_j_763 = var_j_762.generator;
                                        int_j_764 = 0;
                                        appl_j_765 = proj_j_763 int_j_764;
                                        left_b_277 = appl_j_765;
                                        bool_j_766 = false;
                                        fail_b_291 = bool_j_766;
                                        flatten_fun_j_775 = fun expr_b_290 -> (
                                            var_j_767 = expr_b_290;
                                            m_match_bool_j_769 = var_j_767 ~ any;
                                            m_match_bool_j_772 = var_j_767 ~ int;
                                            m_match_cond_j_773 = m_match_bool_j_772 ? (
                                                    bool_j_774 = true
                                                ) : (
                                                    m_match_cond_j_770 = m_match_bool_j_769 ? (
                                                            var_j_771 = fail_b_291
                                                        ) : (
                                                            void_j_768 = 
                                                                {}
                                                        )
                                                ));
                                        flatten_fun_j_777 = fun bj_null_j_37 -> (
                                            input_j_776 = input);
                                        flatten_fun_j_779 = fun expr_b_292 -> (
                                            var_j_778 = expr_b_292);
                                        record_j_780 = {checker = flatten_fun_j_775, generator = flatten_fun_j_777, wrapper = flatten_fun_j_779};
                                        proj_j_781 = record_j_780.generator;
                                        int_j_782 = 0;
                                        appl_j_783 = proj_j_781 int_j_782;
                                        item_b_276 = appl_j_783;
                                        flatten_fun_j_812 = fun expr_b_286 -> (
                                            bool_j_784 = false;
                                            fail_b_284 = bool_j_784;
                                            flatten_fun_j_793 = fun expr_b_283 -> (
                                                var_j_785 = expr_b_283;
                                                m_match_bool_j_787 = var_j_785 ~ any;
                                                m_match_bool_j_790 = var_j_785 ~ int;
                                                m_match_cond_j_791 = m_match_bool_j_790 ? (
                                                        bool_j_792 = true
                                                    ) : (
                                                        m_match_cond_j_788 = m_match_bool_j_787 ? (
                                                                var_j_789 = fail_b_284
                                                            ) : (
                                                                void_j_786 = 
                                                                    {}
                                                            )
                                                    ));
                                            flatten_fun_j_795 = fun bj_null_j_38 -> (
                                                input_j_794 = input);
                                            flatten_fun_j_797 = fun expr_b_285 -> (
                                                var_j_796 = expr_b_285);
                                            record_j_798 = {checker = flatten_fun_j_793, generator = flatten_fun_j_795, wrapper = flatten_fun_j_797};
                                            proj_j_799 = record_j_798.checker;
                                            var_j_800 = expr_b_286;
                                            appl_j_801 = proj_j_799 var_j_800;
                                            t_check_b_287 = appl_j_801;
                                            var_j_802 = t_check_b_287;
                                            if_j_811 = var_j_802 ? (
                                                    bool_j_803 = false;
                                                    pred_check_b_288 = bool_j_803;
                                                    var_j_804 = is_pos;
                                                    var_j_805 = expr_b_286;
                                                    appl_j_806 = var_j_804 var_j_805;
                                                    if_j_809 = appl_j_806 ? (
                                                            bool_j_807 = true
                                                        ) : (
                                                            var_j_808 = pred_check_b_288
                                                        )
                                                ) : (
                                                    var_j_810 = t_check_b_287
                                                ));
                                        flatten_fun_j_838 = fun bj_null_j_40 -> (
                                            bool_j_813 = false;
                                            fail_b_280 = bool_j_813;
                                            flatten_fun_j_822 = fun expr_b_279 -> (
                                                var_j_814 = expr_b_279;
                                                m_match_bool_j_816 = var_j_814 ~ any;
                                                m_match_bool_j_819 = var_j_814 ~ int;
                                                m_match_cond_j_820 = m_match_bool_j_819 ? (
                                                        bool_j_821 = true
                                                    ) : (
                                                        m_match_cond_j_817 = m_match_bool_j_816 ? (
                                                                var_j_818 = fail_b_280
                                                            ) : (
                                                                void_j_815 = 
                                                                    {}
                                                            )
                                                    ));
                                            flatten_fun_j_824 = fun bj_null_j_39 -> (
                                                input_j_823 = input);
                                            flatten_fun_j_826 = fun expr_b_281 -> (
                                                var_j_825 = expr_b_281);
                                            record_j_827 = {checker = flatten_fun_j_822, generator = flatten_fun_j_824, wrapper = flatten_fun_j_826};
                                            proj_j_828 = record_j_827.generator;
                                            int_j_829 = 0;
                                            appl_j_830 = proj_j_828 int_j_829;
                                            candidate_b_282 = appl_j_830;
                                            var_j_831 = is_pos;
                                            var_j_832 = candidate_b_282;
                                            appl_j_833 = var_j_831 var_j_832;
                                            if_j_837 = appl_j_833 ? (
                                                    var_j_834 = candidate_b_282
                                                ) : (
                                                    bool_j_835 = false;
                                                    assume_j_836 = assume bool_j_835
                                                ));
                                        flatten_fun_j_840 = fun expr_b_289 -> (
                                            var_j_839 = expr_b_289);
                                        record_j_841 = {checker = flatten_fun_j_812, generator = flatten_fun_j_838, wrapper = flatten_fun_j_840};
                                        proj_j_842 = record_j_841.generator;
                                        int_j_843 = 0;
                                        appl_j_844 = proj_j_842 int_j_843;
                                        height_b_275 = appl_j_844;
                                        var_j_845 = height_b_275;
                                        var_j_846 = item_b_276;
                                        var_j_847 = left_b_277;
                                        var_j_848 = right_b_278;
                                        record_j_849 = {height = var_j_845, item = var_j_846, left = var_j_847, right = var_j_848};
                                        record_j_850 = {};
                                        record_j_851 = {};
                                        record_j_852 = {};
                                        record_j_853 = {};
                                        record_j_854 = {height = record_j_850, item = record_j_851, left = record_j_852, right = record_j_853};
                                        record_j_855 = {bj_actual_rec = record_j_849, bj_decl_lbls = record_j_854});
                                    flatten_fun_j_858 = fun expr_b_314 -> (
                                        var_j_857 = expr_b_314);
                                    record_j_859 = {checker = flatten_fun_j_757, generator = flatten_fun_j_856, wrapper = flatten_fun_j_858};
                                    proj_j_860 = record_j_859.checker;
                                    var_j_861 = expr_b_327;
                                    appl_j_862 = proj_j_860 var_j_861;
                                    if_j_865 = appl_j_862 ? (
                                            bool_j_863 = true
                                        ) : (
                                            var_j_864 = fail_b_329
                                        )
                                )
                        ));
                flatten_fun_j_1181 = fun bj_null_j_64 -> (
                    input_j_869 = input;
                    select_int_b_222 = input_j_869;
                    int_j_870 = 0;
                    var_j_871 = select_int_b_222;
                    binop_j_872 = int_j_870 <= var_j_871;
                    if_j_1180 = binop_j_872 ? (
                            flatten_fun_j_995 = fun expr_b_191 -> (
                                bool_j_873 = false;
                                rec_fail_b_190 = bool_j_873;
                                bool_j_874 = false;
                                rec_fail_b_189 = bool_j_874;
                                bool_j_875 = false;
                                rec_fail_b_188 = bool_j_875;
                                var_j_876 = expr_b_191;
                                m_match_bool_j_878 = var_j_876 ~ any;
                                m_match_bool_j_881 = var_j_876 ~ {bj_actual_rec, _};
                                m_match_cond_j_882 = m_match_bool_j_881 ? (
                                        var_j_883 = expr_b_191;
                                        proj_j_884 = var_j_883.bj_decl_lbls;
                                        m_match_bool_j_886 = proj_j_884 ~ any;
                                        m_match_bool_j_889 = proj_j_884 ~ 
                                            {height, item, left, right, _};
                                        m_match_cond_j_890 = m_match_bool_j_889 ? (
                                                height_j_53 = proj_j_884.height;
                                                item_j_52 = proj_j_884.item;
                                                left_j_51 = proj_j_884.left;
                                                right_j_50 = proj_j_884.right;
                                                var_j_891 = expr_b_191;
                                                proj_j_892 = var_j_891.bj_actual_rec;
                                                m_match_bool_j_894 = proj_j_892 ~ any;
                                                m_match_bool_j_897 = proj_j_892 ~ 
                                                    {height, item, left, right, _};
                                                m_match_cond_j_898 = m_match_bool_j_897 ? (
                                                        height_j_49 = proj_j_892.height;
                                                        item_j_48 = proj_j_892.item;
                                                        left_j_47 = proj_j_892.left;
                                                        right_j_46 = proj_j_892.right;
                                                        flatten_fun_j_927 = fun expr_b_205 -> (
                                                            bool_j_899 = false;
                                                            fail_b_203 = bool_j_899;
                                                            flatten_fun_j_908 = fun expr_b_202 -> (
                                                                var_j_900 = expr_b_202;
                                                                m_match_bool_j_902 = var_j_900 ~ any;
                                                                m_match_bool_j_905 = var_j_900 ~ int;
                                                                m_match_cond_j_906 = m_match_bool_j_905 ? (
                                                                        
                                                                    bool_j_907 = true
                                                                    ) : (
                                                                        
                                                                    m_match_cond_j_903 = m_match_bool_j_902 ? (
                                                                        var_j_904 = fail_b_203
                                                                    ) : (
                                                                        void_j_901 = 
                                                                    {}
                                                                    )
                                                                    ));
                                                            flatten_fun_j_910 = fun bj_null_j_42 -> (
                                                                input_j_909 = input);
                                                            flatten_fun_j_912 = fun expr_b_204 -> (
                                                                var_j_911 = expr_b_204);
                                                            record_j_913 = 
                                                                {checker = flatten_fun_j_908, generator = flatten_fun_j_910, wrapper = flatten_fun_j_912};
                                                            proj_j_914 = record_j_913.checker;
                                                            var_j_915 = expr_b_205;
                                                            appl_j_916 = proj_j_914 var_j_915;
                                                            t_check_b_206 = appl_j_916;
                                                            var_j_917 = t_check_b_206;
                                                            if_j_926 = var_j_917 ? (
                                                                    bool_j_918 = false;
                                                                    pred_check_b_207 = bool_j_918;
                                                                    var_j_919 = is_pos;
                                                                    var_j_920 = expr_b_205;
                                                                    appl_j_921 = var_j_919 var_j_920;
                                                                    if_j_924 = appl_j_921 ? (
                                                                        bool_j_922 = true
                                                                    ) : (
                                                                        var_j_923 = pred_check_b_207
                                                                    )
                                                                ) : (
                                                                    var_j_925 = t_check_b_206
                                                                ));
                                                        flatten_fun_j_953 = fun bj_null_j_44 -> (
                                                            bool_j_928 = false;
                                                            fail_b_199 = bool_j_928;
                                                            flatten_fun_j_937 = fun expr_b_198 -> (
                                                                var_j_929 = expr_b_198;
                                                                m_match_bool_j_931 = var_j_929 ~ any;
                                                                m_match_bool_j_934 = var_j_929 ~ int;
                                                                m_match_cond_j_935 = m_match_bool_j_934 ? (
                                                                        
                                                                    bool_j_936 = true
                                                                    ) : (
                                                                        
                                                                    m_match_cond_j_932 = m_match_bool_j_931 ? (
                                                                        var_j_933 = fail_b_199
                                                                    ) : (
                                                                        void_j_930 = 
                                                                    {}
                                                                    )
                                                                    ));
                                                            flatten_fun_j_939 = fun bj_null_j_43 -> (
                                                                input_j_938 = input);
                                                            flatten_fun_j_941 = fun expr_b_200 -> (
                                                                var_j_940 = expr_b_200);
                                                            record_j_942 = 
                                                                {checker = flatten_fun_j_937, generator = flatten_fun_j_939, wrapper = flatten_fun_j_941};
                                                            proj_j_943 = record_j_942.generator;
                                                            int_j_944 = 0;
                                                            appl_j_945 = proj_j_943 int_j_944;
                                                            candidate_b_201 = appl_j_945;
                                                            var_j_946 = is_pos;
                                                            var_j_947 = candidate_b_201;
                                                            appl_j_948 = var_j_946 var_j_947;
                                                            if_j_952 = appl_j_948 ? (
                                                                    var_j_949 = candidate_b_201
                                                                ) : (
                                                                    bool_j_950 = false;
                                                                    assume_j_951 = assume bool_j_950
                                                                ));
                                                        flatten_fun_j_955 = fun expr_b_208 -> (
                                                            var_j_954 = expr_b_208);
                                                        record_j_956 = 
                                                            {checker = flatten_fun_j_927, generator = flatten_fun_j_953, wrapper = flatten_fun_j_955};
                                                        proj_j_957 = record_j_956.checker;
                                                        var_j_958 = height_j_49;
                                                        appl_j_959 = proj_j_957 var_j_958;
                                                        lbl_check_b_197 = appl_j_959;
                                                        var_j_960 = lbl_check_b_197;
                                                        if_j_994 = var_j_960 ? (
                                                                bool_j_961 = false;
                                                                fail_b_195 = bool_j_961;
                                                                flatten_fun_j_970 = fun expr_b_194 -> (
                                                                    var_j_962 = expr_b_194;
                                                                    m_match_bool_j_964 = var_j_962 ~ any;
                                                                    m_match_bool_j_967 = var_j_962 ~ int;
                                                                    m_match_cond_j_968 = m_match_bool_j_967 ? (
                                                                        bool_j_969 = true
                                                                    ) : (
                                                                        m_match_cond_j_965 = m_match_bool_j_964 ? (
                                                                        var_j_966 = fail_b_195
                                                                    ) : (
                                                                        void_j_963 = 
                                                                    {}
                                                                    )
                                                                    ));
                                                                flatten_fun_j_972 = fun bj_null_j_45 -> (
                                                                    input_j_971 = input);
                                                                flatten_fun_j_974 = fun expr_b_196 -> (
                                                                    var_j_973 = expr_b_196);
                                                                record_j_975 = 
                                                                    {checker = flatten_fun_j_970, generator = flatten_fun_j_972, wrapper = flatten_fun_j_974};
                                                                proj_j_976 = record_j_975.checker;
                                                                var_j_977 = item_j_48;
                                                                appl_j_978 = proj_j_976 var_j_977;
                                                                lbl_check_b_193 = appl_j_978;
                                                                var_j_979 = lbl_check_b_193;
                                                                if_j_992 = var_j_979 ? (
                                                                        
                                                                    var_j_980 = tt;
                                                                    proj_j_981 = var_j_980.checker;
                                                                    var_j_982 = left_j_47;
                                                                    appl_j_983 = proj_j_981 var_j_982;
                                                                    lbl_check_b_192 = appl_j_983;
                                                                    var_j_984 = lbl_check_b_192;
                                                                    if_j_990 = var_j_984 ? (
                                                                        var_j_985 = tt;
                                                                    proj_j_986 = var_j_985.checker;
                                                                    var_j_987 = right_j_46;
                                                                    appl_j_988 = proj_j_986 var_j_987
                                                                    ) : (
                                                                        var_j_989 = lbl_check_b_192
                                                                    )
                                                                    ) : (
                                                                        
                                                                    var_j_991 = lbl_check_b_193
                                                                    )
                                                            ) : (
                                                                var_j_993 = lbl_check_b_197
                                                            )
                                                    ) : (
                                                        m_match_cond_j_895 = m_match_bool_j_894 ? (
                                                                var_j_896 = rec_fail_b_188
                                                            ) : (
                                                                void_j_893 = 
                                                                    {}
                                                            )
                                                    )
                                            ) : (
                                                m_match_cond_j_887 = m_match_bool_j_886 ? (
                                                        var_j_888 = rec_fail_b_189
                                                    ) : (
                                                        void_j_885 = 
                                                            {}
                                                    )
                                            )
                                    ) : (
                                        m_match_cond_j_879 = m_match_bool_j_878 ? (
                                                var_j_880 = rec_fail_b_190
                                            ) : (
                                                void_j_877 = {}
                                            )
                                    ));
                            flatten_fun_j_1094 = fun bj_null_j_58 -> (
                                var_j_996 = tt;
                                proj_j_997 = var_j_996.generator;
                                int_j_998 = 0;
                                appl_j_999 = proj_j_997 int_j_998;
                                right_b_173 = appl_j_999;
                                var_j_1000 = tt;
                                proj_j_1001 = var_j_1000.generator;
                                int_j_1002 = 0;
                                appl_j_1003 = proj_j_1001 int_j_1002;
                                left_b_172 = appl_j_1003;
                                bool_j_1004 = false;
                                fail_b_186 = bool_j_1004;
                                flatten_fun_j_1013 = fun expr_b_185 -> (
                                    var_j_1005 = expr_b_185;
                                    m_match_bool_j_1007 = var_j_1005 ~ any;
                                    m_match_bool_j_1010 = var_j_1005 ~ int;
                                    m_match_cond_j_1011 = m_match_bool_j_1010 ? (
                                            bool_j_1012 = true
                                        ) : (
                                            m_match_cond_j_1008 = m_match_bool_j_1007 ? (
                                                    var_j_1009 = fail_b_186
                                                ) : (
                                                    void_j_1006 = {}
                                                )
                                        ));
                                flatten_fun_j_1015 = fun bj_null_j_54 -> (
                                    input_j_1014 = input);
                                flatten_fun_j_1017 = fun expr_b_187 -> (
                                    var_j_1016 = expr_b_187);
                                record_j_1018 = {checker = flatten_fun_j_1013, generator = flatten_fun_j_1015, wrapper = flatten_fun_j_1017};
                                proj_j_1019 = record_j_1018.generator;
                                int_j_1020 = 0;
                                appl_j_1021 = proj_j_1019 int_j_1020;
                                item_b_171 = appl_j_1021;
                                flatten_fun_j_1050 = fun expr_b_181 -> (
                                    bool_j_1022 = false;
                                    fail_b_179 = bool_j_1022;
                                    flatten_fun_j_1031 = fun expr_b_178 -> (
                                        var_j_1023 = expr_b_178;
                                        m_match_bool_j_1025 = var_j_1023 ~ any;
                                        m_match_bool_j_1028 = var_j_1023 ~ int;
                                        m_match_cond_j_1029 = m_match_bool_j_1028 ? (
                                                bool_j_1030 = true
                                            ) : (
                                                m_match_cond_j_1026 = m_match_bool_j_1025 ? (
                                                        var_j_1027 = fail_b_179
                                                    ) : (
                                                        void_j_1024 = 
                                                            {}
                                                    )
                                            ));
                                    flatten_fun_j_1033 = fun bj_null_j_55 -> (
                                        input_j_1032 = input);
                                    flatten_fun_j_1035 = fun expr_b_180 -> (
                                        var_j_1034 = expr_b_180);
                                    record_j_1036 = {checker = flatten_fun_j_1031, generator = flatten_fun_j_1033, wrapper = flatten_fun_j_1035};
                                    proj_j_1037 = record_j_1036.checker;
                                    var_j_1038 = expr_b_181;
                                    appl_j_1039 = proj_j_1037 var_j_1038;
                                    t_check_b_182 = appl_j_1039;
                                    var_j_1040 = t_check_b_182;
                                    if_j_1049 = var_j_1040 ? (
                                            bool_j_1041 = false;
                                            pred_check_b_183 = bool_j_1041;
                                            var_j_1042 = is_pos;
                                            var_j_1043 = expr_b_181;
                                            appl_j_1044 = var_j_1042 var_j_1043;
                                            if_j_1047 = appl_j_1044 ? (
                                                    bool_j_1045 = true
                                                ) : (
                                                    var_j_1046 = pred_check_b_183
                                                )
                                        ) : (
                                            var_j_1048 = t_check_b_182
                                        ));
                                flatten_fun_j_1076 = fun bj_null_j_57 -> (
                                    bool_j_1051 = false;
                                    fail_b_175 = bool_j_1051;
                                    flatten_fun_j_1060 = fun expr_b_174 -> (
                                        var_j_1052 = expr_b_174;
                                        m_match_bool_j_1054 = var_j_1052 ~ any;
                                        m_match_bool_j_1057 = var_j_1052 ~ int;
                                        m_match_cond_j_1058 = m_match_bool_j_1057 ? (
                                                bool_j_1059 = true
                                            ) : (
                                                m_match_cond_j_1055 = m_match_bool_j_1054 ? (
                                                        var_j_1056 = fail_b_175
                                                    ) : (
                                                        void_j_1053 = 
                                                            {}
                                                    )
                                            ));
                                    flatten_fun_j_1062 = fun bj_null_j_56 -> (
                                        input_j_1061 = input);
                                    flatten_fun_j_1064 = fun expr_b_176 -> (
                                        var_j_1063 = expr_b_176);
                                    record_j_1065 = {checker = flatten_fun_j_1060, generator = flatten_fun_j_1062, wrapper = flatten_fun_j_1064};
                                    proj_j_1066 = record_j_1065.generator;
                                    int_j_1067 = 0;
                                    appl_j_1068 = proj_j_1066 int_j_1067;
                                    candidate_b_177 = appl_j_1068;
                                    var_j_1069 = is_pos;
                                    var_j_1070 = candidate_b_177;
                                    appl_j_1071 = var_j_1069 var_j_1070;
                                    if_j_1075 = appl_j_1071 ? (
                                            var_j_1072 = candidate_b_177
                                        ) : (
                                            bool_j_1073 = false;
                                            assume_j_1074 = assume bool_j_1073
                                        ));
                                flatten_fun_j_1078 = fun expr_b_184 -> (
                                    var_j_1077 = expr_b_184);
                                record_j_1079 = {checker = flatten_fun_j_1050, generator = flatten_fun_j_1076, wrapper = flatten_fun_j_1078};
                                proj_j_1080 = record_j_1079.generator;
                                int_j_1081 = 0;
                                appl_j_1082 = proj_j_1080 int_j_1081;
                                height_b_170 = appl_j_1082;
                                var_j_1083 = height_b_170;
                                var_j_1084 = item_b_171;
                                var_j_1085 = left_b_172;
                                var_j_1086 = right_b_173;
                                record_j_1087 = {height = var_j_1083, item = var_j_1084, left = var_j_1085, right = var_j_1086};
                                record_j_1088 = {};
                                record_j_1089 = {};
                                record_j_1090 = {};
                                record_j_1091 = {};
                                record_j_1092 = {height = record_j_1088, item = record_j_1089, left = record_j_1090, right = record_j_1091};
                                record_j_1093 = {bj_actual_rec = record_j_1087, bj_decl_lbls = record_j_1092});
                            flatten_fun_j_1096 = fun expr_b_209 -> (
                                var_j_1095 = expr_b_209);
                            record_j_1097 = {checker = flatten_fun_j_995, generator = flatten_fun_j_1094, wrapper = flatten_fun_j_1096};
                            proj_j_1098 = record_j_1097.generator;
                            int_j_1099 = 0;
                            appl_j_1100 = proj_j_1098 int_j_1099
                        ) : (
                            flatten_fun_j_1147 = fun expr_b_217 -> (
                                bool_j_1101 = false;
                                rec_fail_b_216 = bool_j_1101;
                                bool_j_1102 = false;
                                rec_fail_b_215 = bool_j_1102;
                                bool_j_1103 = false;
                                rec_fail_b_214 = bool_j_1103;
                                var_j_1104 = expr_b_217;
                                m_match_bool_j_1106 = var_j_1104 ~ any;
                                m_match_bool_j_1109 = var_j_1104 ~ {bj_actual_rec, _};
                                m_match_cond_j_1110 = m_match_bool_j_1109 ? (
                                        var_j_1111 = expr_b_217;
                                        proj_j_1112 = var_j_1111.bj_decl_lbls;
                                        m_match_bool_j_1114 = proj_j_1112 ~ any;
                                        m_match_bool_j_1117 = proj_j_1112 ~ 
                                            {leaf, _};
                                        m_match_cond_j_1118 = m_match_bool_j_1117 ? (
                                                leaf_j_61 = proj_j_1112.leaf;
                                                var_j_1119 = expr_b_217;
                                                proj_j_1120 = var_j_1119.bj_actual_rec;
                                                m_match_bool_j_1122 = proj_j_1120 ~ any;
                                                m_match_bool_j_1125 = proj_j_1120 ~ 
                                                    {leaf, _};
                                                m_match_cond_j_1126 = m_match_bool_j_1125 ? (
                                                        leaf_j_60 = proj_j_1120.leaf;
                                                        bool_j_1127 = false;
                                                        fail_b_219 = bool_j_1127;
                                                        flatten_fun_j_1136 = fun expr_b_218 -> (
                                                            var_j_1128 = expr_b_218;
                                                            m_match_bool_j_1130 = var_j_1128 ~ any;
                                                            m_match_bool_j_1133 = var_j_1128 ~ bool;
                                                            m_match_cond_j_1134 = m_match_bool_j_1133 ? (
                                                                    bool_j_1135 = true
                                                                ) : (
                                                                    m_match_cond_j_1131 = m_match_bool_j_1130 ? (
                                                                        var_j_1132 = fail_b_219
                                                                    ) : (
                                                                        void_j_1129 = 
                                                                    {}
                                                                    )
                                                                ));
                                                        flatten_fun_j_1140 = fun bj_null_j_59 -> (
                                                            int_j_1137 = 0;
                                                            input_j_1138 = input;
                                                            m_bl_i_2917 = int_j_1137 ~ int;
                                                            m_br_i_2918 = input_j_1138 ~ int;
                                                            m_b_i_2919 = m_bl_i_2917 and m_br_i_2918;
                                                            binop_j_1139 = m_b_i_2919 ? (
                                                                    c_binop_i_2920 = int_j_1137 <= input_j_1138
                                                                ) : (
                                                                    ab_i_2921 = abort
                                                                ));
                                                        flatten_fun_j_1142 = fun expr_b_220 -> (
                                                            var_j_1141 = expr_b_220);
                                                        record_j_1143 = 
                                                            {checker = flatten_fun_j_1136, generator = flatten_fun_j_1140, wrapper = flatten_fun_j_1142};
                                                        proj_j_1144 = record_j_1143.checker;
                                                        var_j_1145 = leaf_j_60;
                                                        appl_j_1146 = proj_j_1144 var_j_1145
                                                    ) : (
                                                        m_match_cond_j_1123 = m_match_bool_j_1122 ? (
                                                                var_j_1124 = rec_fail_b_214
                                                            ) : (
                                                                void_j_1121 = 
                                                                    {}
                                                            )
                                                    )
                                            ) : (
                                                m_match_cond_j_1115 = m_match_bool_j_1114 ? (
                                                        var_j_1116 = rec_fail_b_215
                                                    ) : (
                                                        void_j_1113 = 
                                                            {}
                                                    )
                                            )
                                    ) : (
                                        m_match_cond_j_1107 = m_match_bool_j_1106 ? (
                                                var_j_1108 = rec_fail_b_216
                                            ) : (
                                                void_j_1105 = {}
                                            )
                                    ));
                            flatten_fun_j_1173 = fun bj_null_j_63 -> (
                                bool_j_1148 = false;
                                fail_b_212 = bool_j_1148;
                                flatten_fun_j_1157 = fun expr_b_211 -> (
                                    var_j_1149 = expr_b_211;
                                    m_match_bool_j_1151 = var_j_1149 ~ any;
                                    m_match_bool_j_1154 = var_j_1149 ~ bool;
                                    m_match_cond_j_1155 = m_match_bool_j_1154 ? (
                                            bool_j_1156 = true
                                        ) : (
                                            m_match_cond_j_1152 = m_match_bool_j_1151 ? (
                                                    var_j_1153 = fail_b_212
                                                ) : (
                                                    void_j_1150 = {}
                                                )
                                        ));
                                flatten_fun_j_1161 = fun bj_null_j_62 -> (
                                    int_j_1158 = 0;
                                    input_j_1159 = input;
                                    m_bl_i_2922 = int_j_1158 ~ int;
                                    m_br_i_2923 = input_j_1159 ~ int;
                                    m_b_i_2924 = m_bl_i_2922 and m_br_i_2923;
                                    binop_j_1160 = m_b_i_2924 ? (
                                            c_binop_i_2925 = int_j_1158 <= input_j_1159
                                        ) : (
                                            ab_i_2926 = abort
                                        ));
                                flatten_fun_j_1163 = fun expr_b_213 -> (
                                    var_j_1162 = expr_b_213);
                                record_j_1164 = {checker = flatten_fun_j_1157, generator = flatten_fun_j_1161, wrapper = flatten_fun_j_1163};
                                proj_j_1165 = record_j_1164.generator;
                                int_j_1166 = 0;
                                appl_j_1167 = proj_j_1165 int_j_1166;
                                leaf_b_210 = appl_j_1167;
                                var_j_1168 = leaf_b_210;
                                record_j_1169 = {leaf = var_j_1168};
                                record_j_1170 = {};
                                record_j_1171 = {leaf = record_j_1170};
                                record_j_1172 = {bj_actual_rec = record_j_1169, bj_decl_lbls = record_j_1171});
                            flatten_fun_j_1175 = fun expr_b_221 -> (
                                var_j_1174 = expr_b_221);
                            record_j_1176 = {checker = flatten_fun_j_1147, generator = flatten_fun_j_1173, wrapper = flatten_fun_j_1175};
                            proj_j_1177 = record_j_1176.generator;
                            int_j_1178 = 0;
                            appl_j_1179 = proj_j_1177 int_j_1178
                        ));
                flatten_fun_j_1183 = fun expr_b_330 -> (
                    var_j_1182 = expr_b_330);
                record_j_1184 = {checker = flatten_fun_j_868, generator = flatten_fun_j_1181, wrapper = flatten_fun_j_1183};
                proj_j_1185 = record_j_1184.checker;
                var_j_1186 = expr_b_331;
                appl_j_1187 = proj_j_1185 var_j_1186);
            var_j_1189 = self_b_4;
            int_j_1190 = 0;
            appl_j_1191 = var_j_1189 int_j_1190;
            appl_j_1192 = flatten_fun_j_1188 appl_j_1191);
        flatten_fun_j_2149 = fun bj_null_j_133 -> (
            flatten_fun_j_2144 = fun tt_j_132 -> (
                flatten_fun_j_1824 = fun expr_b_166 -> (
                    input_j_1194 = input;
                    select_int_b_167 = input_j_1194;
                    bool_j_1195 = false;
                    fail_b_168 = bool_j_1195;
                    int_j_1196 = 0;
                    var_j_1197 = select_int_b_167;
                    binop_j_1198 = int_j_1196 <= var_j_1197;
                    if_j_1823 = binop_j_1198 ? (
                            flatten_fun_j_1321 = fun expr_b_83 -> (
                                bool_j_1199 = false;
                                rec_fail_b_82 = bool_j_1199;
                                bool_j_1200 = false;
                                rec_fail_b_81 = bool_j_1200;
                                bool_j_1201 = false;
                                rec_fail_b_80 = bool_j_1201;
                                var_j_1202 = expr_b_83;
                                m_match_bool_j_1204 = var_j_1202 ~ any;
                                m_match_bool_j_1207 = var_j_1202 ~ {bj_actual_rec, _};
                                m_match_cond_j_1208 = m_match_bool_j_1207 ? (
                                        var_j_1209 = expr_b_83;
                                        proj_j_1210 = var_j_1209.bj_decl_lbls;
                                        m_match_bool_j_1212 = proj_j_1210 ~ any;
                                        m_match_bool_j_1215 = proj_j_1210 ~ 
                                            {height, item, left, right, _};
                                        m_match_cond_j_1216 = m_match_bool_j_1215 ? (
                                                height_j_76 = proj_j_1210.height;
                                                item_j_75 = proj_j_1210.item;
                                                left_j_74 = proj_j_1210.left;
                                                right_j_73 = proj_j_1210.right;
                                                var_j_1217 = expr_b_83;
                                                proj_j_1218 = var_j_1217.bj_actual_rec;
                                                m_match_bool_j_1220 = proj_j_1218 ~ any;
                                                m_match_bool_j_1223 = proj_j_1218 ~ 
                                                    {height, item, left, right, _};
                                                m_match_cond_j_1224 = m_match_bool_j_1223 ? (
                                                        height_j_72 = proj_j_1218.height;
                                                        item_j_71 = proj_j_1218.item;
                                                        left_j_70 = proj_j_1218.left;
                                                        right_j_69 = proj_j_1218.right;
                                                        flatten_fun_j_1253 = fun expr_b_97 -> (
                                                            bool_j_1225 = false;
                                                            fail_b_95 = bool_j_1225;
                                                            flatten_fun_j_1234 = fun expr_b_94 -> (
                                                                var_j_1226 = expr_b_94;
                                                                m_match_bool_j_1228 = var_j_1226 ~ any;
                                                                m_match_bool_j_1231 = var_j_1226 ~ int;
                                                                m_match_cond_j_1232 = m_match_bool_j_1231 ? (
                                                                        
                                                                    bool_j_1233 = true
                                                                    ) : (
                                                                        
                                                                    m_match_cond_j_1229 = m_match_bool_j_1228 ? (
                                                                        var_j_1230 = fail_b_95
                                                                    ) : (
                                                                        void_j_1227 = 
                                                                    {}
                                                                    )
                                                                    ));
                                                            flatten_fun_j_1236 = fun bj_null_j_65 -> (
                                                                input_j_1235 = input);
                                                            flatten_fun_j_1238 = fun expr_b_96 -> (
                                                                var_j_1237 = expr_b_96);
                                                            record_j_1239 = 
                                                                {checker = flatten_fun_j_1234, generator = flatten_fun_j_1236, wrapper = flatten_fun_j_1238};
                                                            proj_j_1240 = record_j_1239.checker;
                                                            var_j_1241 = expr_b_97;
                                                            appl_j_1242 = proj_j_1240 var_j_1241;
                                                            t_check_b_98 = appl_j_1242;
                                                            var_j_1243 = t_check_b_98;
                                                            if_j_1252 = var_j_1243 ? (
                                                                    bool_j_1244 = false;
                                                                    pred_check_b_99 = bool_j_1244;
                                                                    var_j_1245 = is_pos;
                                                                    var_j_1246 = expr_b_97;
                                                                    appl_j_1247 = var_j_1245 var_j_1246;
                                                                    if_j_1250 = appl_j_1247 ? (
                                                                        bool_j_1248 = true
                                                                    ) : (
                                                                        var_j_1249 = pred_check_b_99
                                                                    )
                                                                ) : (
                                                                    var_j_1251 = t_check_b_98
                                                                ));
                                                        flatten_fun_j_1279 = fun bj_null_j_67 -> (
                                                            bool_j_1254 = false;
                                                            fail_b_91 = bool_j_1254;
                                                            flatten_fun_j_1263 = fun expr_b_90 -> (
                                                                var_j_1255 = expr_b_90;
                                                                m_match_bool_j_1257 = var_j_1255 ~ any;
                                                                m_match_bool_j_1260 = var_j_1255 ~ int;
                                                                m_match_cond_j_1261 = m_match_bool_j_1260 ? (
                                                                        
                                                                    bool_j_1262 = true
                                                                    ) : (
                                                                        
                                                                    m_match_cond_j_1258 = m_match_bool_j_1257 ? (
                                                                        var_j_1259 = fail_b_91
                                                                    ) : (
                                                                        void_j_1256 = 
                                                                    {}
                                                                    )
                                                                    ));
                                                            flatten_fun_j_1265 = fun bj_null_j_66 -> (
                                                                input_j_1264 = input);
                                                            flatten_fun_j_1267 = fun expr_b_92 -> (
                                                                var_j_1266 = expr_b_92);
                                                            record_j_1268 = 
                                                                {checker = flatten_fun_j_1263, generator = flatten_fun_j_1265, wrapper = flatten_fun_j_1267};
                                                            proj_j_1269 = record_j_1268.generator;
                                                            int_j_1270 = 0;
                                                            appl_j_1271 = proj_j_1269 int_j_1270;
                                                            candidate_b_93 = appl_j_1271;
                                                            var_j_1272 = is_pos;
                                                            var_j_1273 = candidate_b_93;
                                                            appl_j_1274 = var_j_1272 var_j_1273;
                                                            if_j_1278 = appl_j_1274 ? (
                                                                    var_j_1275 = candidate_b_93
                                                                ) : (
                                                                    bool_j_1276 = false;
                                                                    assume_j_1277 = assume bool_j_1276
                                                                ));
                                                        flatten_fun_j_1281 = fun expr_b_100 -> (
                                                            var_j_1280 = expr_b_100);
                                                        record_j_1282 = 
                                                            {checker = flatten_fun_j_1253, generator = flatten_fun_j_1279, wrapper = flatten_fun_j_1281};
                                                        proj_j_1283 = record_j_1282.checker;
                                                        var_j_1284 = height_j_72;
                                                        appl_j_1285 = proj_j_1283 var_j_1284;
                                                        lbl_check_b_89 = appl_j_1285;
                                                        var_j_1286 = lbl_check_b_89;
                                                        if_j_1320 = var_j_1286 ? (
                                                                bool_j_1287 = false;
                                                                fail_b_87 = bool_j_1287;
                                                                flatten_fun_j_1296 = fun expr_b_86 -> (
                                                                    var_j_1288 = expr_b_86;
                                                                    m_match_bool_j_1290 = var_j_1288 ~ any;
                                                                    m_match_bool_j_1293 = var_j_1288 ~ int;
                                                                    m_match_cond_j_1294 = m_match_bool_j_1293 ? (
                                                                        bool_j_1295 = true
                                                                    ) : (
                                                                        m_match_cond_j_1291 = m_match_bool_j_1290 ? (
                                                                        var_j_1292 = fail_b_87
                                                                    ) : (
                                                                        void_j_1289 = 
                                                                    {}
                                                                    )
                                                                    ));
                                                                flatten_fun_j_1298 = fun bj_null_j_68 -> (
                                                                    input_j_1297 = input);
                                                                flatten_fun_j_1300 = fun expr_b_88 -> (
                                                                    var_j_1299 = expr_b_88);
                                                                record_j_1301 = 
                                                                    {checker = flatten_fun_j_1296, generator = flatten_fun_j_1298, wrapper = flatten_fun_j_1300};
                                                                proj_j_1302 = record_j_1301.checker;
                                                                var_j_1303 = item_j_71;
                                                                appl_j_1304 = proj_j_1302 var_j_1303;
                                                                lbl_check_b_85 = appl_j_1304;
                                                                var_j_1305 = lbl_check_b_85;
                                                                if_j_1318 = var_j_1305 ? (
                                                                        
                                                                    var_j_1306 = tt_j_132;
                                                                    proj_j_1307 = var_j_1306.checker;
                                                                    var_j_1308 = left_j_70;
                                                                    appl_j_1309 = proj_j_1307 var_j_1308;
                                                                    lbl_check_b_84 = appl_j_1309;
                                                                    var_j_1310 = lbl_check_b_84;
                                                                    if_j_1316 = var_j_1310 ? (
                                                                        var_j_1311 = tt_j_132;
                                                                    proj_j_1312 = var_j_1311.checker;
                                                                    var_j_1313 = right_j_69;
                                                                    appl_j_1314 = proj_j_1312 var_j_1313
                                                                    ) : (
                                                                        var_j_1315 = lbl_check_b_84
                                                                    )
                                                                    ) : (
                                                                        
                                                                    var_j_1317 = lbl_check_b_85
                                                                    )
                                                            ) : (
                                                                var_j_1319 = lbl_check_b_89
                                                            )
                                                    ) : (
                                                        m_match_cond_j_1221 = m_match_bool_j_1220 ? (
                                                                var_j_1222 = rec_fail_b_80
                                                            ) : (
                                                                void_j_1219 = 
                                                                    {}
                                                            )
                                                    )
                                            ) : (
                                                m_match_cond_j_1213 = m_match_bool_j_1212 ? (
                                                        var_j_1214 = rec_fail_b_81
                                                    ) : (
                                                        void_j_1211 = 
                                                            {}
                                                    )
                                            )
                                    ) : (
                                        m_match_cond_j_1205 = m_match_bool_j_1204 ? (
                                                var_j_1206 = rec_fail_b_82
                                            ) : (
                                                void_j_1203 = {}
                                            )
                                    ));
                            flatten_fun_j_1420 = fun bj_null_j_81 -> (
                                var_j_1322 = tt_j_132;
                                proj_j_1323 = var_j_1322.generator;
                                int_j_1324 = 0;
                                appl_j_1325 = proj_j_1323 int_j_1324;
                                right_b_65 = appl_j_1325;
                                var_j_1326 = tt_j_132;
                                proj_j_1327 = var_j_1326.generator;
                                int_j_1328 = 0;
                                appl_j_1329 = proj_j_1327 int_j_1328;
                                left_b_64 = appl_j_1329;
                                bool_j_1330 = false;
                                fail_b_78 = bool_j_1330;
                                flatten_fun_j_1339 = fun expr_b_77 -> (
                                    var_j_1331 = expr_b_77;
                                    m_match_bool_j_1333 = var_j_1331 ~ any;
                                    m_match_bool_j_1336 = var_j_1331 ~ int;
                                    m_match_cond_j_1337 = m_match_bool_j_1336 ? (
                                            bool_j_1338 = true
                                        ) : (
                                            m_match_cond_j_1334 = m_match_bool_j_1333 ? (
                                                    var_j_1335 = fail_b_78
                                                ) : (
                                                    void_j_1332 = {}
                                                )
                                        ));
                                flatten_fun_j_1341 = fun bj_null_j_77 -> (
                                    input_j_1340 = input);
                                flatten_fun_j_1343 = fun expr_b_79 -> (
                                    var_j_1342 = expr_b_79);
                                record_j_1344 = {checker = flatten_fun_j_1339, generator = flatten_fun_j_1341, wrapper = flatten_fun_j_1343};
                                proj_j_1345 = record_j_1344.generator;
                                int_j_1346 = 0;
                                appl_j_1347 = proj_j_1345 int_j_1346;
                                item_b_63 = appl_j_1347;
                                flatten_fun_j_1376 = fun expr_b_73 -> (
                                    bool_j_1348 = false;
                                    fail_b_71 = bool_j_1348;
                                    flatten_fun_j_1357 = fun expr_b_70 -> (
                                        var_j_1349 = expr_b_70;
                                        m_match_bool_j_1351 = var_j_1349 ~ any;
                                        m_match_bool_j_1354 = var_j_1349 ~ int;
                                        m_match_cond_j_1355 = m_match_bool_j_1354 ? (
                                                bool_j_1356 = true
                                            ) : (
                                                m_match_cond_j_1352 = m_match_bool_j_1351 ? (
                                                        var_j_1353 = fail_b_71
                                                    ) : (
                                                        void_j_1350 = 
                                                            {}
                                                    )
                                            ));
                                    flatten_fun_j_1359 = fun bj_null_j_78 -> (
                                        input_j_1358 = input);
                                    flatten_fun_j_1361 = fun expr_b_72 -> (
                                        var_j_1360 = expr_b_72);
                                    record_j_1362 = {checker = flatten_fun_j_1357, generator = flatten_fun_j_1359, wrapper = flatten_fun_j_1361};
                                    proj_j_1363 = record_j_1362.checker;
                                    var_j_1364 = expr_b_73;
                                    appl_j_1365 = proj_j_1363 var_j_1364;
                                    t_check_b_74 = appl_j_1365;
                                    var_j_1366 = t_check_b_74;
                                    if_j_1375 = var_j_1366 ? (
                                            bool_j_1367 = false;
                                            pred_check_b_75 = bool_j_1367;
                                            var_j_1368 = is_pos;
                                            var_j_1369 = expr_b_73;
                                            appl_j_1370 = var_j_1368 var_j_1369;
                                            if_j_1373 = appl_j_1370 ? (
                                                    bool_j_1371 = true
                                                ) : (
                                                    var_j_1372 = pred_check_b_75
                                                )
                                        ) : (
                                            var_j_1374 = t_check_b_74
                                        ));
                                flatten_fun_j_1402 = fun bj_null_j_80 -> (
                                    bool_j_1377 = false;
                                    fail_b_67 = bool_j_1377;
                                    flatten_fun_j_1386 = fun expr_b_66 -> (
                                        var_j_1378 = expr_b_66;
                                        m_match_bool_j_1380 = var_j_1378 ~ any;
                                        m_match_bool_j_1383 = var_j_1378 ~ int;
                                        m_match_cond_j_1384 = m_match_bool_j_1383 ? (
                                                bool_j_1385 = true
                                            ) : (
                                                m_match_cond_j_1381 = m_match_bool_j_1380 ? (
                                                        var_j_1382 = fail_b_67
                                                    ) : (
                                                        void_j_1379 = 
                                                            {}
                                                    )
                                            ));
                                    flatten_fun_j_1388 = fun bj_null_j_79 -> (
                                        input_j_1387 = input);
                                    flatten_fun_j_1390 = fun expr_b_68 -> (
                                        var_j_1389 = expr_b_68);
                                    record_j_1391 = {checker = flatten_fun_j_1386, generator = flatten_fun_j_1388, wrapper = flatten_fun_j_1390};
                                    proj_j_1392 = record_j_1391.generator;
                                    int_j_1393 = 0;
                                    appl_j_1394 = proj_j_1392 int_j_1393;
                                    candidate_b_69 = appl_j_1394;
                                    var_j_1395 = is_pos;
                                    var_j_1396 = candidate_b_69;
                                    appl_j_1397 = var_j_1395 var_j_1396;
                                    if_j_1401 = appl_j_1397 ? (
                                            var_j_1398 = candidate_b_69
                                        ) : (
                                            bool_j_1399 = false;
                                            assume_j_1400 = assume bool_j_1399
                                        ));
                                flatten_fun_j_1404 = fun expr_b_76 -> (
                                    var_j_1403 = expr_b_76);
                                record_j_1405 = {checker = flatten_fun_j_1376, generator = flatten_fun_j_1402, wrapper = flatten_fun_j_1404};
                                proj_j_1406 = record_j_1405.generator;
                                int_j_1407 = 0;
                                appl_j_1408 = proj_j_1406 int_j_1407;
                                height_b_62 = appl_j_1408;
                                var_j_1409 = height_b_62;
                                var_j_1410 = item_b_63;
                                var_j_1411 = left_b_64;
                                var_j_1412 = right_b_65;
                                record_j_1413 = {height = var_j_1409, item = var_j_1410, left = var_j_1411, right = var_j_1412};
                                record_j_1414 = {};
                                record_j_1415 = {};
                                record_j_1416 = {};
                                record_j_1417 = {};
                                record_j_1418 = {height = record_j_1414, item = record_j_1415, left = record_j_1416, right = record_j_1417};
                                record_j_1419 = {bj_actual_rec = record_j_1413, bj_decl_lbls = record_j_1418});
                            flatten_fun_j_1422 = fun expr_b_101 -> (
                                var_j_1421 = expr_b_101);
                            record_j_1423 = {checker = flatten_fun_j_1321, generator = flatten_fun_j_1420, wrapper = flatten_fun_j_1422};
                            proj_j_1424 = record_j_1423.checker;
                            var_j_1425 = expr_b_166;
                            appl_j_1426 = proj_j_1424 var_j_1425;
                            if_j_1510 = appl_j_1426 ? (
                                    bool_j_1427 = true
                                ) : (
                                    flatten_fun_j_1474 = fun expr_b_109 -> (
                                        bool_j_1428 = false;
                                        rec_fail_b_108 = bool_j_1428;
                                        bool_j_1429 = false;
                                        rec_fail_b_107 = bool_j_1429;
                                        bool_j_1430 = false;
                                        rec_fail_b_106 = bool_j_1430;
                                        var_j_1431 = expr_b_109;
                                        m_match_bool_j_1433 = var_j_1431 ~ any;
                                        m_match_bool_j_1436 = var_j_1431 ~ 
                                            {bj_actual_rec, _};
                                        m_match_cond_j_1437 = m_match_bool_j_1436 ? (
                                                var_j_1438 = expr_b_109;
                                                proj_j_1439 = var_j_1438.bj_decl_lbls;
                                                m_match_bool_j_1441 = proj_j_1439 ~ any;
                                                m_match_bool_j_1444 = proj_j_1439 ~ 
                                                    {leaf, _};
                                                m_match_cond_j_1445 = m_match_bool_j_1444 ? (
                                                        leaf_j_84 = proj_j_1439.leaf;
                                                        var_j_1446 = expr_b_109;
                                                        proj_j_1447 = var_j_1446.bj_actual_rec;
                                                        m_match_bool_j_1449 = proj_j_1447 ~ any;
                                                        m_match_bool_j_1452 = proj_j_1447 ~ 
                                                            {leaf, _};
                                                        m_match_cond_j_1453 = m_match_bool_j_1452 ? (
                                                                leaf_j_83 = proj_j_1447.leaf;
                                                                bool_j_1454 = false;
                                                                fail_b_111 = bool_j_1454;
                                                                flatten_fun_j_1463 = fun expr_b_110 -> (
                                                                    var_j_1455 = expr_b_110;
                                                                    m_match_bool_j_1457 = var_j_1455 ~ any;
                                                                    m_match_bool_j_1460 = var_j_1455 ~ bool;
                                                                    m_match_cond_j_1461 = m_match_bool_j_1460 ? (
                                                                        bool_j_1462 = true
                                                                    ) : (
                                                                        m_match_cond_j_1458 = m_match_bool_j_1457 ? (
                                                                        var_j_1459 = fail_b_111
                                                                    ) : (
                                                                        void_j_1456 = 
                                                                    {}
                                                                    )
                                                                    ));
                                                                flatten_fun_j_1467 = fun bj_null_j_82 -> (
                                                                    int_j_1464 = 0;
                                                                    input_j_1465 = input;
                                                                    m_bl_i_2927 = int_j_1464 ~ int;
                                                                    m_br_i_2928 = input_j_1465 ~ int;
                                                                    m_b_i_2929 = m_bl_i_2927 and m_br_i_2928;
                                                                    binop_j_1466 = m_b_i_2929 ? (
                                                                        c_binop_i_2930 = int_j_1464 <= input_j_1465
                                                                    ) : (
                                                                        ab_i_2931 = abort
                                                                    ));
                                                                flatten_fun_j_1469 = fun expr_b_112 -> (
                                                                    var_j_1468 = expr_b_112);
                                                                record_j_1470 = 
                                                                    {checker = flatten_fun_j_1463, generator = flatten_fun_j_1467, wrapper = flatten_fun_j_1469};
                                                                proj_j_1471 = record_j_1470.checker;
                                                                var_j_1472 = leaf_j_83;
                                                                appl_j_1473 = proj_j_1471 var_j_1472
                                                            ) : (
                                                                m_match_cond_j_1450 = m_match_bool_j_1449 ? (
                                                                        
                                                                    var_j_1451 = rec_fail_b_106
                                                                    ) : (
                                                                        
                                                                    void_j_1448 = 
                                                                    {}
                                                                    )
                                                            )
                                                    ) : (
                                                        m_match_cond_j_1442 = m_match_bool_j_1441 ? (
                                                                var_j_1443 = rec_fail_b_107
                                                            ) : (
                                                                void_j_1440 = 
                                                                    {}
                                                            )
                                                    )
                                            ) : (
                                                m_match_cond_j_1434 = m_match_bool_j_1433 ? (
                                                        var_j_1435 = rec_fail_b_108
                                                    ) : (
                                                        void_j_1432 = 
                                                            {}
                                                    )
                                            ));
                                    flatten_fun_j_1500 = fun bj_null_j_86 -> (
                                        bool_j_1475 = false;
                                        fail_b_104 = bool_j_1475;
                                        flatten_fun_j_1484 = fun expr_b_103 -> (
                                            var_j_1476 = expr_b_103;
                                            m_match_bool_j_1478 = var_j_1476 ~ any;
                                            m_match_bool_j_1481 = var_j_1476 ~ bool;
                                            m_match_cond_j_1482 = m_match_bool_j_1481 ? (
                                                    bool_j_1483 = true
                                                ) : (
                                                    m_match_cond_j_1479 = m_match_bool_j_1478 ? (
                                                            var_j_1480 = fail_b_104
                                                        ) : (
                                                            void_j_1477 = 
                                                                {}
                                                        )
                                                ));
                                        flatten_fun_j_1488 = fun bj_null_j_85 -> (
                                            int_j_1485 = 0;
                                            input_j_1486 = input;
                                            m_bl_i_2932 = int_j_1485 ~ int;
                                            m_br_i_2933 = input_j_1486 ~ int;
                                            m_b_i_2934 = m_bl_i_2932 and m_br_i_2933;
                                            binop_j_1487 = m_b_i_2934 ? (
                                                    c_binop_i_2935 = int_j_1485 <= input_j_1486
                                                ) : (
                                                    ab_i_2936 = abort
                                                ));
                                        flatten_fun_j_1490 = fun expr_b_105 -> (
                                            var_j_1489 = expr_b_105);
                                        record_j_1491 = {checker = flatten_fun_j_1484, generator = flatten_fun_j_1488, wrapper = flatten_fun_j_1490};
                                        proj_j_1492 = record_j_1491.generator;
                                        int_j_1493 = 0;
                                        appl_j_1494 = proj_j_1492 int_j_1493;
                                        leaf_b_102 = appl_j_1494;
                                        var_j_1495 = leaf_b_102;
                                        record_j_1496 = {leaf = var_j_1495};
                                        record_j_1497 = {};
                                        record_j_1498 = {leaf = record_j_1497};
                                        record_j_1499 = {bj_actual_rec = record_j_1496, bj_decl_lbls = record_j_1498});
                                    flatten_fun_j_1502 = fun expr_b_113 -> (
                                        var_j_1501 = expr_b_113);
                                    record_j_1503 = {checker = flatten_fun_j_1474, generator = flatten_fun_j_1500, wrapper = flatten_fun_j_1502};
                                    proj_j_1504 = record_j_1503.checker;
                                    var_j_1505 = expr_b_166;
                                    appl_j_1506 = proj_j_1504 var_j_1505;
                                    if_j_1509 = appl_j_1506 ? (
                                            bool_j_1507 = true
                                        ) : (
                                            var_j_1508 = fail_b_168
                                        )
                                )
                        ) : (
                            flatten_fun_j_1557 = fun expr_b_161 -> (
                                bool_j_1511 = false;
                                rec_fail_b_160 = bool_j_1511;
                                bool_j_1512 = false;
                                rec_fail_b_159 = bool_j_1512;
                                bool_j_1513 = false;
                                rec_fail_b_158 = bool_j_1513;
                                var_j_1514 = expr_b_161;
                                m_match_bool_j_1516 = var_j_1514 ~ any;
                                m_match_bool_j_1519 = var_j_1514 ~ {bj_actual_rec, _};
                                m_match_cond_j_1520 = m_match_bool_j_1519 ? (
                                        var_j_1521 = expr_b_161;
                                        proj_j_1522 = var_j_1521.bj_decl_lbls;
                                        m_match_bool_j_1524 = proj_j_1522 ~ any;
                                        m_match_bool_j_1527 = proj_j_1522 ~ 
                                            {leaf, _};
                                        m_match_cond_j_1528 = m_match_bool_j_1527 ? (
                                                leaf_j_89 = proj_j_1522.leaf;
                                                var_j_1529 = expr_b_161;
                                                proj_j_1530 = var_j_1529.bj_actual_rec;
                                                m_match_bool_j_1532 = proj_j_1530 ~ any;
                                                m_match_bool_j_1535 = proj_j_1530 ~ 
                                                    {leaf, _};
                                                m_match_cond_j_1536 = m_match_bool_j_1535 ? (
                                                        leaf_j_88 = proj_j_1530.leaf;
                                                        bool_j_1537 = false;
                                                        fail_b_163 = bool_j_1537;
                                                        flatten_fun_j_1546 = fun expr_b_162 -> (
                                                            var_j_1538 = expr_b_162;
                                                            m_match_bool_j_1540 = var_j_1538 ~ any;
                                                            m_match_bool_j_1543 = var_j_1538 ~ bool;
                                                            m_match_cond_j_1544 = m_match_bool_j_1543 ? (
                                                                    bool_j_1545 = true
                                                                ) : (
                                                                    m_match_cond_j_1541 = m_match_bool_j_1540 ? (
                                                                        var_j_1542 = fail_b_163
                                                                    ) : (
                                                                        void_j_1539 = 
                                                                    {}
                                                                    )
                                                                ));
                                                        flatten_fun_j_1550 = fun bj_null_j_87 -> (
                                                            int_j_1547 = 0;
                                                            input_j_1548 = input;
                                                            m_bl_i_2937 = int_j_1547 ~ int;
                                                            m_br_i_2938 = input_j_1548 ~ int;
                                                            m_b_i_2939 = m_bl_i_2937 and m_br_i_2938;
                                                            binop_j_1549 = m_b_i_2939 ? (
                                                                    c_binop_i_2940 = int_j_1547 <= input_j_1548
                                                                ) : (
                                                                    ab_i_2941 = abort
                                                                ));
                                                        flatten_fun_j_1552 = fun expr_b_164 -> (
                                                            var_j_1551 = expr_b_164);
                                                        record_j_1553 = 
                                                            {checker = flatten_fun_j_1546, generator = flatten_fun_j_1550, wrapper = flatten_fun_j_1552};
                                                        proj_j_1554 = record_j_1553.checker;
                                                        var_j_1555 = leaf_j_88;
                                                        appl_j_1556 = proj_j_1554 var_j_1555
                                                    ) : (
                                                        m_match_cond_j_1533 = m_match_bool_j_1532 ? (
                                                                var_j_1534 = rec_fail_b_158
                                                            ) : (
                                                                void_j_1531 = 
                                                                    {}
                                                            )
                                                    )
                                            ) : (
                                                m_match_cond_j_1525 = m_match_bool_j_1524 ? (
                                                        var_j_1526 = rec_fail_b_159
                                                    ) : (
                                                        void_j_1523 = 
                                                            {}
                                                    )
                                            )
                                    ) : (
                                        m_match_cond_j_1517 = m_match_bool_j_1516 ? (
                                                var_j_1518 = rec_fail_b_160
                                            ) : (
                                                void_j_1515 = {}
                                            )
                                    ));
                            flatten_fun_j_1583 = fun bj_null_j_91 -> (
                                bool_j_1558 = false;
                                fail_b_156 = bool_j_1558;
                                flatten_fun_j_1567 = fun expr_b_155 -> (
                                    var_j_1559 = expr_b_155;
                                    m_match_bool_j_1561 = var_j_1559 ~ any;
                                    m_match_bool_j_1564 = var_j_1559 ~ bool;
                                    m_match_cond_j_1565 = m_match_bool_j_1564 ? (
                                            bool_j_1566 = true
                                        ) : (
                                            m_match_cond_j_1562 = m_match_bool_j_1561 ? (
                                                    var_j_1563 = fail_b_156
                                                ) : (
                                                    void_j_1560 = {}
                                                )
                                        ));
                                flatten_fun_j_1571 = fun bj_null_j_90 -> (
                                    int_j_1568 = 0;
                                    input_j_1569 = input;
                                    m_bl_i_2942 = int_j_1568 ~ int;
                                    m_br_i_2943 = input_j_1569 ~ int;
                                    m_b_i_2944 = m_bl_i_2942 and m_br_i_2943;
                                    binop_j_1570 = m_b_i_2944 ? (
                                            c_binop_i_2945 = int_j_1568 <= input_j_1569
                                        ) : (
                                            ab_i_2946 = abort
                                        ));
                                flatten_fun_j_1573 = fun expr_b_157 -> (
                                    var_j_1572 = expr_b_157);
                                record_j_1574 = {checker = flatten_fun_j_1567, generator = flatten_fun_j_1571, wrapper = flatten_fun_j_1573};
                                proj_j_1575 = record_j_1574.generator;
                                int_j_1576 = 0;
                                appl_j_1577 = proj_j_1575 int_j_1576;
                                leaf_b_154 = appl_j_1577;
                                var_j_1578 = leaf_b_154;
                                record_j_1579 = {leaf = var_j_1578};
                                record_j_1580 = {};
                                record_j_1581 = {leaf = record_j_1580};
                                record_j_1582 = {bj_actual_rec = record_j_1579, bj_decl_lbls = record_j_1581});
                            flatten_fun_j_1585 = fun expr_b_165 -> (
                                var_j_1584 = expr_b_165);
                            record_j_1586 = {checker = flatten_fun_j_1557, generator = flatten_fun_j_1583, wrapper = flatten_fun_j_1585};
                            proj_j_1587 = record_j_1586.checker;
                            var_j_1588 = expr_b_166;
                            appl_j_1589 = proj_j_1587 var_j_1588;
                            if_j_1822 = appl_j_1589 ? (
                                    bool_j_1590 = true
                                ) : (
                                    flatten_fun_j_1713 = fun expr_b_135 -> (
                                        bool_j_1591 = false;
                                        rec_fail_b_134 = bool_j_1591;
                                        bool_j_1592 = false;
                                        rec_fail_b_133 = bool_j_1592;
                                        bool_j_1593 = false;
                                        rec_fail_b_132 = bool_j_1593;
                                        var_j_1594 = expr_b_135;
                                        m_match_bool_j_1596 = var_j_1594 ~ any;
                                        m_match_bool_j_1599 = var_j_1594 ~ 
                                            {bj_actual_rec, _};
                                        m_match_cond_j_1600 = m_match_bool_j_1599 ? (
                                                var_j_1601 = expr_b_135;
                                                proj_j_1602 = var_j_1601.bj_decl_lbls;
                                                m_match_bool_j_1604 = proj_j_1602 ~ any;
                                                m_match_bool_j_1607 = proj_j_1602 ~ 
                                                    {height, item, left, right, _};
                                                m_match_cond_j_1608 = m_match_bool_j_1607 ? (
                                                        height_j_103 = proj_j_1602.height;
                                                        item_j_102 = proj_j_1602.item;
                                                        left_j_101 = proj_j_1602.left;
                                                        right_j_100 = proj_j_1602.right;
                                                        var_j_1609 = expr_b_135;
                                                        proj_j_1610 = var_j_1609.bj_actual_rec;
                                                        m_match_bool_j_1612 = proj_j_1610 ~ any;
                                                        m_match_bool_j_1615 = proj_j_1610 ~ 
                                                            {height, item, left, right, _};
                                                        m_match_cond_j_1616 = m_match_bool_j_1615 ? (
                                                                height_j_99 = proj_j_1610.height;
                                                                item_j_98 = proj_j_1610.item;
                                                                left_j_97 = proj_j_1610.left;
                                                                right_j_96 = proj_j_1610.right;
                                                                flatten_fun_j_1645 = fun expr_b_149 -> (
                                                                    bool_j_1617 = false;
                                                                    fail_b_147 = bool_j_1617;
                                                                    flatten_fun_j_1626 = fun expr_b_146 -> (
                                                                    var_j_1618 = expr_b_146;
                                                                    m_match_bool_j_1620 = var_j_1618 ~ any;
                                                                    m_match_bool_j_1623 = var_j_1618 ~ int;
                                                                    m_match_cond_j_1624 = m_match_bool_j_1623 ? (
                                                                        bool_j_1625 = true
                                                                    ) : (
                                                                        m_match_cond_j_1621 = m_match_bool_j_1620 ? (
                                                                        var_j_1622 = fail_b_147
                                                                    ) : (
                                                                        void_j_1619 = 
                                                                    {}
                                                                    )
                                                                    ));
                                                                    flatten_fun_j_1628 = fun bj_null_j_92 -> (
                                                                    input_j_1627 = input);
                                                                    flatten_fun_j_1630 = fun expr_b_148 -> (
                                                                    var_j_1629 = expr_b_148);
                                                                    record_j_1631 = 
                                                                    {checker = flatten_fun_j_1626, generator = flatten_fun_j_1628, wrapper = flatten_fun_j_1630};
                                                                    proj_j_1632 = record_j_1631.checker;
                                                                    var_j_1633 = expr_b_149;
                                                                    appl_j_1634 = proj_j_1632 var_j_1633;
                                                                    t_check_b_150 = appl_j_1634;
                                                                    var_j_1635 = t_check_b_150;
                                                                    if_j_1644 = var_j_1635 ? (
                                                                        bool_j_1636 = false;
                                                                    pred_check_b_151 = bool_j_1636;
                                                                    var_j_1637 = is_pos;
                                                                    var_j_1638 = expr_b_149;
                                                                    appl_j_1639 = var_j_1637 var_j_1638;
                                                                    if_j_1642 = appl_j_1639 ? (
                                                                        bool_j_1640 = true
                                                                    ) : (
                                                                        var_j_1641 = pred_check_b_151
                                                                    )
                                                                    ) : (
                                                                        var_j_1643 = t_check_b_150
                                                                    ));
                                                                flatten_fun_j_1671 = fun bj_null_j_94 -> (
                                                                    bool_j_1646 = false;
                                                                    fail_b_143 = bool_j_1646;
                                                                    flatten_fun_j_1655 = fun expr_b_142 -> (
                                                                    var_j_1647 = expr_b_142;
                                                                    m_match_bool_j_1649 = var_j_1647 ~ any;
                                                                    m_match_bool_j_1652 = var_j_1647 ~ int;
                                                                    m_match_cond_j_1653 = m_match_bool_j_1652 ? (
                                                                        bool_j_1654 = true
                                                                    ) : (
                                                                        m_match_cond_j_1650 = m_match_bool_j_1649 ? (
                                                                        var_j_1651 = fail_b_143
                                                                    ) : (
                                                                        void_j_1648 = 
                                                                    {}
                                                                    )
                                                                    ));
                                                                    flatten_fun_j_1657 = fun bj_null_j_93 -> (
                                                                    input_j_1656 = input);
                                                                    flatten_fun_j_1659 = fun expr_b_144 -> (
                                                                    var_j_1658 = expr_b_144);
                                                                    record_j_1660 = 
                                                                    {checker = flatten_fun_j_1655, generator = flatten_fun_j_1657, wrapper = flatten_fun_j_1659};
                                                                    proj_j_1661 = record_j_1660.generator;
                                                                    int_j_1662 = 0;
                                                                    appl_j_1663 = proj_j_1661 int_j_1662;
                                                                    candidate_b_145 = appl_j_1663;
                                                                    var_j_1664 = is_pos;
                                                                    var_j_1665 = candidate_b_145;
                                                                    appl_j_1666 = var_j_1664 var_j_1665;
                                                                    if_j_1670 = appl_j_1666 ? (
                                                                        var_j_1667 = candidate_b_145
                                                                    ) : (
                                                                        bool_j_1668 = false;
                                                                    assume_j_1669 = assume bool_j_1668
                                                                    ));
                                                                flatten_fun_j_1673 = fun expr_b_152 -> (
                                                                    var_j_1672 = expr_b_152);
                                                                record_j_1674 = 
                                                                    {checker = flatten_fun_j_1645, generator = flatten_fun_j_1671, wrapper = flatten_fun_j_1673};
                                                                proj_j_1675 = record_j_1674.checker;
                                                                var_j_1676 = height_j_99;
                                                                appl_j_1677 = proj_j_1675 var_j_1676;
                                                                lbl_check_b_141 = appl_j_1677;
                                                                var_j_1678 = lbl_check_b_141;
                                                                if_j_1712 = var_j_1678 ? (
                                                                        
                                                                    bool_j_1679 = false;
                                                                    fail_b_139 = bool_j_1679;
                                                                    flatten_fun_j_1688 = fun expr_b_138 -> (
                                                                    var_j_1680 = expr_b_138;
                                                                    m_match_bool_j_1682 = var_j_1680 ~ any;
                                                                    m_match_bool_j_1685 = var_j_1680 ~ int;
                                                                    m_match_cond_j_1686 = m_match_bool_j_1685 ? (
                                                                        bool_j_1687 = true
                                                                    ) : (
                                                                        m_match_cond_j_1683 = m_match_bool_j_1682 ? (
                                                                        var_j_1684 = fail_b_139
                                                                    ) : (
                                                                        void_j_1681 = 
                                                                    {}
                                                                    )
                                                                    ));
                                                                    flatten_fun_j_1690 = fun bj_null_j_95 -> (
                                                                    input_j_1689 = input);
                                                                    flatten_fun_j_1692 = fun expr_b_140 -> (
                                                                    var_j_1691 = expr_b_140);
                                                                    record_j_1693 = 
                                                                    {checker = flatten_fun_j_1688, generator = flatten_fun_j_1690, wrapper = flatten_fun_j_1692};
                                                                    proj_j_1694 = record_j_1693.checker;
                                                                    var_j_1695 = item_j_98;
                                                                    appl_j_1696 = proj_j_1694 var_j_1695;
                                                                    lbl_check_b_137 = appl_j_1696;
                                                                    var_j_1697 = lbl_check_b_137;
                                                                    if_j_1710 = var_j_1697 ? (
                                                                        var_j_1698 = tt_j_132;
                                                                    proj_j_1699 = var_j_1698.checker;
                                                                    var_j_1700 = left_j_97;
                                                                    appl_j_1701 = proj_j_1699 var_j_1700;
                                                                    lbl_check_b_136 = appl_j_1701;
                                                                    var_j_1702 = lbl_check_b_136;
                                                                    if_j_1708 = var_j_1702 ? (
                                                                        var_j_1703 = tt_j_132;
                                                                    proj_j_1704 = var_j_1703.checker;
                                                                    var_j_1705 = right_j_96;
                                                                    appl_j_1706 = proj_j_1704 var_j_1705
                                                                    ) : (
                                                                        var_j_1707 = lbl_check_b_136
                                                                    )
                                                                    ) : (
                                                                        var_j_1709 = lbl_check_b_137
                                                                    )
                                                                    ) : (
                                                                        
                                                                    var_j_1711 = lbl_check_b_141
                                                                    )
                                                            ) : (
                                                                m_match_cond_j_1613 = m_match_bool_j_1612 ? (
                                                                        
                                                                    var_j_1614 = rec_fail_b_132
                                                                    ) : (
                                                                        
                                                                    void_j_1611 = 
                                                                    {}
                                                                    )
                                                            )
                                                    ) : (
                                                        m_match_cond_j_1605 = m_match_bool_j_1604 ? (
                                                                var_j_1606 = rec_fail_b_133
                                                            ) : (
                                                                void_j_1603 = 
                                                                    {}
                                                            )
                                                    )
                                            ) : (
                                                m_match_cond_j_1597 = m_match_bool_j_1596 ? (
                                                        var_j_1598 = rec_fail_b_134
                                                    ) : (
                                                        void_j_1595 = 
                                                            {}
                                                    )
                                            ));
                                    flatten_fun_j_1812 = fun bj_null_j_108 -> (
                                        var_j_1714 = tt_j_132;
                                        proj_j_1715 = var_j_1714.generator;
                                        int_j_1716 = 0;
                                        appl_j_1717 = proj_j_1715 int_j_1716;
                                        right_b_117 = appl_j_1717;
                                        var_j_1718 = tt_j_132;
                                        proj_j_1719 = var_j_1718.generator;
                                        int_j_1720 = 0;
                                        appl_j_1721 = proj_j_1719 int_j_1720;
                                        left_b_116 = appl_j_1721;
                                        bool_j_1722 = false;
                                        fail_b_130 = bool_j_1722;
                                        flatten_fun_j_1731 = fun expr_b_129 -> (
                                            var_j_1723 = expr_b_129;
                                            m_match_bool_j_1725 = var_j_1723 ~ any;
                                            m_match_bool_j_1728 = var_j_1723 ~ int;
                                            m_match_cond_j_1729 = m_match_bool_j_1728 ? (
                                                    bool_j_1730 = true
                                                ) : (
                                                    m_match_cond_j_1726 = m_match_bool_j_1725 ? (
                                                            var_j_1727 = fail_b_130
                                                        ) : (
                                                            void_j_1724 = 
                                                                {}
                                                        )
                                                ));
                                        flatten_fun_j_1733 = fun bj_null_j_104 -> (
                                            input_j_1732 = input);
                                        flatten_fun_j_1735 = fun expr_b_131 -> (
                                            var_j_1734 = expr_b_131);
                                        record_j_1736 = {checker = flatten_fun_j_1731, generator = flatten_fun_j_1733, wrapper = flatten_fun_j_1735};
                                        proj_j_1737 = record_j_1736.generator;
                                        int_j_1738 = 0;
                                        appl_j_1739 = proj_j_1737 int_j_1738;
                                        item_b_115 = appl_j_1739;
                                        flatten_fun_j_1768 = fun expr_b_125 -> (
                                            bool_j_1740 = false;
                                            fail_b_123 = bool_j_1740;
                                            flatten_fun_j_1749 = fun expr_b_122 -> (
                                                var_j_1741 = expr_b_122;
                                                m_match_bool_j_1743 = var_j_1741 ~ any;
                                                m_match_bool_j_1746 = var_j_1741 ~ int;
                                                m_match_cond_j_1747 = m_match_bool_j_1746 ? (
                                                        bool_j_1748 = true
                                                    ) : (
                                                        m_match_cond_j_1744 = m_match_bool_j_1743 ? (
                                                                var_j_1745 = fail_b_123
                                                            ) : (
                                                                void_j_1742 = 
                                                                    {}
                                                            )
                                                    ));
                                            flatten_fun_j_1751 = fun bj_null_j_105 -> (
                                                input_j_1750 = input);
                                            flatten_fun_j_1753 = fun expr_b_124 -> (
                                                var_j_1752 = expr_b_124);
                                            record_j_1754 = {checker = flatten_fun_j_1749, generator = flatten_fun_j_1751, wrapper = flatten_fun_j_1753};
                                            proj_j_1755 = record_j_1754.checker;
                                            var_j_1756 = expr_b_125;
                                            appl_j_1757 = proj_j_1755 var_j_1756;
                                            t_check_b_126 = appl_j_1757;
                                            var_j_1758 = t_check_b_126;
                                            if_j_1767 = var_j_1758 ? (
                                                    bool_j_1759 = false;
                                                    pred_check_b_127 = bool_j_1759;
                                                    var_j_1760 = is_pos;
                                                    var_j_1761 = expr_b_125;
                                                    appl_j_1762 = var_j_1760 var_j_1761;
                                                    if_j_1765 = appl_j_1762 ? (
                                                            bool_j_1763 = true
                                                        ) : (
                                                            var_j_1764 = pred_check_b_127
                                                        )
                                                ) : (
                                                    var_j_1766 = t_check_b_126
                                                ));
                                        flatten_fun_j_1794 = fun bj_null_j_107 -> (
                                            bool_j_1769 = false;
                                            fail_b_119 = bool_j_1769;
                                            flatten_fun_j_1778 = fun expr_b_118 -> (
                                                var_j_1770 = expr_b_118;
                                                m_match_bool_j_1772 = var_j_1770 ~ any;
                                                m_match_bool_j_1775 = var_j_1770 ~ int;
                                                m_match_cond_j_1776 = m_match_bool_j_1775 ? (
                                                        bool_j_1777 = true
                                                    ) : (
                                                        m_match_cond_j_1773 = m_match_bool_j_1772 ? (
                                                                var_j_1774 = fail_b_119
                                                            ) : (
                                                                void_j_1771 = 
                                                                    {}
                                                            )
                                                    ));
                                            flatten_fun_j_1780 = fun bj_null_j_106 -> (
                                                input_j_1779 = input);
                                            flatten_fun_j_1782 = fun expr_b_120 -> (
                                                var_j_1781 = expr_b_120);
                                            record_j_1783 = {checker = flatten_fun_j_1778, generator = flatten_fun_j_1780, wrapper = flatten_fun_j_1782};
                                            proj_j_1784 = record_j_1783.generator;
                                            int_j_1785 = 0;
                                            appl_j_1786 = proj_j_1784 int_j_1785;
                                            candidate_b_121 = appl_j_1786;
                                            var_j_1787 = is_pos;
                                            var_j_1788 = candidate_b_121;
                                            appl_j_1789 = var_j_1787 var_j_1788;
                                            if_j_1793 = appl_j_1789 ? (
                                                    var_j_1790 = candidate_b_121
                                                ) : (
                                                    bool_j_1791 = false;
                                                    assume_j_1792 = assume bool_j_1791
                                                ));
                                        flatten_fun_j_1796 = fun expr_b_128 -> (
                                            var_j_1795 = expr_b_128);
                                        record_j_1797 = {checker = flatten_fun_j_1768, generator = flatten_fun_j_1794, wrapper = flatten_fun_j_1796};
                                        proj_j_1798 = record_j_1797.generator;
                                        int_j_1799 = 0;
                                        appl_j_1800 = proj_j_1798 int_j_1799;
                                        height_b_114 = appl_j_1800;
                                        var_j_1801 = height_b_114;
                                        var_j_1802 = item_b_115;
                                        var_j_1803 = left_b_116;
                                        var_j_1804 = right_b_117;
                                        record_j_1805 = {height = var_j_1801, item = var_j_1802, left = var_j_1803, right = var_j_1804};
                                        record_j_1806 = {};
                                        record_j_1807 = {};
                                        record_j_1808 = {};
                                        record_j_1809 = {};
                                        record_j_1810 = {height = record_j_1806, item = record_j_1807, left = record_j_1808, right = record_j_1809};
                                        record_j_1811 = {bj_actual_rec = record_j_1805, bj_decl_lbls = record_j_1810});
                                    flatten_fun_j_1814 = fun expr_b_153 -> (
                                        var_j_1813 = expr_b_153);
                                    record_j_1815 = {checker = flatten_fun_j_1713, generator = flatten_fun_j_1812, wrapper = flatten_fun_j_1814};
                                    proj_j_1816 = record_j_1815.checker;
                                    var_j_1817 = expr_b_166;
                                    appl_j_1818 = proj_j_1816 var_j_1817;
                                    if_j_1821 = appl_j_1818 ? (
                                            bool_j_1819 = true
                                        ) : (
                                            var_j_1820 = fail_b_168
                                        )
                                )
                        ));
                flatten_fun_j_2137 = fun bj_null_j_131 -> (
                    input_j_1825 = input;
                    select_int_b_61 = input_j_1825;
                    int_j_1826 = 0;
                    var_j_1827 = select_int_b_61;
                    binop_j_1828 = int_j_1826 <= var_j_1827;
                    if_j_2136 = binop_j_1828 ? (
                            flatten_fun_j_1951 = fun expr_b_30 -> (
                                bool_j_1829 = false;
                                rec_fail_b_29 = bool_j_1829;
                                bool_j_1830 = false;
                                rec_fail_b_28 = bool_j_1830;
                                bool_j_1831 = false;
                                rec_fail_b_27 = bool_j_1831;
                                var_j_1832 = expr_b_30;
                                m_match_bool_j_1834 = var_j_1832 ~ any;
                                m_match_bool_j_1837 = var_j_1832 ~ {bj_actual_rec, _};
                                m_match_cond_j_1838 = m_match_bool_j_1837 ? (
                                        var_j_1839 = expr_b_30;
                                        proj_j_1840 = var_j_1839.bj_decl_lbls;
                                        m_match_bool_j_1842 = proj_j_1840 ~ any;
                                        m_match_bool_j_1845 = proj_j_1840 ~ 
                                            {height, item, left, right, _};
                                        m_match_cond_j_1846 = m_match_bool_j_1845 ? (
                                                height_j_120 = proj_j_1840.height;
                                                item_j_119 = proj_j_1840.item;
                                                left_j_118 = proj_j_1840.left;
                                                right_j_117 = proj_j_1840.right;
                                                var_j_1847 = expr_b_30;
                                                proj_j_1848 = var_j_1847.bj_actual_rec;
                                                m_match_bool_j_1850 = proj_j_1848 ~ any;
                                                m_match_bool_j_1853 = proj_j_1848 ~ 
                                                    {height, item, left, right, _};
                                                m_match_cond_j_1854 = m_match_bool_j_1853 ? (
                                                        height_j_116 = proj_j_1848.height;
                                                        item_j_115 = proj_j_1848.item;
                                                        left_j_114 = proj_j_1848.left;
                                                        right_j_113 = proj_j_1848.right;
                                                        flatten_fun_j_1883 = fun expr_b_44 -> (
                                                            bool_j_1855 = false;
                                                            fail_b_42 = bool_j_1855;
                                                            flatten_fun_j_1864 = fun expr_b_41 -> (
                                                                var_j_1856 = expr_b_41;
                                                                m_match_bool_j_1858 = var_j_1856 ~ any;
                                                                m_match_bool_j_1861 = var_j_1856 ~ int;
                                                                m_match_cond_j_1862 = m_match_bool_j_1861 ? (
                                                                        
                                                                    bool_j_1863 = true
                                                                    ) : (
                                                                        
                                                                    m_match_cond_j_1859 = m_match_bool_j_1858 ? (
                                                                        var_j_1860 = fail_b_42
                                                                    ) : (
                                                                        void_j_1857 = 
                                                                    {}
                                                                    )
                                                                    ));
                                                            flatten_fun_j_1866 = fun bj_null_j_109 -> (
                                                                input_j_1865 = input);
                                                            flatten_fun_j_1868 = fun expr_b_43 -> (
                                                                var_j_1867 = expr_b_43);
                                                            record_j_1869 = 
                                                                {checker = flatten_fun_j_1864, generator = flatten_fun_j_1866, wrapper = flatten_fun_j_1868};
                                                            proj_j_1870 = record_j_1869.checker;
                                                            var_j_1871 = expr_b_44;
                                                            appl_j_1872 = proj_j_1870 var_j_1871;
                                                            t_check_b_45 = appl_j_1872;
                                                            var_j_1873 = t_check_b_45;
                                                            if_j_1882 = var_j_1873 ? (
                                                                    bool_j_1874 = false;
                                                                    pred_check_b_46 = bool_j_1874;
                                                                    var_j_1875 = is_pos;
                                                                    var_j_1876 = expr_b_44;
                                                                    appl_j_1877 = var_j_1875 var_j_1876;
                                                                    if_j_1880 = appl_j_1877 ? (
                                                                        bool_j_1878 = true
                                                                    ) : (
                                                                        var_j_1879 = pred_check_b_46
                                                                    )
                                                                ) : (
                                                                    var_j_1881 = t_check_b_45
                                                                ));
                                                        flatten_fun_j_1909 = fun bj_null_j_111 -> (
                                                            bool_j_1884 = false;
                                                            fail_b_38 = bool_j_1884;
                                                            flatten_fun_j_1893 = fun expr_b_37 -> (
                                                                var_j_1885 = expr_b_37;
                                                                m_match_bool_j_1887 = var_j_1885 ~ any;
                                                                m_match_bool_j_1890 = var_j_1885 ~ int;
                                                                m_match_cond_j_1891 = m_match_bool_j_1890 ? (
                                                                        
                                                                    bool_j_1892 = true
                                                                    ) : (
                                                                        
                                                                    m_match_cond_j_1888 = m_match_bool_j_1887 ? (
                                                                        var_j_1889 = fail_b_38
                                                                    ) : (
                                                                        void_j_1886 = 
                                                                    {}
                                                                    )
                                                                    ));
                                                            flatten_fun_j_1895 = fun bj_null_j_110 -> (
                                                                input_j_1894 = input);
                                                            flatten_fun_j_1897 = fun expr_b_39 -> (
                                                                var_j_1896 = expr_b_39);
                                                            record_j_1898 = 
                                                                {checker = flatten_fun_j_1893, generator = flatten_fun_j_1895, wrapper = flatten_fun_j_1897};
                                                            proj_j_1899 = record_j_1898.generator;
                                                            int_j_1900 = 0;
                                                            appl_j_1901 = proj_j_1899 int_j_1900;
                                                            candidate_b_40 = appl_j_1901;
                                                            var_j_1902 = is_pos;
                                                            var_j_1903 = candidate_b_40;
                                                            appl_j_1904 = var_j_1902 var_j_1903;
                                                            if_j_1908 = appl_j_1904 ? (
                                                                    var_j_1905 = candidate_b_40
                                                                ) : (
                                                                    bool_j_1906 = false;
                                                                    assume_j_1907 = assume bool_j_1906
                                                                ));
                                                        flatten_fun_j_1911 = fun expr_b_47 -> (
                                                            var_j_1910 = expr_b_47);
                                                        record_j_1912 = 
                                                            {checker = flatten_fun_j_1883, generator = flatten_fun_j_1909, wrapper = flatten_fun_j_1911};
                                                        proj_j_1913 = record_j_1912.checker;
                                                        var_j_1914 = height_j_116;
                                                        appl_j_1915 = proj_j_1913 var_j_1914;
                                                        lbl_check_b_36 = appl_j_1915;
                                                        var_j_1916 = lbl_check_b_36;
                                                        if_j_1950 = var_j_1916 ? (
                                                                bool_j_1917 = false;
                                                                fail_b_34 = bool_j_1917;
                                                                flatten_fun_j_1926 = fun expr_b_33 -> (
                                                                    var_j_1918 = expr_b_33;
                                                                    m_match_bool_j_1920 = var_j_1918 ~ any;
                                                                    m_match_bool_j_1923 = var_j_1918 ~ int;
                                                                    m_match_cond_j_1924 = m_match_bool_j_1923 ? (
                                                                        bool_j_1925 = true
                                                                    ) : (
                                                                        m_match_cond_j_1921 = m_match_bool_j_1920 ? (
                                                                        var_j_1922 = fail_b_34
                                                                    ) : (
                                                                        void_j_1919 = 
                                                                    {}
                                                                    )
                                                                    ));
                                                                flatten_fun_j_1928 = fun bj_null_j_112 -> (
                                                                    input_j_1927 = input);
                                                                flatten_fun_j_1930 = fun expr_b_35 -> (
                                                                    var_j_1929 = expr_b_35);
                                                                record_j_1931 = 
                                                                    {checker = flatten_fun_j_1926, generator = flatten_fun_j_1928, wrapper = flatten_fun_j_1930};
                                                                proj_j_1932 = record_j_1931.checker;
                                                                var_j_1933 = item_j_115;
                                                                appl_j_1934 = proj_j_1932 var_j_1933;
                                                                lbl_check_b_32 = appl_j_1934;
                                                                var_j_1935 = lbl_check_b_32;
                                                                if_j_1948 = var_j_1935 ? (
                                                                        
                                                                    var_j_1936 = tt_j_132;
                                                                    proj_j_1937 = var_j_1936.checker;
                                                                    var_j_1938 = left_j_114;
                                                                    appl_j_1939 = proj_j_1937 var_j_1938;
                                                                    lbl_check_b_31 = appl_j_1939;
                                                                    var_j_1940 = lbl_check_b_31;
                                                                    if_j_1946 = var_j_1940 ? (
                                                                        var_j_1941 = tt_j_132;
                                                                    proj_j_1942 = var_j_1941.checker;
                                                                    var_j_1943 = right_j_113;
                                                                    appl_j_1944 = proj_j_1942 var_j_1943
                                                                    ) : (
                                                                        var_j_1945 = lbl_check_b_31
                                                                    )
                                                                    ) : (
                                                                        
                                                                    var_j_1947 = lbl_check_b_32
                                                                    )
                                                            ) : (
                                                                var_j_1949 = lbl_check_b_36
                                                            )
                                                    ) : (
                                                        m_match_cond_j_1851 = m_match_bool_j_1850 ? (
                                                                var_j_1852 = rec_fail_b_27
                                                            ) : (
                                                                void_j_1849 = 
                                                                    {}
                                                            )
                                                    )
                                            ) : (
                                                m_match_cond_j_1843 = m_match_bool_j_1842 ? (
                                                        var_j_1844 = rec_fail_b_28
                                                    ) : (
                                                        void_j_1841 = 
                                                            {}
                                                    )
                                            )
                                    ) : (
                                        m_match_cond_j_1835 = m_match_bool_j_1834 ? (
                                                var_j_1836 = rec_fail_b_29
                                            ) : (
                                                void_j_1833 = {}
                                            )
                                    ));
                            flatten_fun_j_2050 = fun bj_null_j_125 -> (
                                var_j_1952 = tt_j_132;
                                proj_j_1953 = var_j_1952.generator;
                                int_j_1954 = 0;
                                appl_j_1955 = proj_j_1953 int_j_1954;
                                right_b_12 = appl_j_1955;
                                var_j_1956 = tt_j_132;
                                proj_j_1957 = var_j_1956.generator;
                                int_j_1958 = 0;
                                appl_j_1959 = proj_j_1957 int_j_1958;
                                left_b_11 = appl_j_1959;
                                bool_j_1960 = false;
                                fail_b_25 = bool_j_1960;
                                flatten_fun_j_1969 = fun expr_b_24 -> (
                                    var_j_1961 = expr_b_24;
                                    m_match_bool_j_1963 = var_j_1961 ~ any;
                                    m_match_bool_j_1966 = var_j_1961 ~ int;
                                    m_match_cond_j_1967 = m_match_bool_j_1966 ? (
                                            bool_j_1968 = true
                                        ) : (
                                            m_match_cond_j_1964 = m_match_bool_j_1963 ? (
                                                    var_j_1965 = fail_b_25
                                                ) : (
                                                    void_j_1962 = {}
                                                )
                                        ));
                                flatten_fun_j_1971 = fun bj_null_j_121 -> (
                                    input_j_1970 = input);
                                flatten_fun_j_1973 = fun expr_b_26 -> (
                                    var_j_1972 = expr_b_26);
                                record_j_1974 = {checker = flatten_fun_j_1969, generator = flatten_fun_j_1971, wrapper = flatten_fun_j_1973};
                                proj_j_1975 = record_j_1974.generator;
                                int_j_1976 = 0;
                                appl_j_1977 = proj_j_1975 int_j_1976;
                                item_b_10 = appl_j_1977;
                                flatten_fun_j_2006 = fun expr_b_20 -> (
                                    bool_j_1978 = false;
                                    fail_b_18 = bool_j_1978;
                                    flatten_fun_j_1987 = fun expr_b_17 -> (
                                        var_j_1979 = expr_b_17;
                                        m_match_bool_j_1981 = var_j_1979 ~ any;
                                        m_match_bool_j_1984 = var_j_1979 ~ int;
                                        m_match_cond_j_1985 = m_match_bool_j_1984 ? (
                                                bool_j_1986 = true
                                            ) : (
                                                m_match_cond_j_1982 = m_match_bool_j_1981 ? (
                                                        var_j_1983 = fail_b_18
                                                    ) : (
                                                        void_j_1980 = 
                                                            {}
                                                    )
                                            ));
                                    flatten_fun_j_1989 = fun bj_null_j_122 -> (
                                        input_j_1988 = input);
                                    flatten_fun_j_1991 = fun expr_b_19 -> (
                                        var_j_1990 = expr_b_19);
                                    record_j_1992 = {checker = flatten_fun_j_1987, generator = flatten_fun_j_1989, wrapper = flatten_fun_j_1991};
                                    proj_j_1993 = record_j_1992.checker;
                                    var_j_1994 = expr_b_20;
                                    appl_j_1995 = proj_j_1993 var_j_1994;
                                    t_check_b_21 = appl_j_1995;
                                    var_j_1996 = t_check_b_21;
                                    if_j_2005 = var_j_1996 ? (
                                            bool_j_1997 = false;
                                            pred_check_b_22 = bool_j_1997;
                                            var_j_1998 = is_pos;
                                            var_j_1999 = expr_b_20;
                                            appl_j_2000 = var_j_1998 var_j_1999;
                                            if_j_2003 = appl_j_2000 ? (
                                                    bool_j_2001 = true
                                                ) : (
                                                    var_j_2002 = pred_check_b_22
                                                )
                                        ) : (
                                            var_j_2004 = t_check_b_21
                                        ));
                                flatten_fun_j_2032 = fun bj_null_j_124 -> (
                                    bool_j_2007 = false;
                                    fail_b_14 = bool_j_2007;
                                    flatten_fun_j_2016 = fun expr_b_13 -> (
                                        var_j_2008 = expr_b_13;
                                        m_match_bool_j_2010 = var_j_2008 ~ any;
                                        m_match_bool_j_2013 = var_j_2008 ~ int;
                                        m_match_cond_j_2014 = m_match_bool_j_2013 ? (
                                                bool_j_2015 = true
                                            ) : (
                                                m_match_cond_j_2011 = m_match_bool_j_2010 ? (
                                                        var_j_2012 = fail_b_14
                                                    ) : (
                                                        void_j_2009 = 
                                                            {}
                                                    )
                                            ));
                                    flatten_fun_j_2018 = fun bj_null_j_123 -> (
                                        input_j_2017 = input);
                                    flatten_fun_j_2020 = fun expr_b_15 -> (
                                        var_j_2019 = expr_b_15);
                                    record_j_2021 = {checker = flatten_fun_j_2016, generator = flatten_fun_j_2018, wrapper = flatten_fun_j_2020};
                                    proj_j_2022 = record_j_2021.generator;
                                    int_j_2023 = 0;
                                    appl_j_2024 = proj_j_2022 int_j_2023;
                                    candidate_b_16 = appl_j_2024;
                                    var_j_2025 = is_pos;
                                    var_j_2026 = candidate_b_16;
                                    appl_j_2027 = var_j_2025 var_j_2026;
                                    if_j_2031 = appl_j_2027 ? (
                                            var_j_2028 = candidate_b_16
                                        ) : (
                                            bool_j_2029 = false;
                                            assume_j_2030 = assume bool_j_2029
                                        ));
                                flatten_fun_j_2034 = fun expr_b_23 -> (
                                    var_j_2033 = expr_b_23);
                                record_j_2035 = {checker = flatten_fun_j_2006, generator = flatten_fun_j_2032, wrapper = flatten_fun_j_2034};
                                proj_j_2036 = record_j_2035.generator;
                                int_j_2037 = 0;
                                appl_j_2038 = proj_j_2036 int_j_2037;
                                height_b_9 = appl_j_2038;
                                var_j_2039 = height_b_9;
                                var_j_2040 = item_b_10;
                                var_j_2041 = left_b_11;
                                var_j_2042 = right_b_12;
                                record_j_2043 = {height = var_j_2039, item = var_j_2040, left = var_j_2041, right = var_j_2042};
                                record_j_2044 = {};
                                record_j_2045 = {};
                                record_j_2046 = {};
                                record_j_2047 = {};
                                record_j_2048 = {height = record_j_2044, item = record_j_2045, left = record_j_2046, right = record_j_2047};
                                record_j_2049 = {bj_actual_rec = record_j_2043, bj_decl_lbls = record_j_2048});
                            flatten_fun_j_2052 = fun expr_b_48 -> (
                                var_j_2051 = expr_b_48);
                            record_j_2053 = {checker = flatten_fun_j_1951, generator = flatten_fun_j_2050, wrapper = flatten_fun_j_2052};
                            proj_j_2054 = record_j_2053.generator;
                            int_j_2055 = 0;
                            appl_j_2056 = proj_j_2054 int_j_2055
                        ) : (
                            flatten_fun_j_2103 = fun expr_b_56 -> (
                                bool_j_2057 = false;
                                rec_fail_b_55 = bool_j_2057;
                                bool_j_2058 = false;
                                rec_fail_b_54 = bool_j_2058;
                                bool_j_2059 = false;
                                rec_fail_b_53 = bool_j_2059;
                                var_j_2060 = expr_b_56;
                                m_match_bool_j_2062 = var_j_2060 ~ any;
                                m_match_bool_j_2065 = var_j_2060 ~ {bj_actual_rec, _};
                                m_match_cond_j_2066 = m_match_bool_j_2065 ? (
                                        var_j_2067 = expr_b_56;
                                        proj_j_2068 = var_j_2067.bj_decl_lbls;
                                        m_match_bool_j_2070 = proj_j_2068 ~ any;
                                        m_match_bool_j_2073 = proj_j_2068 ~ 
                                            {leaf, _};
                                        m_match_cond_j_2074 = m_match_bool_j_2073 ? (
                                                leaf_j_128 = proj_j_2068.leaf;
                                                var_j_2075 = expr_b_56;
                                                proj_j_2076 = var_j_2075.bj_actual_rec;
                                                m_match_bool_j_2078 = proj_j_2076 ~ any;
                                                m_match_bool_j_2081 = proj_j_2076 ~ 
                                                    {leaf, _};
                                                m_match_cond_j_2082 = m_match_bool_j_2081 ? (
                                                        leaf_j_127 = proj_j_2076.leaf;
                                                        bool_j_2083 = false;
                                                        fail_b_58 = bool_j_2083;
                                                        flatten_fun_j_2092 = fun expr_b_57 -> (
                                                            var_j_2084 = expr_b_57;
                                                            m_match_bool_j_2086 = var_j_2084 ~ any;
                                                            m_match_bool_j_2089 = var_j_2084 ~ bool;
                                                            m_match_cond_j_2090 = m_match_bool_j_2089 ? (
                                                                    bool_j_2091 = true
                                                                ) : (
                                                                    m_match_cond_j_2087 = m_match_bool_j_2086 ? (
                                                                        var_j_2088 = fail_b_58
                                                                    ) : (
                                                                        void_j_2085 = 
                                                                    {}
                                                                    )
                                                                ));
                                                        flatten_fun_j_2096 = fun bj_null_j_126 -> (
                                                            int_j_2093 = 0;
                                                            input_j_2094 = input;
                                                            m_bl_i_2947 = int_j_2093 ~ int;
                                                            m_br_i_2948 = input_j_2094 ~ int;
                                                            m_b_i_2949 = m_bl_i_2947 and m_br_i_2948;
                                                            binop_j_2095 = m_b_i_2949 ? (
                                                                    c_binop_i_2950 = int_j_2093 <= input_j_2094
                                                                ) : (
                                                                    ab_i_2951 = abort
                                                                ));
                                                        flatten_fun_j_2098 = fun expr_b_59 -> (
                                                            var_j_2097 = expr_b_59);
                                                        record_j_2099 = 
                                                            {checker = flatten_fun_j_2092, generator = flatten_fun_j_2096, wrapper = flatten_fun_j_2098};
                                                        proj_j_2100 = record_j_2099.checker;
                                                        var_j_2101 = leaf_j_127;
                                                        appl_j_2102 = proj_j_2100 var_j_2101
                                                    ) : (
                                                        m_match_cond_j_2079 = m_match_bool_j_2078 ? (
                                                                var_j_2080 = rec_fail_b_53
                                                            ) : (
                                                                void_j_2077 = 
                                                                    {}
                                                            )
                                                    )
                                            ) : (
                                                m_match_cond_j_2071 = m_match_bool_j_2070 ? (
                                                        var_j_2072 = rec_fail_b_54
                                                    ) : (
                                                        void_j_2069 = 
                                                            {}
                                                    )
                                            )
                                    ) : (
                                        m_match_cond_j_2063 = m_match_bool_j_2062 ? (
                                                var_j_2064 = rec_fail_b_55
                                            ) : (
                                                void_j_2061 = {}
                                            )
                                    ));
                            flatten_fun_j_2129 = fun bj_null_j_130 -> (
                                bool_j_2104 = false;
                                fail_b_51 = bool_j_2104;
                                flatten_fun_j_2113 = fun expr_b_50 -> (
                                    var_j_2105 = expr_b_50;
                                    m_match_bool_j_2107 = var_j_2105 ~ any;
                                    m_match_bool_j_2110 = var_j_2105 ~ bool;
                                    m_match_cond_j_2111 = m_match_bool_j_2110 ? (
                                            bool_j_2112 = true
                                        ) : (
                                            m_match_cond_j_2108 = m_match_bool_j_2107 ? (
                                                    var_j_2109 = fail_b_51
                                                ) : (
                                                    void_j_2106 = {}
                                                )
                                        ));
                                flatten_fun_j_2117 = fun bj_null_j_129 -> (
                                    int_j_2114 = 0;
                                    input_j_2115 = input;
                                    m_bl_i_2952 = int_j_2114 ~ int;
                                    m_br_i_2953 = input_j_2115 ~ int;
                                    m_b_i_2954 = m_bl_i_2952 and m_br_i_2953;
                                    binop_j_2116 = m_b_i_2954 ? (
                                            c_binop_i_2955 = int_j_2114 <= input_j_2115
                                        ) : (
                                            ab_i_2956 = abort
                                        ));
                                flatten_fun_j_2119 = fun expr_b_52 -> (
                                    var_j_2118 = expr_b_52);
                                record_j_2120 = {checker = flatten_fun_j_2113, generator = flatten_fun_j_2117, wrapper = flatten_fun_j_2119};
                                proj_j_2121 = record_j_2120.generator;
                                int_j_2122 = 0;
                                appl_j_2123 = proj_j_2121 int_j_2122;
                                leaf_b_49 = appl_j_2123;
                                var_j_2124 = leaf_b_49;
                                record_j_2125 = {leaf = var_j_2124};
                                record_j_2126 = {};
                                record_j_2127 = {leaf = record_j_2126};
                                record_j_2128 = {bj_actual_rec = record_j_2125, bj_decl_lbls = record_j_2127});
                            flatten_fun_j_2131 = fun expr_b_60 -> (
                                var_j_2130 = expr_b_60);
                            record_j_2132 = {checker = flatten_fun_j_2103, generator = flatten_fun_j_2129, wrapper = flatten_fun_j_2131};
                            proj_j_2133 = record_j_2132.generator;
                            int_j_2134 = 0;
                            appl_j_2135 = proj_j_2133 int_j_2134
                        ));
                flatten_fun_j_2139 = fun expr_b_169 -> (
                    var_j_2138 = expr_b_169);
                record_j_2140 = {checker = flatten_fun_j_1824, generator = flatten_fun_j_2137, wrapper = flatten_fun_j_2139};
                proj_j_2141 = record_j_2140.generator;
                int_j_2142 = 0;
                appl_j_2143 = proj_j_2141 int_j_2142);
            var_j_2145 = self_b_4;
            int_j_2146 = 0;
            appl_j_2147 = var_j_2145 int_j_2146;
            appl_j_2148 = flatten_fun_j_2144 appl_j_2147);
        flatten_fun_j_2151 = fun expr_b_332 -> (
            var_j_2150 = expr_b_332);
        record_j_2152 = {checker = flatten_fun_j_1193, generator = flatten_fun_j_2149, wrapper = flatten_fun_j_2151}));
appl_j_2155 = ycomb_b_8 flatten_fun_j_2154;
int_j_2156 = 0;
appl_j_2157 = appl_j_2155 int_j_2156;
t = appl_j_2157;
bool_j_2158 = true;
record_j_2159 = {leaf = bool_j_2158};
record_j_2160 = {};
record_j_2161 = {leaf = record_j_2160};
record_j_2162 = {bj_actual_rec = record_j_2159, bj_decl_lbls = record_j_2161};
empty = record_j_2162;
height_j_207_j_2188 = fun x_j_211 -> (
    bool_j_2163 = false;
    fail_b_333 = bool_j_2163;
    var_j_2164 = x_j_211;
    m_match_bool_j_2166 = var_j_2164 ~ {bj_untouched, _};
    m_match_bool_j_2173 = var_j_2164 ~ {bj_actual_rec, _};
    m_match_cond_j_2174 = m_match_bool_j_2173 ? (
            actual_rec_b_371 = var_j_2164.bj_actual_rec;
            var_j_2175 = x_j_211;
            proj_j_2176 = var_j_2175.bj_decl_lbls;
            m_match_bool_j_2178 = proj_j_2176 ~ {height, _};
            m_match_bool_j_2183 = proj_j_2176 ~ {leaf};
            m_match_cond_j_2184 = m_match_bool_j_2183 ? (
                    b_j_209 = proj_j_2176.leaf;
                    var_j_2185 = actual_rec_b_371;
                    proj_j_2186 = var_j_2185.leaf;
                    b_j_208 = proj_j_2186;
                    int_j_2187 = 0
                ) : (
                    m_match_cond_j_2179 = m_match_bool_j_2178 ? (
                            h_j_210 = proj_j_2176.height;
                            var_j_2180 = actual_rec_b_371;
                            proj_j_2181 = var_j_2180.height;
                            h = proj_j_2181;
                            var_j_2182 = h
                        ) : (
                            ab_j_2177 = abort
                        )
                )
        ) : (
            m_match_cond_j_2167 = m_match_bool_j_2166 ? (
                    var_j_2168 = fail_b_333;
                    assert_pred_j_2169 = var_j_2168;
                    assert_res_j_2170 = assert_pred_j_2169 ? (
                            assert_res_true_j_2171 = {}
                        ) : (
                            ab_j_2172 = abort
                        )
                ) : (
                    ab_j_2165 = abort
                )
        ));
balance_factor_j_2222 = fun x_j_206 -> (
    bool_j_2189 = false;
    fail_b_334 = bool_j_2189;
    var_j_2190 = x_j_206;
    m_match_bool_j_2192 = var_j_2190 ~ {bj_untouched, _};
    m_match_bool_j_2199 = var_j_2190 ~ {bj_actual_rec, _};
    m_match_cond_j_2200 = m_match_bool_j_2199 ? (
            actual_rec_b_372 = var_j_2190.bj_actual_rec;
            var_j_2201 = x_j_206;
            proj_j_2202 = var_j_2201.bj_decl_lbls;
            m_match_bool_j_2204 = proj_j_2202 ~ {left, right, _};
            m_match_bool_j_2217 = proj_j_2202 ~ {leaf};
            m_match_cond_j_2218 = m_match_bool_j_2217 ? (
                    leaf_j_201 = proj_j_2202.leaf;
                    var_j_2219 = actual_rec_b_372;
                    proj_j_2220 = var_j_2219.leaf;
                    leaf_j_200 = proj_j_2220;
                    int_j_2221 = 0
                ) : (
                    m_match_cond_j_2205 = m_match_bool_j_2204 ? (
                            left_j_205 = proj_j_2202.left;
                            right_j_204 = proj_j_2202.right;
                            var_j_2206 = actual_rec_b_372;
                            proj_j_2207 = var_j_2206.right;
                            right_j_203 = proj_j_2207;
                            var_j_2208 = actual_rec_b_372;
                            proj_j_2209 = var_j_2208.left;
                            left_j_202 = proj_j_2209;
                            var_j_2210 = height_j_207_j_2188;
                            var_j_2211 = left_j_202;
                            m_i_2957 = var_j_2210 ~ fun;
                            appl_j_2212 = m_i_2957 ? (
                                    c_appl_i_2958 = var_j_2210 var_j_2211
                                ) : (
                                    ab_i_2959 = abort
                                );
                            var_j_2213 = height_j_207_j_2188;
                            var_j_2214 = right_j_203;
                            m_i_2960 = var_j_2213 ~ fun;
                            appl_j_2215 = m_i_2960 ? (
                                    c_appl_i_2961 = var_j_2213 var_j_2214
                                ) : (
                                    ab_i_2962 = abort
                                );
                            m_bl_i_2963 = appl_j_2212 ~ int;
                            m_br_i_2964 = appl_j_2215 ~ int;
                            m_b_i_2965 = m_bl_i_2963 and m_br_i_2964;
                            binop_j_2216 = m_b_i_2965 ? (
                                    c_binop_i_2966 = appl_j_2212 - appl_j_2215
                                ) : (
                                    ab_i_2967 = abort
                                )
                        ) : (
                            ab_j_2203 = abort
                        )
                )
        ) : (
            m_match_cond_j_2193 = m_match_bool_j_2192 ? (
                    var_j_2194 = fail_b_334;
                    assert_pred_j_2195 = var_j_2194;
                    assert_res_j_2196 = assert_pred_j_2195 ? (
                            assert_res_true_j_2197 = {}
                        ) : (
                            ab_j_2198 = abort
                        )
                ) : (
                    ab_j_2191 = abort
                )
        ));
balance_factor = balance_factor_j_2222;
abs_j_2231 = fun a_j_199 -> (
    int_j_2223 = 0;
    var_j_2224 = a_j_199;
    m_bl_i_2968 = int_j_2223 ~ int;
    m_br_i_2969 = var_j_2224 ~ int;
    m_b_i_2970 = m_bl_i_2968 and m_br_i_2969;
    binop_j_2225 = m_b_i_2970 ? (
            c_binop_i_2971 = int_j_2223 < var_j_2224
        ) : (
            ab_i_2972 = abort
        );
    m_i_2973 = binop_j_2225 ~ bool;
    if_j_2230 = m_i_2973 ? (
            c_cond_i_2979 = binop_j_2225 ? (
                    var_j_2226 = a_j_199
                ) : (
                    int_j_2227 = 0;
                    var_j_2228 = a_j_199;
                    m_bl_i_2974 = int_j_2227 ~ int;
                    m_br_i_2975 = var_j_2228 ~ int;
                    m_b_i_2976 = m_bl_i_2974 and m_br_i_2975;
                    binop_j_2229 = m_b_i_2976 ? (
                            c_binop_i_2977 = int_j_2227 - var_j_2228
                        ) : (
                            ab_i_2978 = abort
                        )
                )
        ) : (
            ab_i_2980 = abort
        ));
abs = abs_j_2231;
flatten_fun_j_2277 = fun is_balanced_j_1 -> (
    flatten_fun_j_2276 = fun x -> (
        var_j_2232 = is_balanced_j_1;
        var_j_2233 = is_balanced_j_1;
        appl_j_2234 = var_j_2232 var_j_2233;
        is_balanced = appl_j_2234;
        bool_j_2235 = false;
        fail_b_335 = bool_j_2235;
        var_j_2236 = x;
        m_match_bool_j_2238 = var_j_2236 ~ {bj_untouched, _};
        m_match_bool_j_2245 = var_j_2236 ~ {bj_actual_rec, _};
        m_match_cond_j_2246 = m_match_bool_j_2245 ? (
                actual_rec_b_373 = var_j_2236.bj_actual_rec;
                var_j_2247 = x;
                proj_j_2248 = var_j_2247.bj_decl_lbls;
                m_match_bool_j_2250 = proj_j_2248 ~ {left, right, _};
                m_match_bool_j_2271 = proj_j_2248 ~ {leaf};
                m_match_cond_j_2272 = m_match_bool_j_2271 ? (
                        leaf_j_136 = proj_j_2248.leaf;
                        var_j_2273 = actual_rec_b_373;
                        proj_j_2274 = var_j_2273.leaf;
                        leaf_j_135 = proj_j_2274;
                        bool_j_2275 = true
                    ) : (
                        m_match_cond_j_2251 = m_match_bool_j_2250 ? (
                                left_j_140 = proj_j_2248.left;
                                right_j_139 = proj_j_2248.right;
                                var_j_2252 = actual_rec_b_373;
                                proj_j_2253 = var_j_2252.right;
                                right_j_138 = proj_j_2253;
                                var_j_2254 = actual_rec_b_373;
                                proj_j_2255 = var_j_2254.left;
                                left_j_137 = proj_j_2255;
                                var_j_2256 = abs;
                                var_j_2257 = balance_factor;
                                var_j_2258 = x;
                                m_i_2981 = var_j_2257 ~ fun;
                                appl_j_2259 = m_i_2981 ? (
                                        c_appl_i_2982 = var_j_2257 var_j_2258
                                    ) : (
                                        ab_i_2983 = abort
                                    );
                                m_i_2984 = var_j_2256 ~ fun;
                                appl_j_2260 = m_i_2984 ? (
                                        c_appl_i_2985 = var_j_2256 appl_j_2259
                                    ) : (
                                        ab_i_2986 = abort
                                    );
                                int_j_2261 = 2;
                                m_bl_i_2987 = appl_j_2260 ~ int;
                                m_br_i_2988 = int_j_2261 ~ int;
                                m_b_i_2989 = m_bl_i_2987 and m_br_i_2988;
                                binop_j_2262 = m_b_i_2989 ? (
                                        c_binop_i_2990 = appl_j_2260 < int_j_2261
                                    ) : (
                                        ab_i_2991 = abort
                                    );
                                var_j_2263 = is_balanced;
                                var_j_2264 = left_j_137;
                                m_i_2992 = var_j_2263 ~ fun;
                                appl_j_2265 = m_i_2992 ? (
                                        c_appl_i_2993 = var_j_2263 var_j_2264
                                    ) : (
                                        ab_i_2994 = abort
                                    );
                                m_bl_i_2995 = binop_j_2262 ~ bool;
                                m_br_i_2996 = appl_j_2265 ~ bool;
                                m_b_i_2997 = m_bl_i_2995 and m_br_i_2996;
                                binop_j_2266 = m_b_i_2997 ? (
                                        c_binop_i_2998 = binop_j_2262 and appl_j_2265
                                    ) : (
                                        ab_i_2999 = abort
                                    );
                                var_j_2267 = is_balanced;
                                var_j_2268 = right_j_138;
                                m_i_3000 = var_j_2267 ~ fun;
                                appl_j_2269 = m_i_3000 ? (
                                        c_appl_i_3001 = var_j_2267 var_j_2268
                                    ) : (
                                        ab_i_3002 = abort
                                    );
                                m_bl_i_3003 = binop_j_2266 ~ bool;
                                m_br_i_3004 = appl_j_2269 ~ bool;
                                m_b_i_3005 = m_bl_i_3003 and m_br_i_3004;
                                binop_j_2270 = m_b_i_3005 ? (
                                        c_binop_i_3006 = binop_j_2266 and appl_j_2269
                                    ) : (
                                        ab_i_3007 = abort
                                    )
                            ) : (
                                ab_j_2249 = abort
                            )
                    )
            ) : (
                m_match_cond_j_2239 = m_match_bool_j_2238 ? (
                        var_j_2240 = fail_b_335;
                        assert_pred_j_2241 = var_j_2240;
                        assert_res_j_2242 = assert_pred_j_2241 ? (
                                assert_res_true_j_2243 = {}
                            ) : (
                                ab_j_2244 = abort
                            )
                    ) : (
                        ab_j_2237 = abort
                    )
            )));
appl_j_2280 = flatten_fun_j_2277 flatten_fun_j_2277;
max_j_2288 = fun a -> (
    max_j_2287 = fun b_j_196 -> (
        var_j_2281 = b_j_196;
        var_j_2282 = a;
        m_bl_i_3008 = var_j_2281 ~ int;
        m_br_i_3009 = var_j_2282 ~ int;
        m_b_i_3010 = m_bl_i_3008 and m_br_i_3009;
        binop_j_2283 = m_b_i_3010 ? (
                c_binop_i_3011 = var_j_2281 < var_j_2282
            ) : (
                ab_i_3012 = abort
            );
        m_i_3013 = binop_j_2283 ~ bool;
        if_j_2286 = m_i_3013 ? (
                c_cond_i_3014 = binop_j_2283 ? (
                        var_j_2284 = a
                    ) : (
                        var_j_2285 = b_j_196
                    )
            ) : (
                ab_i_3015 = abort
            )));
max = max_j_2288;
create_node_j_2312 = fun item_j_195 -> (
    create_node_j_2311 = fun left_j_194 -> (
        create_node_j_2310 = fun right_j_193 -> (
            int_j_2289 = 1;
            var_j_2290 = max;
            var_j_2291 = height_j_207_j_2188;
            var_j_2292 = left_j_194;
            m_i_3016 = var_j_2291 ~ fun;
            appl_j_2293 = m_i_3016 ? (
                    c_appl_i_3017 = var_j_2291 var_j_2292
                ) : (
                    ab_i_3018 = abort
                );
            m_i_3019 = var_j_2290 ~ fun;
            appl_j_2294 = m_i_3019 ? (
                    c_appl_i_3020 = var_j_2290 appl_j_2293
                ) : (
                    ab_i_3021 = abort
                );
            var_j_2295 = height_j_207_j_2188;
            var_j_2296 = right_j_193;
            m_i_3022 = var_j_2295 ~ fun;
            appl_j_2297 = m_i_3022 ? (
                    c_appl_i_3023 = var_j_2295 var_j_2296
                ) : (
                    ab_i_3024 = abort
                );
            m_i_3025 = appl_j_2294 ~ fun;
            appl_j_2298 = m_i_3025 ? (
                    c_appl_i_3026 = appl_j_2294 appl_j_2297
                ) : (
                    ab_i_3027 = abort
                );
            m_bl_i_3028 = int_j_2289 ~ int;
            m_br_i_3029 = appl_j_2298 ~ int;
            m_b_i_3030 = m_bl_i_3028 and m_br_i_3029;
            binop_j_2299 = m_b_i_3030 ? (
                    c_binop_i_3031 = int_j_2289 + appl_j_2298
                ) : (
                    ab_i_3032 = abort
                );
            var_j_2300 = item_j_195;
            var_j_2301 = left_j_194;
            var_j_2302 = right_j_193;
            record_j_2303 = {height = binop_j_2299, item = var_j_2300, left = var_j_2301, right = var_j_2302};
            record_j_2304 = {};
            record_j_2305 = {};
            record_j_2306 = {};
            record_j_2307 = {};
            record_j_2308 = {height = record_j_2304, item = record_j_2305, left = record_j_2306, right = record_j_2307};
            record_j_2309 = {bj_actual_rec = record_j_2303, bj_decl_lbls = record_j_2308})));
create_node = create_node_j_2312;
rotate_left_j_2372 = fun x_j_192 -> (
    bool_j_2313 = false;
    fail_b_336 = bool_j_2313;
    var_j_2314 = x_j_192;
    m_match_bool_j_2316 = var_j_2314 ~ {bj_untouched, _};
    m_match_bool_j_2323 = var_j_2314 ~ {bj_actual_rec, _};
    m_match_cond_j_2324 = m_match_bool_j_2323 ? (
            actual_rec_b_375 = var_j_2314.bj_actual_rec;
            var_j_2325 = x_j_192;
            proj_j_2326 = var_j_2325.bj_decl_lbls;
            m_match_bool_j_2328 = proj_j_2326 ~ {item, left, right, _};
            m_match_cond_j_2329 = m_match_bool_j_2328 ? (
                    item_j_191 = proj_j_2326.item;
                    left_j_190 = proj_j_2326.left;
                    right_j_189 = proj_j_2326.right;
                    var_j_2330 = actual_rec_b_375;
                    proj_j_2331 = var_j_2330.right;
                    right_j_188 = proj_j_2331;
                    var_j_2332 = actual_rec_b_375;
                    proj_j_2333 = var_j_2332.left;
                    left_j_187 = proj_j_2333;
                    var_j_2334 = actual_rec_b_375;
                    proj_j_2335 = var_j_2334.item;
                    item_j_186 = proj_j_2335;
                    bool_j_2336 = false;
                    fail_b_337 = bool_j_2336;
                    var_j_2337 = right_j_188;
                    m_match_bool_j_2339 = var_j_2337 ~ {bj_untouched, _};
                    m_match_bool_j_2346 = var_j_2337 ~ {bj_actual_rec, _};
                    m_match_cond_j_2347 = m_match_bool_j_2346 ? (
                            actual_rec_b_374 = var_j_2337.bj_actual_rec;
                            var_j_2348 = right_j_188;
                            proj_j_2349 = var_j_2348.bj_decl_lbls;
                            m_match_bool_j_2351 = proj_j_2349 ~ {item, left, right, _};
                            m_match_cond_j_2352 = m_match_bool_j_2351 ? (
                                    ri_j_185 = proj_j_2349.item;
                                    rleft_j_184 = proj_j_2349.left;
                                    rright_j_183 = proj_j_2349.right;
                                    var_j_2353 = actual_rec_b_374;
                                    proj_j_2354 = var_j_2353.right;
                                    rright = proj_j_2354;
                                    var_j_2355 = actual_rec_b_374;
                                    proj_j_2356 = var_j_2355.left;
                                    rleft = proj_j_2356;
                                    var_j_2357 = actual_rec_b_374;
                                    proj_j_2358 = var_j_2357.item;
                                    ri = proj_j_2358;
                                    var_j_2359 = create_node;
                                    var_j_2360 = ri;
                                    m_i_3033 = var_j_2359 ~ fun;
                                    appl_j_2361 = m_i_3033 ? (
                                            c_appl_i_3034 = var_j_2359 var_j_2360
                                        ) : (
                                            ab_i_3035 = abort
                                        );
                                    var_j_2362 = create_node;
                                    var_j_2363 = item_j_186;
                                    m_i_3036 = var_j_2362 ~ fun;
                                    appl_j_2364 = m_i_3036 ? (
                                            c_appl_i_3037 = var_j_2362 var_j_2363
                                        ) : (
                                            ab_i_3038 = abort
                                        );
                                    var_j_2365 = left_j_187;
                                    m_i_3039 = appl_j_2364 ~ fun;
                                    appl_j_2366 = m_i_3039 ? (
                                            c_appl_i_3040 = appl_j_2364 var_j_2365
                                        ) : (
                                            ab_i_3041 = abort
                                        );
                                    var_j_2367 = rleft;
                                    m_i_3042 = appl_j_2366 ~ fun;
                                    appl_j_2368 = m_i_3042 ? (
                                            c_appl_i_3043 = appl_j_2366 var_j_2367
                                        ) : (
                                            ab_i_3044 = abort
                                        );
                                    m_i_3045 = appl_j_2361 ~ fun;
                                    appl_j_2369 = m_i_3045 ? (
                                            c_appl_i_3046 = appl_j_2361 appl_j_2368
                                        ) : (
                                            ab_i_3047 = abort
                                        );
                                    var_j_2370 = rright;
                                    m_i_3048 = appl_j_2369 ~ fun;
                                    appl_j_2371 = m_i_3048 ? (
                                            c_appl_i_3049 = appl_j_2369 var_j_2370
                                        ) : (
                                            ab_i_3050 = abort
                                        )
                                ) : (
                                    ab_j_2350 = abort
                                )
                        ) : (
                            m_match_cond_j_2340 = m_match_bool_j_2339 ? (
                                    var_j_2341 = fail_b_337;
                                    assert_pred_j_2342 = var_j_2341;
                                    assert_res_j_2343 = assert_pred_j_2342 ? (
                                            assert_res_true_j_2344 = 
                                                {}
                                        ) : (
                                            ab_j_2345 = abort
                                        )
                                ) : (
                                    ab_j_2338 = abort
                                )
                        )
                ) : (
                    ab_j_2327 = abort
                )
        ) : (
            m_match_cond_j_2317 = m_match_bool_j_2316 ? (
                    var_j_2318 = fail_b_336;
                    assert_pred_j_2319 = var_j_2318;
                    assert_res_j_2320 = assert_pred_j_2319 ? (
                            assert_res_true_j_2321 = {}
                        ) : (
                            ab_j_2322 = abort
                        )
                ) : (
                    ab_j_2315 = abort
                )
        ));
rotate_left = rotate_left_j_2372;
rotate_right_j_2432 = fun x_j_182 -> (
    bool_j_2373 = false;
    fail_b_338 = bool_j_2373;
    var_j_2374 = x_j_182;
    m_match_bool_j_2376 = var_j_2374 ~ {bj_untouched, _};
    m_match_bool_j_2383 = var_j_2374 ~ {bj_actual_rec, _};
    m_match_cond_j_2384 = m_match_bool_j_2383 ? (
            actual_rec_b_377 = var_j_2374.bj_actual_rec;
            var_j_2385 = x_j_182;
            proj_j_2386 = var_j_2385.bj_decl_lbls;
            m_match_bool_j_2388 = proj_j_2386 ~ {item, left, right, _};
            m_match_cond_j_2389 = m_match_bool_j_2388 ? (
                    item_j_181 = proj_j_2386.item;
                    left_j_180 = proj_j_2386.left;
                    right_j_179 = proj_j_2386.right;
                    var_j_2390 = actual_rec_b_377;
                    proj_j_2391 = var_j_2390.right;
                    right_j_178 = proj_j_2391;
                    var_j_2392 = actual_rec_b_377;
                    proj_j_2393 = var_j_2392.left;
                    left_j_177 = proj_j_2393;
                    var_j_2394 = actual_rec_b_377;
                    proj_j_2395 = var_j_2394.item;
                    item_j_176 = proj_j_2395;
                    bool_j_2396 = false;
                    fail_b_339 = bool_j_2396;
                    var_j_2397 = left_j_177;
                    m_match_bool_j_2399 = var_j_2397 ~ {bj_untouched, _};
                    m_match_bool_j_2406 = var_j_2397 ~ {bj_actual_rec, _};
                    m_match_cond_j_2407 = m_match_bool_j_2406 ? (
                            actual_rec_b_376 = var_j_2397.bj_actual_rec;
                            var_j_2408 = left_j_177;
                            proj_j_2409 = var_j_2408.bj_decl_lbls;
                            m_match_bool_j_2411 = proj_j_2409 ~ {item, left, right, _};
                            m_match_cond_j_2412 = m_match_bool_j_2411 ? (
                                    li_j_175 = proj_j_2409.item;
                                    lleft_j_174 = proj_j_2409.left;
                                    lright_j_173 = proj_j_2409.right;
                                    var_j_2413 = actual_rec_b_376;
                                    proj_j_2414 = var_j_2413.right;
                                    lright = proj_j_2414;
                                    var_j_2415 = actual_rec_b_376;
                                    proj_j_2416 = var_j_2415.left;
                                    lleft = proj_j_2416;
                                    var_j_2417 = actual_rec_b_376;
                                    proj_j_2418 = var_j_2417.item;
                                    li = proj_j_2418;
                                    var_j_2419 = create_node;
                                    var_j_2420 = li;
                                    m_i_3051 = var_j_2419 ~ fun;
                                    appl_j_2421 = m_i_3051 ? (
                                            c_appl_i_3052 = var_j_2419 var_j_2420
                                        ) : (
                                            ab_i_3053 = abort
                                        );
                                    var_j_2422 = lleft;
                                    m_i_3054 = appl_j_2421 ~ fun;
                                    appl_j_2423 = m_i_3054 ? (
                                            c_appl_i_3055 = appl_j_2421 var_j_2422
                                        ) : (
                                            ab_i_3056 = abort
                                        );
                                    var_j_2424 = create_node;
                                    var_j_2425 = item_j_176;
                                    m_i_3057 = var_j_2424 ~ fun;
                                    appl_j_2426 = m_i_3057 ? (
                                            c_appl_i_3058 = var_j_2424 var_j_2425
                                        ) : (
                                            ab_i_3059 = abort
                                        );
                                    var_j_2427 = lright;
                                    m_i_3060 = appl_j_2426 ~ fun;
                                    appl_j_2428 = m_i_3060 ? (
                                            c_appl_i_3061 = appl_j_2426 var_j_2427
                                        ) : (
                                            ab_i_3062 = abort
                                        );
                                    var_j_2429 = right_j_178;
                                    m_i_3063 = appl_j_2428 ~ fun;
                                    appl_j_2430 = m_i_3063 ? (
                                            c_appl_i_3064 = appl_j_2428 var_j_2429
                                        ) : (
                                            ab_i_3065 = abort
                                        );
                                    m_i_3066 = appl_j_2423 ~ fun;
                                    appl_j_2431 = m_i_3066 ? (
                                            c_appl_i_3067 = appl_j_2423 appl_j_2430
                                        ) : (
                                            ab_i_3068 = abort
                                        )
                                ) : (
                                    ab_j_2410 = abort
                                )
                        ) : (
                            m_match_cond_j_2400 = m_match_bool_j_2399 ? (
                                    var_j_2401 = fail_b_339;
                                    assert_pred_j_2402 = var_j_2401;
                                    assert_res_j_2403 = assert_pred_j_2402 ? (
                                            assert_res_true_j_2404 = 
                                                {}
                                        ) : (
                                            ab_j_2405 = abort
                                        )
                                ) : (
                                    ab_j_2398 = abort
                                )
                        )
                ) : (
                    ab_j_2387 = abort
                )
        ) : (
            m_match_cond_j_2377 = m_match_bool_j_2376 ? (
                    var_j_2378 = fail_b_338;
                    assert_pred_j_2379 = var_j_2378;
                    assert_res_j_2380 = assert_pred_j_2379 ? (
                            assert_res_true_j_2381 = {}
                        ) : (
                            ab_j_2382 = abort
                        )
                ) : (
                    ab_j_2375 = abort
                )
        ));
rotate_right = rotate_right_j_2432;
rotate_left_right_j_2467 = fun x_j_172 -> (
    bool_j_2433 = false;
    fail_b_340 = bool_j_2433;
    var_j_2434 = x_j_172;
    m_match_bool_j_2436 = var_j_2434 ~ {bj_untouched, _};
    m_match_bool_j_2443 = var_j_2434 ~ {bj_actual_rec, _};
    m_match_cond_j_2444 = m_match_bool_j_2443 ? (
            actual_rec_b_378 = var_j_2434.bj_actual_rec;
            var_j_2445 = x_j_172;
            proj_j_2446 = var_j_2445.bj_decl_lbls;
            m_match_bool_j_2448 = proj_j_2446 ~ {item, left, right, _};
            m_match_cond_j_2449 = m_match_bool_j_2448 ? (
                    item_j_171 = proj_j_2446.item;
                    left_j_170 = proj_j_2446.left;
                    right_j_169 = proj_j_2446.right;
                    var_j_2450 = actual_rec_b_378;
                    proj_j_2451 = var_j_2450.right;
                    right_j_168 = proj_j_2451;
                    var_j_2452 = actual_rec_b_378;
                    proj_j_2453 = var_j_2452.left;
                    left_j_167 = proj_j_2453;
                    var_j_2454 = actual_rec_b_378;
                    proj_j_2455 = var_j_2454.item;
                    item_j_166 = proj_j_2455;
                    var_j_2456 = rotate_right;
                    var_j_2457 = create_node;
                    var_j_2458 = item_j_166;
                    m_i_3069 = var_j_2457 ~ fun;
                    appl_j_2459 = m_i_3069 ? (
                            c_appl_i_3070 = var_j_2457 var_j_2458
                        ) : (
                            ab_i_3071 = abort
                        );
                    var_j_2460 = rotate_left;
                    var_j_2461 = left_j_167;
                    m_i_3072 = var_j_2460 ~ fun;
                    appl_j_2462 = m_i_3072 ? (
                            c_appl_i_3073 = var_j_2460 var_j_2461
                        ) : (
                            ab_i_3074 = abort
                        );
                    m_i_3075 = appl_j_2459 ~ fun;
                    appl_j_2463 = m_i_3075 ? (
                            c_appl_i_3076 = appl_j_2459 appl_j_2462
                        ) : (
                            ab_i_3077 = abort
                        );
                    var_j_2464 = right_j_168;
                    m_i_3078 = appl_j_2463 ~ fun;
                    appl_j_2465 = m_i_3078 ? (
                            c_appl_i_3079 = appl_j_2463 var_j_2464
                        ) : (
                            ab_i_3080 = abort
                        );
                    m_i_3081 = var_j_2456 ~ fun;
                    appl_j_2466 = m_i_3081 ? (
                            c_appl_i_3082 = var_j_2456 appl_j_2465
                        ) : (
                            ab_i_3083 = abort
                        )
                ) : (
                    ab_j_2447 = abort
                )
        ) : (
            m_match_cond_j_2437 = m_match_bool_j_2436 ? (
                    var_j_2438 = fail_b_340;
                    assert_pred_j_2439 = var_j_2438;
                    assert_res_j_2440 = assert_pred_j_2439 ? (
                            assert_res_true_j_2441 = {}
                        ) : (
                            ab_j_2442 = abort
                        )
                ) : (
                    ab_j_2435 = abort
                )
        ));
rotate_left_right = rotate_left_right_j_2467;
rotate_right_left_j_2502 = fun x_j_165 -> (
    bool_j_2468 = false;
    fail_b_341 = bool_j_2468;
    var_j_2469 = x_j_165;
    m_match_bool_j_2471 = var_j_2469 ~ {bj_untouched, _};
    m_match_bool_j_2478 = var_j_2469 ~ {bj_actual_rec, _};
    m_match_cond_j_2479 = m_match_bool_j_2478 ? (
            actual_rec_b_379 = var_j_2469.bj_actual_rec;
            var_j_2480 = x_j_165;
            proj_j_2481 = var_j_2480.bj_decl_lbls;
            m_match_bool_j_2483 = proj_j_2481 ~ {item, left, right, _};
            m_match_cond_j_2484 = m_match_bool_j_2483 ? (
                    item_j_164 = proj_j_2481.item;
                    left_j_163 = proj_j_2481.left;
                    right_j_162 = proj_j_2481.right;
                    var_j_2485 = actual_rec_b_379;
                    proj_j_2486 = var_j_2485.right;
                    right_j_161 = proj_j_2486;
                    var_j_2487 = actual_rec_b_379;
                    proj_j_2488 = var_j_2487.left;
                    left_j_160 = proj_j_2488;
                    var_j_2489 = actual_rec_b_379;
                    proj_j_2490 = var_j_2489.item;
                    item_j_159 = proj_j_2490;
                    var_j_2491 = rotate_left;
                    var_j_2492 = create_node;
                    var_j_2493 = item_j_159;
                    m_i_3084 = var_j_2492 ~ fun;
                    appl_j_2494 = m_i_3084 ? (
                            c_appl_i_3085 = var_j_2492 var_j_2493
                        ) : (
                            ab_i_3086 = abort
                        );
                    var_j_2495 = left_j_160;
                    m_i_3087 = appl_j_2494 ~ fun;
                    appl_j_2496 = m_i_3087 ? (
                            c_appl_i_3088 = appl_j_2494 var_j_2495
                        ) : (
                            ab_i_3089 = abort
                        );
                    var_j_2497 = rotate_right;
                    var_j_2498 = right_j_161;
                    m_i_3090 = var_j_2497 ~ fun;
                    appl_j_2499 = m_i_3090 ? (
                            c_appl_i_3091 = var_j_2497 var_j_2498
                        ) : (
                            ab_i_3092 = abort
                        );
                    m_i_3093 = appl_j_2496 ~ fun;
                    appl_j_2500 = m_i_3093 ? (
                            c_appl_i_3094 = appl_j_2496 appl_j_2499
                        ) : (
                            ab_i_3095 = abort
                        );
                    m_i_3096 = var_j_2491 ~ fun;
                    appl_j_2501 = m_i_3096 ? (
                            c_appl_i_3097 = var_j_2491 appl_j_2500
                        ) : (
                            ab_i_3098 = abort
                        )
                ) : (
                    ab_j_2482 = abort
                )
        ) : (
            m_match_cond_j_2472 = m_match_bool_j_2471 ? (
                    var_j_2473 = fail_b_341;
                    assert_pred_j_2474 = var_j_2473;
                    assert_res_j_2475 = assert_pred_j_2474 ? (
                            assert_res_true_j_2476 = {}
                        ) : (
                            ab_j_2477 = abort
                        )
                ) : (
                    ab_j_2470 = abort
                )
        ));
rotate_right_left = rotate_right_left_j_2502;
flatten_fun_j_2792 = fun insert_j_0 -> (
    flatten_fun_j_2791 = fun tree -> (
        flatten_fun_j_2790 = fun i -> (
            var_j_2503 = insert_j_0;
            var_j_2504 = insert_j_0;
            appl_j_2505 = var_j_2503 var_j_2504;
            insert = appl_j_2505;
            flatten_fun_j_2787 = fun tree_b_2 -> (
                int_j_2506 = 0;
                input_j_2507 = input;
                m_bl_i_3099 = int_j_2506 ~ int;
                m_br_i_3100 = input_j_2507 ~ int;
                m_b_i_3101 = m_bl_i_3099 and m_br_i_3100;
                binop_j_2508 = m_b_i_3101 ? (
                        c_binop_i_3102 = int_j_2506 < input_j_2507
                    ) : (
                        ab_i_3103 = abort
                    );
                if_j_2543 = binop_j_2508 ? (
                        flatten_fun_j_2523 = fun expr_b_351 -> (
                            var_j_2509 = t;
                            proj_j_2510 = var_j_2509.checker;
                            var_j_2511 = expr_b_351;
                            appl_j_2512 = proj_j_2510 var_j_2511;
                            t_check_b_352 = appl_j_2512;
                            var_j_2513 = t_check_b_352;
                            if_j_2522 = var_j_2513 ? (
                                    bool_j_2514 = false;
                                    pred_check_b_353 = bool_j_2514;
                                    var_j_2515 = appl_j_2280;
                                    var_j_2516 = expr_b_351;
                                    appl_j_2517 = var_j_2515 var_j_2516;
                                    if_j_2520 = appl_j_2517 ? (
                                            bool_j_2518 = true
                                        ) : (
                                            var_j_2519 = pred_check_b_353
                                        )
                                ) : (
                                    var_j_2521 = t_check_b_352
                                ));
                        flatten_fun_j_2535 = fun bj_null_j_141 -> (
                            var_j_2524 = t;
                            proj_j_2525 = var_j_2524.generator;
                            int_j_2526 = 0;
                            appl_j_2527 = proj_j_2525 int_j_2526;
                            candidate_b_350 = appl_j_2527;
                            var_j_2528 = appl_j_2280;
                            var_j_2529 = candidate_b_350;
                            appl_j_2530 = var_j_2528 var_j_2529;
                            if_j_2534 = appl_j_2530 ? (
                                    var_j_2531 = candidate_b_350
                                ) : (
                                    bool_j_2532 = false;
                                    assume_j_2533 = assume bool_j_2532
                                ));
                        flatten_fun_j_2537 = fun expr_b_354 -> (
                            var_j_2536 = expr_b_354);
                        record_j_2538 = {checker = flatten_fun_j_2523, generator = flatten_fun_j_2535, wrapper = flatten_fun_j_2537};
                        proj_j_2539 = record_j_2538.checker;
                        var_j_2540 = tree_b_2;
                        m_i_3104 = proj_j_2539 ~ fun;
                        appl_j_2541 = m_i_3104 ? (
                                c_appl_i_3105 = proj_j_2539 var_j_2540
                            ) : (
                                ab_i_3106 = abort
                            )
                    ) : (
                        bool_j_2542 = true
                    );
                arg_check_b_3 = if_j_2543;
                var_j_2544 = arg_check_b_3;
                if_j_2786 = var_j_2544 ? (
                        flatten_fun_j_2778 = fun i_b_0 -> (
                            int_j_2545 = 0;
                            input_j_2546 = input;
                            m_bl_i_3107 = int_j_2545 ~ int;
                            m_br_i_3108 = input_j_2546 ~ int;
                            m_b_i_3109 = m_bl_i_3107 and m_br_i_3108;
                            binop_j_2547 = m_b_i_3109 ? (
                                    c_binop_i_3110 = int_j_2545 < input_j_2546
                                ) : (
                                    ab_i_3111 = abort
                                );
                            if_j_2567 = binop_j_2547 ? (
                                    bool_j_2548 = false;
                                    fail_b_356 = bool_j_2548;
                                    flatten_fun_j_2557 = fun expr_b_355 -> (
                                        var_j_2549 = expr_b_355;
                                        m_match_bool_j_2551 = var_j_2549 ~ any;
                                        m_match_bool_j_2554 = var_j_2549 ~ int;
                                        m_match_cond_j_2555 = m_match_bool_j_2554 ? (
                                                bool_j_2556 = true
                                            ) : (
                                                m_match_cond_j_2552 = m_match_bool_j_2551 ? (
                                                        var_j_2553 = fail_b_356
                                                    ) : (
                                                        void_j_2550 = 
                                                            {}
                                                    )
                                            ));
                                    flatten_fun_j_2559 = fun bj_null_j_142 -> (
                                        input_j_2558 = input);
                                    flatten_fun_j_2561 = fun expr_b_357 -> (
                                        var_j_2560 = expr_b_357);
                                    record_j_2562 = {checker = flatten_fun_j_2557, generator = flatten_fun_j_2559, wrapper = flatten_fun_j_2561};
                                    proj_j_2563 = record_j_2562.checker;
                                    var_j_2564 = i_b_0;
                                    m_i_3112 = proj_j_2563 ~ fun;
                                    appl_j_2565 = m_i_3112 ? (
                                            c_appl_i_3113 = proj_j_2563 var_j_2564
                                        ) : (
                                            ab_i_3114 = abort
                                        )
                                ) : (
                                    bool_j_2566 = true
                                );
                            arg_check_b_1 = if_j_2567;
                            var_j_2568 = arg_check_b_1;
                            if_j_2777 = var_j_2568 ? (
                                    flatten_fun_j_2583 = fun expr_b_359 -> (
                                        var_j_2569 = t;
                                        proj_j_2570 = var_j_2569.checker;
                                        var_j_2571 = expr_b_359;
                                        appl_j_2572 = proj_j_2570 var_j_2571;
                                        t_check_b_360 = appl_j_2572;
                                        var_j_2573 = t_check_b_360;
                                        if_j_2582 = var_j_2573 ? (
                                                bool_j_2574 = false;
                                                pred_check_b_361 = bool_j_2574;
                                                var_j_2575 = appl_j_2280;
                                                var_j_2576 = expr_b_359;
                                                appl_j_2577 = var_j_2575 var_j_2576;
                                                if_j_2580 = appl_j_2577 ? (
                                                        bool_j_2578 = true
                                                    ) : (
                                                        var_j_2579 = pred_check_b_361
                                                    )
                                            ) : (
                                                var_j_2581 = t_check_b_360
                                            ));
                                    flatten_fun_j_2595 = fun bj_null_j_143 -> (
                                        var_j_2584 = t;
                                        proj_j_2585 = var_j_2584.generator;
                                        int_j_2586 = 0;
                                        appl_j_2587 = proj_j_2585 int_j_2586;
                                        candidate_b_358 = appl_j_2587;
                                        var_j_2588 = appl_j_2280;
                                        var_j_2589 = candidate_b_358;
                                        appl_j_2590 = var_j_2588 var_j_2589;
                                        if_j_2594 = appl_j_2590 ? (
                                                var_j_2591 = candidate_b_358
                                            ) : (
                                                bool_j_2592 = false;
                                                assume_j_2593 = assume bool_j_2592
                                            ));
                                    flatten_fun_j_2597 = fun expr_b_362 -> (
                                        var_j_2596 = expr_b_362);
                                    record_j_2598 = {checker = flatten_fun_j_2583, generator = flatten_fun_j_2595, wrapper = flatten_fun_j_2597};
                                    proj_j_2599 = record_j_2598.wrapper;
                                    bool_j_2600 = false;
                                    fail_b_363 = bool_j_2600;
                                    var_j_2601 = tree;
                                    m_match_bool_j_2603 = var_j_2601 ~ 
                                        {bj_untouched, _};
                                    m_match_bool_j_2610 = var_j_2601 ~ 
                                        {bj_actual_rec, _};
                                    m_match_cond_j_2611 = m_match_bool_j_2610 ? (
                                            actual_rec_b_385 = var_j_2601.bj_actual_rec;
                                            var_j_2612 = tree;
                                            proj_j_2613 = var_j_2612.bj_decl_lbls;
                                            m_match_bool_j_2615 = proj_j_2613 ~ 
                                                {item, left, right, _};
                                            m_match_bool_j_2752 = proj_j_2613 ~ 
                                                {leaf};
                                            m_match_cond_j_2753 = m_match_bool_j_2752 ? (
                                                    b_j_144 = proj_j_2613.leaf;
                                                    var_j_2754 = actual_rec_b_385;
                                                    proj_j_2755 = var_j_2754.leaf;
                                                    b = proj_j_2755;
                                                    var_j_2756 = create_node;
                                                    var_j_2757 = i;
                                                    m_i_3115 = var_j_2756 ~ fun;
                                                    appl_j_2758 = m_i_3115 ? (
                                                            c_appl_i_3116 = var_j_2756 var_j_2757
                                                        ) : (
                                                            ab_i_3117 = abort
                                                        );
                                                    bool_j_2759 = true;
                                                    record_j_2760 = {leaf = bool_j_2759};
                                                    record_j_2761 = {};
                                                    record_j_2762 = {leaf = record_j_2761};
                                                    record_j_2763 = {bj_actual_rec = record_j_2760, bj_decl_lbls = record_j_2762};
                                                    m_i_3118 = appl_j_2758 ~ fun;
                                                    appl_j_2764 = m_i_3118 ? (
                                                            c_appl_i_3119 = appl_j_2758 record_j_2763
                                                        ) : (
                                                            ab_i_3120 = abort
                                                        );
                                                    bool_j_2765 = true;
                                                    record_j_2766 = {leaf = bool_j_2765};
                                                    record_j_2767 = {};
                                                    record_j_2768 = {leaf = record_j_2767};
                                                    record_j_2769 = {bj_actual_rec = record_j_2766, bj_decl_lbls = record_j_2768};
                                                    m_i_3121 = appl_j_2764 ~ fun;
                                                    appl_j_2770 = m_i_3121 ? (
                                                            c_appl_i_3122 = appl_j_2764 record_j_2769
                                                        ) : (
                                                            ab_i_3123 = abort
                                                        )
                                                ) : (
                                                    m_match_cond_j_2616 = m_match_bool_j_2615 ? (
                                                            item_j_153 = proj_j_2613.item;
                                                            left_j_152 = proj_j_2613.left;
                                                            right_j_151 = proj_j_2613.right;
                                                            var_j_2617 = actual_rec_b_385;
                                                            proj_j_2618 = var_j_2617.right;
                                                            right_j_150 = proj_j_2618;
                                                            var_j_2619 = actual_rec_b_385;
                                                            proj_j_2620 = var_j_2619.left;
                                                            left_j_149 = proj_j_2620;
                                                            var_j_2621 = actual_rec_b_385;
                                                            proj_j_2622 = var_j_2621.item;
                                                            item_j_148 = proj_j_2622;
                                                            var_j_2623 = i;
                                                            var_j_2624 = item_j_148;
                                                            m_bl_i_3124 = var_j_2623 ~ int;
                                                            m_br_i_3125 = var_j_2624 ~ int;
                                                            m_b_i_3126 = m_bl_i_3124 and m_br_i_3125;
                                                            binop_j_2625 = m_b_i_3126 ? (
                                                                    c_binop_i_3127 = var_j_2623 < var_j_2624
                                                                ) : (
                                                                    ab_i_3128 = abort
                                                                );
                                                            m_i_3129 = binop_j_2625 ~ bool;
                                                            if_j_2751 = m_i_3129 ? (
                                                                    c_cond_i_3259 = binop_j_2625 ? (
                                                                        var_j_2626 = insert;
                                                                    var_j_2627 = left_j_149;
                                                                    m_i_3130 = var_j_2626 ~ fun;
                                                                    appl_j_2628 = m_i_3130 ? (
                                                                        c_appl_i_3131 = var_j_2626 var_j_2627
                                                                    ) : (
                                                                        ab_i_3132 = abort
                                                                    );
                                                                    var_j_2629 = i;
                                                                    m_i_3133 = appl_j_2628 ~ fun;
                                                                    appl_j_2630 = m_i_3133 ? (
                                                                        c_appl_i_3134 = appl_j_2628 var_j_2629
                                                                    ) : (
                                                                        ab_i_3135 = abort
                                                                    );
                                                                    new_left = appl_j_2630;
                                                                    int_j_2631 = 1;
                                                                    var_j_2632 = balance_factor;
                                                                    var_j_2633 = new_left;
                                                                    m_i_3136 = var_j_2632 ~ fun;
                                                                    appl_j_2634 = m_i_3136 ? (
                                                                        c_appl_i_3137 = var_j_2632 var_j_2633
                                                                    ) : (
                                                                        ab_i_3138 = abort
                                                                    );
                                                                    m_bl_i_3139 = int_j_2631 ~ int;
                                                                    m_br_i_3140 = appl_j_2634 ~ int;
                                                                    m_b_i_3141 = m_bl_i_3139 and m_br_i_3140;
                                                                    binop_j_2635 = m_b_i_3141 ? (
                                                                        c_binop_i_3142 = int_j_2631 < appl_j_2634
                                                                    ) : (
                                                                        ab_i_3143 = abort
                                                                    );
                                                                    m_i_3144 = binop_j_2635 ~ bool;
                                                                    if_j_2684 = m_i_3144 ? (
                                                                        c_cond_i_3186 = binop_j_2635 ? (
                                                                        var_j_2636 = i;
                                                                    bool_j_2637 = false;
                                                                    fail_b_364 = bool_j_2637;
                                                                    var_j_2638 = new_left;
                                                                    m_match_bool_j_2640 = var_j_2638 ~ 
                                                                    {bj_untouched, _};
                                                                    m_match_bool_j_2647 = var_j_2638 ~ 
                                                                    {bj_actual_rec, _};
                                                                    m_match_cond_j_2648 = m_match_bool_j_2647 ? (
                                                                        actual_rec_b_383 = var_j_2638.bj_actual_rec;
                                                                    var_j_2649 = new_left;
                                                                    proj_j_2650 = var_j_2649.bj_decl_lbls;
                                                                    m_match_bool_j_2652 = proj_j_2650 ~ 
                                                                    {item, _};
                                                                    m_match_cond_j_2653 = m_match_bool_j_2652 ? (
                                                                        ni_j_145 = proj_j_2650.item;
                                                                    var_j_2654 = actual_rec_b_383;
                                                                    proj_j_2655 = var_j_2654.item;
                                                                    ni = proj_j_2655;
                                                                    var_j_2656 = ni
                                                                    ) : (
                                                                        ab_j_2651 = abort
                                                                    )
                                                                    ) : (
                                                                        m_match_cond_j_2641 = m_match_bool_j_2640 ? (
                                                                        var_j_2642 = fail_b_364;
                                                                    assert_pred_j_2643 = var_j_2642;
                                                                    assert_res_j_2644 = assert_pred_j_2643 ? (
                                                                        assert_res_true_j_2645 = 
                                                                    {}
                                                                    ) : (
                                                                        ab_j_2646 = abort
                                                                    )
                                                                    ) : (
                                                                        ab_j_2639 = abort
                                                                    )
                                                                    );
                                                                    m_bl_i_3145 = var_j_2636 ~ int;
                                                                    m_br_i_3146 = m_match_cond_j_2648 ~ int;
                                                                    m_b_i_3147 = m_bl_i_3145 and m_br_i_3146;
                                                                    binop_j_2657 = m_b_i_3147 ? (
                                                                        c_binop_i_3148 = var_j_2636 < m_match_cond_j_2648
                                                                    ) : (
                                                                        ab_i_3149 = abort
                                                                    );
                                                                    m_i_3150 = binop_j_2657 ~ bool;
                                                                    if_j_2676 = m_i_3150 ? (
                                                                        c_cond_i_3175 = binop_j_2657 ? (
                                                                        var_j_2658 = rotate_right;
                                                                    var_j_2659 = create_node;
                                                                    var_j_2660 = item_j_148;
                                                                    m_i_3151 = var_j_2659 ~ fun;
                                                                    appl_j_2661 = m_i_3151 ? (
                                                                        c_appl_i_3152 = var_j_2659 var_j_2660
                                                                    ) : (
                                                                        ab_i_3153 = abort
                                                                    );
                                                                    var_j_2662 = new_left;
                                                                    m_i_3154 = appl_j_2661 ~ fun;
                                                                    appl_j_2663 = m_i_3154 ? (
                                                                        c_appl_i_3155 = appl_j_2661 var_j_2662
                                                                    ) : (
                                                                        ab_i_3156 = abort
                                                                    );
                                                                    var_j_2664 = right_j_150;
                                                                    m_i_3157 = appl_j_2663 ~ fun;
                                                                    appl_j_2665 = m_i_3157 ? (
                                                                        c_appl_i_3158 = appl_j_2663 var_j_2664
                                                                    ) : (
                                                                        ab_i_3159 = abort
                                                                    );
                                                                    m_i_3160 = var_j_2658 ~ fun;
                                                                    appl_j_2666 = m_i_3160 ? (
                                                                        c_appl_i_3161 = var_j_2658 appl_j_2665
                                                                    ) : (
                                                                        ab_i_3162 = abort
                                                                    )
                                                                    ) : (
                                                                        var_j_2667 = rotate_left_right;
                                                                    var_j_2668 = create_node;
                                                                    var_j_2669 = item_j_148;
                                                                    m_i_3163 = var_j_2668 ~ fun;
                                                                    appl_j_2670 = m_i_3163 ? (
                                                                        c_appl_i_3164 = var_j_2668 var_j_2669
                                                                    ) : (
                                                                        ab_i_3165 = abort
                                                                    );
                                                                    var_j_2671 = new_left;
                                                                    m_i_3166 = appl_j_2670 ~ fun;
                                                                    appl_j_2672 = m_i_3166 ? (
                                                                        c_appl_i_3167 = appl_j_2670 var_j_2671
                                                                    ) : (
                                                                        ab_i_3168 = abort
                                                                    );
                                                                    var_j_2673 = right_j_150;
                                                                    m_i_3169 = appl_j_2672 ~ fun;
                                                                    appl_j_2674 = m_i_3169 ? (
                                                                        c_appl_i_3170 = appl_j_2672 var_j_2673
                                                                    ) : (
                                                                        ab_i_3171 = abort
                                                                    );
                                                                    m_i_3172 = var_j_2667 ~ fun;
                                                                    appl_j_2675 = m_i_3172 ? (
                                                                        c_appl_i_3173 = var_j_2667 appl_j_2674
                                                                    ) : (
                                                                        ab_i_3174 = abort
                                                                    )
                                                                    )
                                                                    ) : (
                                                                        ab_i_3176 = abort
                                                                    )
                                                                    ) : (
                                                                        var_j_2677 = create_node;
                                                                    var_j_2678 = item_j_148;
                                                                    m_i_3177 = var_j_2677 ~ fun;
                                                                    appl_j_2679 = m_i_3177 ? (
                                                                        c_appl_i_3178 = var_j_2677 var_j_2678
                                                                    ) : (
                                                                        ab_i_3179 = abort
                                                                    );
                                                                    var_j_2680 = new_left;
                                                                    m_i_3180 = appl_j_2679 ~ fun;
                                                                    appl_j_2681 = m_i_3180 ? (
                                                                        c_appl_i_3181 = appl_j_2679 var_j_2680
                                                                    ) : (
                                                                        ab_i_3182 = abort
                                                                    );
                                                                    var_j_2682 = right_j_150;
                                                                    m_i_3183 = appl_j_2681 ~ fun;
                                                                    appl_j_2683 = m_i_3183 ? (
                                                                        c_appl_i_3184 = appl_j_2681 var_j_2682
                                                                    ) : (
                                                                        ab_i_3185 = abort
                                                                    )
                                                                    )
                                                                    ) : (
                                                                        ab_i_3187 = abort
                                                                    )
                                                                    ) : (
                                                                        var_j_2685 = item_j_148;
                                                                    var_j_2686 = i;
                                                                    m_bl_i_3188 = var_j_2685 ~ int;
                                                                    m_br_i_3189 = var_j_2686 ~ int;
                                                                    m_b_i_3190 = m_bl_i_3188 and m_br_i_3189;
                                                                    binop_j_2687 = m_b_i_3190 ? (
                                                                        c_binop_i_3191 = var_j_2685 < var_j_2686
                                                                    ) : (
                                                                        ab_i_3192 = abort
                                                                    );
                                                                    m_i_3193 = binop_j_2687 ~ bool;
                                                                    if_j_2750 = m_i_3193 ? (
                                                                        c_cond_i_3257 = binop_j_2687 ? (
                                                                        var_j_2688 = insert;
                                                                    var_j_2689 = right_j_150;
                                                                    m_i_3194 = var_j_2688 ~ fun;
                                                                    appl_j_2690 = m_i_3194 ? (
                                                                        c_appl_i_3195 = var_j_2688 var_j_2689
                                                                    ) : (
                                                                        ab_i_3196 = abort
                                                                    );
                                                                    var_j_2691 = i;
                                                                    m_i_3197 = appl_j_2690 ~ fun;
                                                                    appl_j_2692 = m_i_3197 ? (
                                                                        c_appl_i_3198 = appl_j_2690 var_j_2691
                                                                    ) : (
                                                                        ab_i_3199 = abort
                                                                    );
                                                                    new_right = appl_j_2692;
                                                                    var_j_2693 = balance_factor;
                                                                    var_j_2694 = new_right;
                                                                    m_i_3200 = var_j_2693 ~ fun;
                                                                    appl_j_2695 = m_i_3200 ? (
                                                                        c_appl_i_3201 = var_j_2693 var_j_2694
                                                                    ) : (
                                                                        ab_i_3202 = abort
                                                                    );
                                                                    int_j_2696 = 0;
                                                                    int_j_2697 = 1;
                                                                    m_bl_i_3203 = int_j_2696 ~ int;
                                                                    m_br_i_3204 = int_j_2697 ~ int;
                                                                    m_b_i_3205 = m_bl_i_3203 and m_br_i_3204;
                                                                    binop_j_2698 = m_b_i_3205 ? (
                                                                        c_binop_i_3206 = int_j_2696 - int_j_2697
                                                                    ) : (
                                                                        ab_i_3207 = abort
                                                                    );
                                                                    m_bl_i_3208 = appl_j_2695 ~ int;
                                                                    m_br_i_3209 = binop_j_2698 ~ int;
                                                                    m_b_i_3210 = m_bl_i_3208 and m_br_i_3209;
                                                                    binop_j_2699 = m_b_i_3210 ? (
                                                                        c_binop_i_3211 = appl_j_2695 < binop_j_2698
                                                                    ) : (
                                                                        ab_i_3212 = abort
                                                                    );
                                                                    m_i_3213 = binop_j_2699 ~ bool;
                                                                    if_j_2748 = m_i_3213 ? (
                                                                        c_cond_i_3255 = binop_j_2699 ? (
                                                                        bool_j_2700 = false;
                                                                    fail_b_365 = bool_j_2700;
                                                                    var_j_2701 = new_right;
                                                                    m_match_bool_j_2703 = var_j_2701 ~ 
                                                                    {bj_untouched, _};
                                                                    m_match_bool_j_2710 = var_j_2701 ~ 
                                                                    {bj_actual_rec, _};
                                                                    m_match_cond_j_2711 = m_match_bool_j_2710 ? (
                                                                        actual_rec_b_384 = var_j_2701.bj_actual_rec;
                                                                    var_j_2712 = new_right;
                                                                    proj_j_2713 = var_j_2712.bj_decl_lbls;
                                                                    m_match_bool_j_2715 = proj_j_2713 ~ 
                                                                    {item, _};
                                                                    m_match_cond_j_2716 = m_match_bool_j_2715 ? (
                                                                        ni_j_147 = proj_j_2713.item;
                                                                    var_j_2717 = actual_rec_b_384;
                                                                    proj_j_2718 = var_j_2717.item;
                                                                    ni_j_146 = proj_j_2718;
                                                                    var_j_2719 = ni_j_146
                                                                    ) : (
                                                                        ab_j_2714 = abort
                                                                    )
                                                                    ) : (
                                                                        m_match_cond_j_2704 = m_match_bool_j_2703 ? (
                                                                        var_j_2705 = fail_b_365;
                                                                    assert_pred_j_2706 = var_j_2705;
                                                                    assert_res_j_2707 = assert_pred_j_2706 ? (
                                                                        assert_res_true_j_2708 = 
                                                                    {}
                                                                    ) : (
                                                                        ab_j_2709 = abort
                                                                    )
                                                                    ) : (
                                                                        ab_j_2702 = abort
                                                                    )
                                                                    );
                                                                    var_j_2720 = i;
                                                                    m_bl_i_3214 = m_match_cond_j_2711 ~ int;
                                                                    m_br_i_3215 = var_j_2720 ~ int;
                                                                    m_b_i_3216 = m_bl_i_3214 and m_br_i_3215;
                                                                    binop_j_2721 = m_b_i_3216 ? (
                                                                        c_binop_i_3217 = m_match_cond_j_2711 < var_j_2720
                                                                    ) : (
                                                                        ab_i_3218 = abort
                                                                    );
                                                                    m_i_3219 = binop_j_2721 ~ bool;
                                                                    if_j_2740 = m_i_3219 ? (
                                                                        c_cond_i_3244 = binop_j_2721 ? (
                                                                        var_j_2722 = rotate_left;
                                                                    var_j_2723 = create_node;
                                                                    var_j_2724 = item_j_148;
                                                                    m_i_3220 = var_j_2723 ~ fun;
                                                                    appl_j_2725 = m_i_3220 ? (
                                                                        c_appl_i_3221 = var_j_2723 var_j_2724
                                                                    ) : (
                                                                        ab_i_3222 = abort
                                                                    );
                                                                    var_j_2726 = left_j_149;
                                                                    m_i_3223 = appl_j_2725 ~ fun;
                                                                    appl_j_2727 = m_i_3223 ? (
                                                                        c_appl_i_3224 = appl_j_2725 var_j_2726
                                                                    ) : (
                                                                        ab_i_3225 = abort
                                                                    );
                                                                    var_j_2728 = new_right;
                                                                    m_i_3226 = appl_j_2727 ~ fun;
                                                                    appl_j_2729 = m_i_3226 ? (
                                                                        c_appl_i_3227 = appl_j_2727 var_j_2728
                                                                    ) : (
                                                                        ab_i_3228 = abort
                                                                    );
                                                                    m_i_3229 = var_j_2722 ~ fun;
                                                                    appl_j_2730 = m_i_3229 ? (
                                                                        c_appl_i_3230 = var_j_2722 appl_j_2729
                                                                    ) : (
                                                                        ab_i_3231 = abort
                                                                    )
                                                                    ) : (
                                                                        var_j_2731 = rotate_right_left;
                                                                    var_j_2732 = create_node;
                                                                    var_j_2733 = item_j_148;
                                                                    m_i_3232 = var_j_2732 ~ fun;
                                                                    appl_j_2734 = m_i_3232 ? (
                                                                        c_appl_i_3233 = var_j_2732 var_j_2733
                                                                    ) : (
                                                                        ab_i_3234 = abort
                                                                    );
                                                                    var_j_2735 = left_j_149;
                                                                    m_i_3235 = appl_j_2734 ~ fun;
                                                                    appl_j_2736 = m_i_3235 ? (
                                                                        c_appl_i_3236 = appl_j_2734 var_j_2735
                                                                    ) : (
                                                                        ab_i_3237 = abort
                                                                    );
                                                                    var_j_2737 = new_right;
                                                                    m_i_3238 = appl_j_2736 ~ fun;
                                                                    appl_j_2738 = m_i_3238 ? (
                                                                        c_appl_i_3239 = appl_j_2736 var_j_2737
                                                                    ) : (
                                                                        ab_i_3240 = abort
                                                                    );
                                                                    m_i_3241 = var_j_2731 ~ fun;
                                                                    appl_j_2739 = m_i_3241 ? (
                                                                        c_appl_i_3242 = var_j_2731 appl_j_2738
                                                                    ) : (
                                                                        ab_i_3243 = abort
                                                                    )
                                                                    )
                                                                    ) : (
                                                                        ab_i_3245 = abort
                                                                    )
                                                                    ) : (
                                                                        var_j_2741 = create_node;
                                                                    var_j_2742 = item_j_148;
                                                                    m_i_3246 = var_j_2741 ~ fun;
                                                                    appl_j_2743 = m_i_3246 ? (
                                                                        c_appl_i_3247 = var_j_2741 var_j_2742
                                                                    ) : (
                                                                        ab_i_3248 = abort
                                                                    );
                                                                    var_j_2744 = left_j_149;
                                                                    m_i_3249 = appl_j_2743 ~ fun;
                                                                    appl_j_2745 = m_i_3249 ? (
                                                                        c_appl_i_3250 = appl_j_2743 var_j_2744
                                                                    ) : (
                                                                        ab_i_3251 = abort
                                                                    );
                                                                    var_j_2746 = new_right;
                                                                    m_i_3252 = appl_j_2745 ~ fun;
                                                                    appl_j_2747 = m_i_3252 ? (
                                                                        c_appl_i_3253 = appl_j_2745 var_j_2746
                                                                    ) : (
                                                                        ab_i_3254 = abort
                                                                    )
                                                                    )
                                                                    ) : (
                                                                        ab_i_3256 = abort
                                                                    )
                                                                    ) : (
                                                                        var_j_2749 = tree
                                                                    )
                                                                    ) : (
                                                                        ab_i_3258 = abort
                                                                    )
                                                                    )
                                                                ) : (
                                                                    ab_i_3260 = abort
                                                                )
                                                        ) : (
                                                            ab_j_2614 = abort
                                                        )
                                                )
                                        ) : (
                                            m_match_cond_j_2604 = m_match_bool_j_2603 ? (
                                                    var_j_2605 = fail_b_363;
                                                    assert_pred_j_2606 = var_j_2605;
                                                    assert_res_j_2607 = assert_pred_j_2606 ? (
                                                            assert_res_true_j_2608 = 
                                                                {}
                                                        ) : (
                                                            ab_j_2609 = abort
                                                        )
                                                ) : (
                                                    ab_j_2602 = abort
                                                )
                                        );
                                    m_i_3261 = proj_j_2599 ~ fun;
                                    appl_j_2771 = m_i_3261 ? (
                                            c_appl_i_3262 = proj_j_2599 m_match_cond_j_2611
                                        ) : (
                                            ab_i_3263 = abort
                                        )
                                ) : (
                                    var_j_2772 = arg_check_b_1;
                                    assert_pred_j_2773 = var_j_2772;
                                    assert_res_j_2774 = assert_pred_j_2773 ? (
                                            assert_res_true_j_2775 = 
                                                {}
                                        ) : (
                                            ab_j_2776 = abort
                                        )
                                ));
                        var_j_2779 = i;
                        appl_j_2780 = flatten_fun_j_2778 var_j_2779
                    ) : (
                        var_j_2781 = arg_check_b_3;
                        assert_pred_j_2782 = var_j_2781;
                        assert_res_j_2783 = assert_pred_j_2782 ? (
                                assert_res_true_j_2784 = {}
                            ) : (
                                ab_j_2785 = abort
                            )
                    ));
            var_j_2788 = tree;
            appl_j_2789 = flatten_fun_j_2787 var_j_2788)));
appl_j_2795 = flatten_fun_j_2792 flatten_fun_j_2792;
flatten_fun_j_2810 = fun expr_b_343 -> (
    var_j_2796 = t;
    proj_j_2797 = var_j_2796.checker;
    var_j_2798 = expr_b_343;
    appl_j_2799 = proj_j_2797 var_j_2798;
    t_check_b_344 = appl_j_2799;
    var_j_2800 = t_check_b_344;
    if_j_2809 = var_j_2800 ? (
            bool_j_2801 = false;
            pred_check_b_345 = bool_j_2801;
            var_j_2802 = appl_j_2280;
            var_j_2803 = expr_b_343;
            appl_j_2804 = var_j_2802 var_j_2803;
            if_j_2807 = appl_j_2804 ? (
                    bool_j_2805 = true
                ) : (
                    var_j_2806 = pred_check_b_345
                )
        ) : (
            var_j_2808 = t_check_b_344
        ));
flatten_fun_j_2822 = fun bj_null_j_154 -> (
    var_j_2811 = t;
    proj_j_2812 = var_j_2811.generator;
    int_j_2813 = 0;
    appl_j_2814 = proj_j_2812 int_j_2813;
    candidate_b_342 = appl_j_2814;
    var_j_2815 = appl_j_2280;
    var_j_2816 = candidate_b_342;
    appl_j_2817 = var_j_2815 var_j_2816;
    if_j_2821 = appl_j_2817 ? (
            var_j_2818 = candidate_b_342
        ) : (
            bool_j_2819 = false;
            assume_j_2820 = assume bool_j_2819
        ));
flatten_fun_j_2824 = fun expr_b_346 -> (
    var_j_2823 = expr_b_346);
record_j_2825 = {checker = flatten_fun_j_2810, generator = flatten_fun_j_2822, wrapper = flatten_fun_j_2824};
proj_j_2826 = record_j_2825.generator;
int_j_2827 = 0;
appl_j_2828 = proj_j_2826 int_j_2827;
tree_b_382 = appl_j_2828;
bool_j_2829 = false;
fail_b_348 = bool_j_2829;
flatten_fun_j_2838 = fun expr_b_347 -> (
    var_j_2830 = expr_b_347;
    m_match_bool_j_2832 = var_j_2830 ~ any;
    m_match_bool_j_2835 = var_j_2830 ~ int;
    m_match_cond_j_2836 = m_match_bool_j_2835 ? (
            bool_j_2837 = true
        ) : (
            m_match_cond_j_2833 = m_match_bool_j_2832 ? (
                    var_j_2834 = fail_b_348
                ) : (
                    void_j_2831 = {}
                )
        ));
flatten_fun_j_2840 = fun bj_null_j_155 -> (
    input_j_2839 = input);
flatten_fun_j_2842 = fun expr_b_349 -> (
    var_j_2841 = expr_b_349);
record_j_2843 = {checker = flatten_fun_j_2838, generator = flatten_fun_j_2840, wrapper = flatten_fun_j_2842};
proj_j_2844 = record_j_2843.generator;
int_j_2845 = 0;
appl_j_2846 = proj_j_2844 int_j_2845;
i_b_381 = appl_j_2846;
flatten_fun_j_2861 = fun expr_b_367 -> (
    var_j_2847 = t;
    proj_j_2848 = var_j_2847.checker;
    var_j_2849 = expr_b_367;
    appl_j_2850 = proj_j_2848 var_j_2849;
    t_check_b_368 = appl_j_2850;
    var_j_2851 = t_check_b_368;
    if_j_2860 = var_j_2851 ? (
            bool_j_2852 = false;
            pred_check_b_369 = bool_j_2852;
            var_j_2853 = appl_j_2280;
            var_j_2854 = expr_b_367;
            appl_j_2855 = var_j_2853 var_j_2854;
            if_j_2858 = appl_j_2855 ? (
                    bool_j_2856 = true
                ) : (
                    var_j_2857 = pred_check_b_369
                )
        ) : (
            var_j_2859 = t_check_b_368
        ));
flatten_fun_j_2873 = fun bj_null_j_156 -> (
    var_j_2862 = t;
    proj_j_2863 = var_j_2862.generator;
    int_j_2864 = 0;
    appl_j_2865 = proj_j_2863 int_j_2864;
    candidate_b_366 = appl_j_2865;
    var_j_2866 = appl_j_2280;
    var_j_2867 = candidate_b_366;
    appl_j_2868 = var_j_2866 var_j_2867;
    if_j_2872 = appl_j_2868 ? (
            var_j_2869 = candidate_b_366
        ) : (
            bool_j_2870 = false;
            assume_j_2871 = assume bool_j_2870
        ));
flatten_fun_j_2875 = fun expr_b_370 -> (
    var_j_2874 = expr_b_370);
record_j_2876 = {checker = flatten_fun_j_2861, generator = flatten_fun_j_2873, wrapper = flatten_fun_j_2875};
proj_j_2877 = record_j_2876.checker;
appl_j_2880 = appl_j_2795 tree_b_382;
appl_j_2882 = appl_j_2880 i_b_381;
appl_j_2883 = proj_j_2877 appl_j_2882;
check_res_b_380 = appl_j_2883;
if_j_2891 = check_res_b_380 ? (
        var_j_2885 = appl_j_2795
    ) : (
        error_var_j_2886 = check_res_b_380;
        assert_pred_j_2887 = error_var_j_2886;
        assert_res_j_2888 = assert_pred_j_2887 ? (
                assert_res_true_j_2889 = {}
            ) : (
                ab_j_2890 = abort
            )
    );
i_result = if_j_2891