(***
  (
    (features (Polymorphic_types Dependent_types Modules First_class_types))
    (speed Fast)
    (typing Well_typed)
    (flags "")
  )
*)

(*
  This is a well-typed test is adapted from ill-typed OCaml:
    testsuite/tests/typing-modules/functors.ml
*)

let M : sig
  val F : sig end -> (X : sig
      val T : type
      val inner = sig
          val t : type
          val M : t
        end
      val F : (X : inner) -> (T -> T -> T) -> sig
          val res = X.t
        end
      val Y : sig
        val t = T -> T -> T
        val M : T -> T -> T
      end
    end) -> (X.F (X.Y) (X.Y.M)).res
end = struct
  let F (_ : sig end) (dependent X :
      sig val T : type end
    ) (Res : X.T) (Res : X.T) : X.T = Res
end