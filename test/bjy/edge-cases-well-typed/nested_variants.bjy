(***
  (
    (features (Polymorphic_types Refinement_types Dependent_arrows Modules Mu_types Parametric_types First_class_types Variants Records Recursive_functions Higher_order_functions Subtyping OOP_style Return_error Usage_error Other))
    (reasons (Polymorphic_types Refinement_types Dependent_arrows Modules Mu_types Parametric_types First_class_types Variants Records Recursive_functions Higher_order_functions Subtyping OOP_style Return_error Usage_error Other))
    (speed <Fast or Slow>)
    (typing <Well_typed or Ill_typed>)
  )
*)
(*** (
  (speed Slow)
  (typing Well_typed)
) *)

(* See the indentation for how this parses *)

let t = 
  (x : `A of int | `B of bool) ->
    match x with
    | `A _ -> (
        `C of bool
      | `D of (* the following is the body of `D. That is, `Y is not on the same level as `C and `D *)
          `X of bool
        | `Y of int
    )
    | `B _ -> int
    end

let f (g : t) : bool =
  match g (`A 0) with
  | `C b -> b
  | `D v ->
    match v with
    | `X b -> b
    | `Y i -> i % 2 == 0
    end
  end
