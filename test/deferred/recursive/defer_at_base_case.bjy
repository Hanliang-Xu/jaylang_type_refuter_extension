(***
  (
    (speed Fast)
    (typing Well_typed)
  )
*)

let id x = x

let rec f x =
  if x == 0
  then 1 + defer 0 + defer 1 + defer 2 + defer 3
  else id (f (x - 1))

let n = 10000
let result = f n

let _ = assert (result == 7)
