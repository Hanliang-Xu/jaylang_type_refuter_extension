i_first = {};
flatten_fun_j_113 = fun sum_j_0 -> (
    flatten_fun_j_112 = fun acc -> (
        flatten_fun_j_111 = fun x -> (
            var_j_8 = sum_j_0;
            var_j_9 = sum_j_0;
            appl_j_10 = var_j_8 var_j_9;
            sum = appl_j_10;
            flatten_fun_j_108 = fun acc_b_2 -> (
                int_j_11 = 0;
                input_j_12 = input;
                m_bl_i_188 = int_j_11 ~ int;
                m_br_i_189 = input_j_12 ~ int;
                m_b_i_190 = m_bl_i_188 and m_br_i_189;
                binop_j_13 = m_b_i_190 ? (
                        c_binop_i_191 = int_j_11 < input_j_12
                    ) : (
                        ab_i_192 = abort
                    );
                if_j_33 = binop_j_13 ? (
                        bool_j_14 = false;
                        fail_b_11 = bool_j_14;
                        flatten_fun_j_23 = fun expr_b_10 -> (
                            var_j_15 = expr_b_10;
                            m_match_bool_j_17 = var_j_15 ~ any;
                            m_match_bool_j_20 = var_j_15 ~ int;
                            m_match_cond_j_21 = m_match_bool_j_20 ? (
                                    bool_j_22 = true
                                ) : (
                                    m_match_cond_j_18 = m_match_bool_j_17 ? (
                                            var_j_19 = fail_b_11
                                        ) : (
                                            void_j_16 = {}
                                        )
                                ));
                        flatten_fun_j_25 = fun bj_null -> (
                            input_j_24 = input);
                        flatten_fun_j_27 = fun expr_b_12 -> (
                            var_j_26 = expr_b_12);
                        record_j_28 = {checker = flatten_fun_j_23, generator = flatten_fun_j_25, wrapper = flatten_fun_j_27};
                        proj_j_29 = record_j_28.checker;
                        var_j_30 = acc_b_2;
                        m_i_193 = proj_j_29 ~ fun;
                        appl_j_31 = m_i_193 ? (
                                c_appl_i_194 = proj_j_29 var_j_30
                            ) : (
                                ab_i_195 = abort
                            )
                    ) : (
                        bool_j_32 = true
                    );
                arg_check_b_3 = if_j_33;
                var_j_34 = arg_check_b_3;
                if_j_107 = var_j_34 ? (
                        flatten_fun_j_99 = fun x_b_0 -> (
                            int_j_35 = 0;
                            input_j_36 = input;
                            m_bl_i_196 = int_j_35 ~ int;
                            m_br_i_197 = input_j_36 ~ int;
                            m_b_i_198 = m_bl_i_196 and m_br_i_197;
                            binop_j_37 = m_b_i_198 ? (
                                    c_binop_i_199 = int_j_35 < input_j_36
                                ) : (
                                    ab_i_200 = abort
                                );
                            if_j_57 = binop_j_37 ? (
                                    bool_j_38 = false;
                                    fail_b_14 = bool_j_38;
                                    flatten_fun_j_47 = fun expr_b_13 -> (
                                        var_j_39 = expr_b_13;
                                        m_match_bool_j_41 = var_j_39 ~ any;
                                        m_match_bool_j_44 = var_j_39 ~ int;
                                        m_match_cond_j_45 = m_match_bool_j_44 ? (
                                                bool_j_46 = true
                                            ) : (
                                                m_match_cond_j_42 = m_match_bool_j_41 ? (
                                                        var_j_43 = fail_b_14
                                                    ) : (
                                                        void_j_40 = {}
                                                    )
                                            ));
                                    flatten_fun_j_49 = fun bj_null_j_1 -> (
                                        input_j_48 = input);
                                    flatten_fun_j_51 = fun expr_b_15 -> (
                                        var_j_50 = expr_b_15);
                                    record_j_52 = {checker = flatten_fun_j_47, generator = flatten_fun_j_49, wrapper = flatten_fun_j_51};
                                    proj_j_53 = record_j_52.checker;
                                    var_j_54 = x_b_0;
                                    m_i_201 = proj_j_53 ~ fun;
                                    appl_j_55 = m_i_201 ? (
                                            c_appl_i_202 = proj_j_53 var_j_54
                                        ) : (
                                            ab_i_203 = abort
                                        )
                                ) : (
                                    bool_j_56 = true
                                );
                            arg_check_b_1 = if_j_57;
                            var_j_58 = arg_check_b_1;
                            if_j_98 = var_j_58 ? (
                                    bool_j_59 = false;
                                    fail_b_17 = bool_j_59;
                                    flatten_fun_j_68 = fun expr_b_16 -> (
                                        var_j_60 = expr_b_16;
                                        m_match_bool_j_62 = var_j_60 ~ any;
                                        m_match_bool_j_65 = var_j_60 ~ bool;
                                        m_match_cond_j_66 = m_match_bool_j_65 ? (
                                                bool_j_67 = true
                                            ) : (
                                                m_match_cond_j_63 = m_match_bool_j_62 ? (
                                                        var_j_64 = fail_b_17
                                                    ) : (
                                                        void_j_61 = {}
                                                    )
                                            ));
                                    flatten_fun_j_72 = fun bj_null_j_2 -> (
                                        int_j_69 = 0;
                                        input_j_70 = input;
                                        m_bl_i_204 = int_j_69 ~ int;
                                        m_br_i_205 = input_j_70 ~ int;
                                        m_b_i_206 = m_bl_i_204 and m_br_i_205;
                                        binop_j_71 = m_b_i_206 ? (
                                                c_binop_i_207 = int_j_69 <= input_j_70
                                            ) : (
                                                ab_i_208 = abort
                                            ));
                                    flatten_fun_j_74 = fun expr_b_18 -> (
                                        var_j_73 = expr_b_18);
                                    record_j_75 = {checker = flatten_fun_j_68, generator = flatten_fun_j_72, wrapper = flatten_fun_j_74};
                                    proj_j_76 = record_j_75.wrapper;
                                    var_j_77 = x;
                                    int_j_78 = 0;
                                    m_bl_i_209 = var_j_77 ~ int;
                                    m_br_i_210 = int_j_78 ~ int;
                                    m_b_i_211 = m_bl_i_209 and m_br_i_210;
                                    binop_j_79 = m_b_i_211 ? (
                                            c_binop_i_212 = var_j_77 == int_j_78
                                        ) : (
                                            ab_i_213 = abort
                                        );
                                    m_i_214 = binop_j_79 ~ bool;
                                    if_j_91 = m_i_214 ? (
                                            c_cond_i_231 = binop_j_79 ? (
                                                    var_j_80 = acc
                                                ) : (
                                                    var_j_81 = x;
                                                    var_j_82 = acc;
                                                    m_bl_i_215 = var_j_81 ~ int;
                                                    m_br_i_216 = var_j_82 ~ int;
                                                    m_b_i_217 = m_bl_i_215 and m_br_i_216;
                                                    binop_j_83 = m_b_i_217 ? (
                                                            c_binop_i_218 = var_j_81 + var_j_82
                                                        ) : (
                                                            ab_i_219 = abort
                                                        );
                                                    acc2 = binop_j_83;
                                                    var_j_84 = sum;
                                                    var_j_85 = x;
                                                    int_j_86 = 1;
                                                    m_bl_i_220 = var_j_85 ~ int;
                                                    m_br_i_221 = int_j_86 ~ int;
                                                    m_b_i_222 = m_bl_i_220 and m_br_i_221;
                                                    binop_j_87 = m_b_i_222 ? (
                                                            c_binop_i_223 = var_j_85 - int_j_86
                                                        ) : (
                                                            ab_i_224 = abort
                                                        );
                                                    m_i_225 = var_j_84 ~ fun;
                                                    appl_j_88 = m_i_225 ? (
                                                            c_appl_i_226 = var_j_84 binop_j_87
                                                        ) : (
                                                            ab_i_227 = abort
                                                        );
                                                    var_j_89 = acc2;
                                                    m_i_228 = appl_j_88 ~ fun;
                                                    appl_j_90 = m_i_228 ? (
                                                            c_appl_i_229 = appl_j_88 var_j_89
                                                        ) : (
                                                            ab_i_230 = abort
                                                        )
                                                )
                                        ) : (
                                            ab_i_232 = abort
                                        );
                                    m_i_233 = proj_j_76 ~ fun;
                                    appl_j_92 = m_i_233 ? (
                                            c_appl_i_234 = proj_j_76 if_j_91
                                        ) : (
                                            ab_i_235 = abort
                                        )
                                ) : (
                                    var_j_93 = arg_check_b_1;
                                    assert_pred_j_94 = var_j_93;
                                    assert_res_j_95 = assert_pred_j_94 ? (
                                            assert_res_true_j_96 = {}
                                        ) : (
                                            ab_j_97 = abort
                                        )
                                ));
                        var_j_100 = x;
                        appl_j_101 = flatten_fun_j_99 var_j_100
                    ) : (
                        var_j_102 = arg_check_b_3;
                        assert_pred_j_103 = var_j_102;
                        assert_res_j_104 = assert_pred_j_103 ? (
                                assert_res_true_j_105 = {}
                            ) : (
                                ab_j_106 = abort
                            )
                    ));
            var_j_109 = acc;
            appl_j_110 = flatten_fun_j_108 var_j_109)));
appl_j_116 = flatten_fun_j_113 flatten_fun_j_113;
bool_j_117 = false;
fail_b_5 = bool_j_117;
flatten_fun_j_126 = fun expr_b_4 -> (
    var_j_118 = expr_b_4;
    m_match_bool_j_120 = var_j_118 ~ any;
    m_match_bool_j_123 = var_j_118 ~ int;
    m_match_cond_j_124 = m_match_bool_j_123 ? (
            bool_j_125 = true
        ) : (
            m_match_cond_j_121 = m_match_bool_j_120 ? (
                    var_j_122 = fail_b_5
                ) : (
                    void_j_119 = {}
                )
        ));
flatten_fun_j_128 = fun bj_null_j_3 -> (
    input_j_127 = input);
flatten_fun_j_130 = fun expr_b_6 -> (
    var_j_129 = expr_b_6);
record_j_131 = {checker = flatten_fun_j_126, generator = flatten_fun_j_128, wrapper = flatten_fun_j_130};
proj_j_132 = record_j_131.generator;
int_j_133 = 0;
appl_j_134 = proj_j_132 int_j_133;
acc_b_24 = appl_j_134;
bool_j_135 = false;
fail_b_8 = bool_j_135;
flatten_fun_j_144 = fun expr_b_7 -> (
    var_j_136 = expr_b_7;
    m_match_bool_j_138 = var_j_136 ~ any;
    m_match_bool_j_141 = var_j_136 ~ int;
    m_match_cond_j_142 = m_match_bool_j_141 ? (
            bool_j_143 = true
        ) : (
            m_match_cond_j_139 = m_match_bool_j_138 ? (
                    var_j_140 = fail_b_8
                ) : (
                    void_j_137 = {}
                )
        ));
flatten_fun_j_146 = fun bj_null_j_4 -> (
    input_j_145 = input);
flatten_fun_j_148 = fun expr_b_9 -> (
    var_j_147 = expr_b_9);
record_j_149 = {checker = flatten_fun_j_144, generator = flatten_fun_j_146, wrapper = flatten_fun_j_148};
proj_j_150 = record_j_149.generator;
int_j_151 = 0;
appl_j_152 = proj_j_150 int_j_151;
x_b_23 = appl_j_152;
bool_j_153 = false;
fail_b_20 = bool_j_153;
flatten_fun_j_162 = fun expr_b_19 -> (
    var_j_154 = expr_b_19;
    m_match_bool_j_156 = var_j_154 ~ any;
    m_match_bool_j_159 = var_j_154 ~ bool;
    m_match_cond_j_160 = m_match_bool_j_159 ? (
            bool_j_161 = true
        ) : (
            m_match_cond_j_157 = m_match_bool_j_156 ? (
                    var_j_158 = fail_b_20
                ) : (
                    void_j_155 = {}
                )
        ));
flatten_fun_j_166 = fun bj_null_j_5 -> (
    int_j_163 = 0;
    input_j_164 = input;
    m_bl_i_236 = int_j_163 ~ int;
    m_br_i_237 = input_j_164 ~ int;
    m_b_i_238 = m_bl_i_236 and m_br_i_237;
    binop_j_165 = m_b_i_238 ? (
            c_binop_i_239 = int_j_163 <= input_j_164
        ) : (
            ab_i_240 = abort
        ));
flatten_fun_j_168 = fun expr_b_21 -> (
    var_j_167 = expr_b_21);
record_j_169 = {checker = flatten_fun_j_162, generator = flatten_fun_j_166, wrapper = flatten_fun_j_168};
proj_j_170 = record_j_169.checker;
appl_j_173 = appl_j_116 acc_b_24;
appl_j_175 = appl_j_173 x_b_23;
appl_j_176 = proj_j_170 appl_j_175;
check_res_b_22 = appl_j_176;
if_j_187 = check_res_b_22 ? (
        var_j_178 = appl_j_116;
        int_j_179 = 0;
        m_i_241 = var_j_178 ~ fun;
        appl_j_180 = m_i_241 ? (
                c_appl_i_242 = var_j_178 int_j_179
            ) : (
                ab_i_243 = abort
            );
        sum2 = appl_j_180;
        var_j_181 = sum2
    ) : (
        error_var_j_182 = check_res_b_22;
        assert_pred_j_183 = error_var_j_182;
        assert_res_j_184 = assert_pred_j_183 ? (
                assert_res_true_j_185 = {}
            ) : (
                ab_j_186 = abort
            )
    );
i_result = if_j_187