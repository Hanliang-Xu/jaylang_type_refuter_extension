
# state monad bind

# TODO: where is the error here?
let bind 
  (x :       List 'b -> {: value : 'a , store : List 'b :})
  (f : 'a -> List 'b -> {: value : 'c , store : List 'b :})
  :          List 'b -> {: value : 'c , store : List 'b :}
  =
  let g (ss : List 'b) : {: value : 'c , store : List 'b :} =
    let r = x ss in
    f r.value r.store
  in
  g
in

bind