let result_type = {: result : int :}
in

let city = {: population : int :}
in

let shop = {: inventory : int :}
in

let sight = {: is_open : bool :}
in

let visitor =
  {: visit_city : city -> result_type
   , visit_shop : shop -> result_type
   , visit_sight : sight -> result_type :}
in

let client self =
  {: self   : self
   , accept : visitor -> result_type :}
in

let make_city_client (i : int) : client city = 
  let s = { population = i } in
  { self = s , accept = fun v -> v.visit_city s }
in

make_city_client



